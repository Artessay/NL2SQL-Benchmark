SELECT MAX(`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS HighestEligibleFreeRate FROM frpm WHERE `County Name` = 'Alameda'; 
SELECT `School Name`, (`Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`) AS EligibleFreeRate FROM frpm WHERE `Educational Option Type` = 'Continuation' ORDER BY EligibleFreeRate ASC LIMIT 3; 
SELECT s.Zip  FROM schools s JOIN frpm f ON s.CDSCode = f.CDSCode WHERE s.DOC = 'Fresno County Office of Education' AND f.`Charter School (Y/N)` = 1; 
SELECT schools.MailStreet  FROM frpm  JOIN schools ON frpm.CDSCode = schools.CDSCode  ORDER BY frpm.`FRPM Count (K-12)` DESC  LIMIT 1; 
SELECT s.Phone  FROM schools s  JOIN frpm f ON s.CDSCode = f.CDSCode  WHERE f.`Charter School (Y/N)` = 1    AND s.FundingType = 'Direct'    AND s.OpenDate > '2000-01-01'; 
SELECT COUNT(*) FROM schools s JOIN satscores ss ON s.CDSCode = ss.cds WHERE ss.AvgScrMath > 400 AND s.Virtual = 'F'; 
SELECT s.School, s.District, s.County FROM schools s JOIN satscores ss ON s.CDSCode = ss.cds WHERE ss.NumTstTakr > 500 AND s.Magnet = 1; 
SELECT sc.Phone  FROM schools sc JOIN satscores ss ON sc.CDSCode = ss.cds WHERE ss.NumGE1500 = (SELECT MAX(NumGE1500) FROM satscores); 
SELECT s.NumTstTakr  FROM satscores s JOIN frpm f ON s.cds = f.CDSCode WHERE f.`FRPM Count (K-12)` = (     SELECT MAX(`FRPM Count (K-12)`)     FROM frpm ); 
SELECT COUNT(*) FROM satscores AS s JOIN schools AS sc ON s.cds = sc.CDSCode WHERE s.AvgScrMath > 560 AND sc.FundingType = 'Direct Charter' 
SELECT frpm.`FRPM Count (Ages 5-17)` FROM satscores JOIN frpm ON satscores.cds = frpm.CDSCode WHERE satscores.AvgScrRead = (     SELECT MAX(AvgScrRead)      FROM satscores ); 
SELECT s.CDSCode FROM schools s JOIN frpm f ON s.CDSCode = f.CDSCode WHERE (f.`Enrollment (K-12)` + f.`Enrollment (Ages 5-17)`) > 500; 
SELECT MAX(`Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`) AS HighestEligibleFreeRate FROM frpm WHERE `CDSCode` IN (     SELECT `cds`     FROM satscores     WHERE CAST(`NumGE1500` AS REAL) / CAST(`NumTstTakr` AS REAL) > 0.3 ); 
SELECT s.Phone FROM schools s JOIN satscores ss ON s.CDSCode = ss.cds ORDER BY (CAST(ss.NumGE1500 AS FLOAT) / ss.NumTstTakr) DESC LIMIT 3; 
SELECT s.NCESSchool, f.`School Name`, f.`Enrollment (Ages 5-17)` FROM frpm f JOIN schools s ON f.CDSCode = s.CDSCode ORDER BY f.`Enrollment (Ages 5-17)` DESC LIMIT 5; 
SELECT s.District, AVG(ss.AvgScrRead) AS AvgReadingScore FROM satscores ss JOIN schools s ON ss.cds = s.CDSCode WHERE s.StatusType = 'Active' GROUP BY s.District ORDER BY AvgReadingScore DESC LIMIT 1; 
SELECT COUNT(*)  FROM schools s JOIN satscores ss ON s.CDSCode = ss.cds WHERE s.County = 'Alameda' AND ss.NumTstTakr < 100; 
SELECT s.CDSCode, s.School, s.CharterNum, sat.AvgScrWrite FROM schools s JOIN satscores sat ON s.CDSCode = sat.cds WHERE sat.AvgScrWrite > 499 AND s.CharterNum IS NOT NULL ORDER BY sat.AvgScrWrite DESC; 
SELECT COUNT(*) FROM schools s JOIN satscores ss ON s.CDSCode = ss.cds WHERE s.County = 'Fresno' AND s.FundingType = 'Directly Funded' AND ss.NumTstTakr <= 250; 
SELECT sc.Phone  FROM schools sc JOIN satscores ss ON sc.CDSCode = ss.cds WHERE ss.AvgScrMath = (SELECT MAX(AvgScrMath) FROM satscores); 
SELECT COUNT(*)  FROM frpm  WHERE `County Name` = 'Amador' AND `Low Grade` = '9' AND `High Grade` = '12'; 
SELECT COUNT(*)  FROM frpm  JOIN schools ON frpm.CDSCode = schools.CDSCode  WHERE schools.County = 'Los Angeles'  AND frpm.`Free Meal Count (K-12)` > 500  AND frpm.`FRPM Count (K-12)` < 700; 
SELECT sname  FROM satscores  WHERE cname = 'Contra Costa'  ORDER BY NumTstTakr DESC  LIMIT 1; 
SELECT s.School, s.Street, s.City, s.Zip, s.State  FROM schools s JOIN frpm f ON s.CDSCode = f.CDSCode WHERE ABS(f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30; 
SELECT s.School  FROM schools s JOIN frpm f ON s.CDSCode = f.CDSCode JOIN satscores sat ON s.CDSCode = sat.cds WHERE (f.`Free Meal Count (K-12)` / f.`Enrollment (K-12)`) > 0.1 AND sat.NumGE1500 >= 1; 
WITH RiversideSchools AS (     SELECT s.School, s.FundingType, sat.AvgScrMath     FROM schools s     JOIN satscores sat ON s.CDSCode = sat.cds     WHERE s.County = 'Riverside' ), GlobalAverage AS (     SELECT SUM(AvgScrMath) / COUNT(*) AS AvgOfAvgMath     FROM RiversideSchools ) SELECT rs.School, rs.FundingType FROM RiversideSchools rs WHERE (SELECT AvgOfAvgMath FROM GlobalAverage) > 400; 
SELECT s.School AS SchoolName, s.Street, s.City, s.State, s.Zip FROM schools s JOIN frpm f ON s.CDSCode = f.CDSCode WHERE s.County = 'Monterey'    AND f.`High Grade` = '12'    AND f.`FRPM Count (Ages 5-17)` > 800; 
SELECT s.School AS SchoolName, sa.AvgScrWrite AS AverageWritingScore, s.Phone AS CommunicationNumber FROM schools s JOIN satscores sa ON s.CDSCode = sa.cds WHERE (s.OpenDate > '1991-12-31' OR s.ClosedDate < '2000-01-01') AND sa.AvgScrWrite IS NOT NULL; 
WITH AverageDifference AS (     SELECT AVG(`Enrollment (K-12)` - `Enrollment (Ages 5-17)`) AS AvgDiff     FROM frpm     JOIN schools ON frpm.`CDSCode` = schools.`CDSCode`     WHERE schools.`FundingType` = 'Local' ), SchoolDifferences AS (     SELECT schools.`School` AS SchoolName, schools.`DOCType` AS DOCType, (`Enrollment (K-12)` - `Enrollment (Ages 5-17)`) AS Difference     FROM frpm     JOIN schools ON frpm.`CDSCode` = schools.`CDSCode`     WHERE schools.`FundingType` = 'Local' ) SELECT SchoolName, DOCType FROM SchoolDifferences WHERE Difference > (SELECT AvgDiff FROM AverageDifference); 
SELECT OpenDate  FROM schools  WHERE CDSCode = (     SELECT CDSCode      FROM frpm      WHERE `Enrollment (K-12)` = (         SELECT MAX(`Enrollment (K-12)`)          FROM frpm     ) ); 
SELECT City, `Enrollment (K-12)` FROM schools JOIN frpm ON schools.CDSCode = frpm.CDSCode ORDER BY `Enrollment (K-12)` ASC LIMIT 5; 
SELECT `School Name`, `Percent (%) Eligible Free (K-12)` FROM `frpm` ORDER BY `Enrollment (K-12)` DESC LIMIT 2 OFFSET 9; 
SELECT s.School, (f.`FRPM Count (K-12)` / f.`Enrollment (K-12)`) AS EligibleFreeReducedRate FROM schools s JOIN frpm f ON s.CDSCode = f.CDSCode WHERE s.DOC = '66' ORDER BY f.`FRPM Count (K-12)` DESC LIMIT 5; 
SELECT s.School, s.Website FROM schools s JOIN frpm f ON s.CDSCode = f.CDSCode WHERE f.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000; 
SELECT (f.`Free Meal Count (Ages 5-17)` / f.`Enrollment (Ages 5-17)`) AS FreeRate FROM frpm f JOIN schools s ON f.CDSCode = s.CDSCode WHERE s.AdmFName1 = 'Kacey' AND s.AdmLName1 = 'Gibson'; 
SELECT s.AdmEmail1  FROM schools s  JOIN frpm f ON s.CDSCode = f.CDSCode  WHERE f.`Charter School (Y/N)` = 1  ORDER BY f.`Enrollment (K-12)` ASC  LIMIT 1; 
SELECT AdmFName1, AdmLName1, AdmFName2, AdmLName2, AdmFName3, AdmLName3 FROM schools WHERE CDSCode = (     SELECT cds     FROM satscores     WHERE NumGE1500 = (         SELECT MAX(NumGE1500)         FROM satscores     ) ); 
SELECT s.Street, s.City, s.Zip, s.State FROM schools s JOIN satscores sat ON s.CDSCode = sat.cds WHERE (sat.NumGE1500 * 1.0 / sat.NumTstTakr) = (     SELECT MIN(sat.NumGE1500 * 1.0 / sat.NumTstTakr)     FROM satscores sat     WHERE sat.NumTstTakr > 0 ) AND sat.NumTstTakr > 0; 
SELECT s.Website FROM schools s JOIN satscores ss ON s.CDSCode = ss.cds WHERE s.County = 'Los Angeles'    AND ss.NumTstTakr BETWEEN 2000 AND 3000; 
SELECT COALESCE(AVG(satscores.NumTstTakr), 0) AS AvgTestTakers FROM satscores JOIN schools    ON satscores.cds = schools.CDSCode WHERE schools.County = 'Fresno'    AND schools.OpenDate IS NOT NULL   AND schools.OpenDate BETWEEN '1980-01-01' AND '1980-12-31'; 
SELECT sc.Phone FROM satscores sat JOIN schools sc ON sat.cds = sc.CDSCode WHERE sc.District = 'Fresno Unified' ORDER BY sat.AvgScrRead ASC LIMIT 1; 
WITH RankedSchools AS (     SELECT          sc.School AS SchoolName,          sc.County,          sa.AvgScrRead,          RANK() OVER (PARTITION BY sc.County ORDER BY sa.AvgScrRead DESC) AS RankInCounty     FROM schools sc     JOIN satscores sa ON sc.CDSCode = sa.cds     WHERE sc.Virtual = 'F' ) SELECT SchoolName FROM RankedSchools WHERE RankInCounty <= 5; 
SELECT s.EdOpsName FROM schools s JOIN satscores ss ON s.CDSCode = ss.cds WHERE ss.AvgScrMath = (SELECT MAX(AvgScrMath) FROM satscores); 
SELECT AvgScrMath, cname  FROM satscores  WHERE cds = (     SELECT cds      FROM satscores      ORDER BY (AvgScrMath + AvgScrRead + AvgScrWrite) ASC      LIMIT 1 ); 
SELECT sc.City, sa.AvgScrWrite FROM satscores sa JOIN schools sc ON sa.cds = sc.CDSCode WHERE sa.cds = (     SELECT cds     FROM satscores     WHERE NumGE1500 >= 1500     ORDER BY NumTstTakr DESC     LIMIT 1 ); 
SELECT s.School, AVG(sat.AvgScrWrite) AS AvgWritingScore FROM schools s JOIN satscores sat ON s.CDSCode = sat.cds WHERE s.AdmFName1 = 'Ricci' AND s.AdmLName1 = 'Ulrich' GROUP BY s.School; 
SELECT s.School, s.District, s.County, f.`Enrollment (K-12)` FROM schools s JOIN frpm f ON s.CDSCode = f.CDSCode WHERE s.DOC = '31' ORDER BY f.`Enrollment (K-12)` DESC LIMIT 1; 
SELECT      COUNT(*) * 1.0 / 12 AS MonthlyAverageOpenings FROM      schools WHERE      TRIM(County) = 'Alameda'      AND TRIM(DOC) = '52'      AND OpenDate IS NOT NULL      AND OpenDate LIKE '1980-%'; 
SELECT      CAST((SELECT COUNT(*)            FROM schools            WHERE County = 'Orange' AND DOC = '54') AS FLOAT) /      CAST((SELECT COUNT(*)            FROM schools            WHERE County = 'Orange' AND DOC = '52') AS FLOAT) AS ratio; 
SELECT School, ClosedDate FROM schools WHERE StatusType = 'Closed'    AND County = (     SELECT County     FROM schools     WHERE StatusType = 'Closed'     GROUP BY County     ORDER BY COUNT(*) DESC     LIMIT 1   ); 
SELECT s.School, s.MailStreet  FROM schools s JOIN satscores ss ON s.CDSCode = ss.cds ORDER BY ss.AvgScrMath DESC LIMIT 1 OFFSET 6; 
SELECT schools.MailStreet, schools.School FROM satscores JOIN schools ON satscores.cds = schools.CDSCode WHERE satscores.AvgScrRead = (SELECT MIN(AvgScrRead) FROM satscores); 
SELECT COUNT(*) FROM satscores AS s JOIN schools AS sc ON s.cds = sc.CDSCode WHERE (s.AvgScrRead + s.AvgScrMath + s.AvgScrWrite) >= 1500 AND sc.MailCity = 'Lakeport'; 
SELECT SUM(satscores.NumTstTakr) AS TotalTestTakers FROM satscores JOIN schools ON satscores.cds = schools.CDSCode WHERE schools.MailCity = 'Fresno'; 
SELECT School, MailZip  FROM schools  WHERE AdmFName1 = 'Avetik' AND AdmLName1 = 'Atoian'; 
SELECT      (SELECT COUNT(*) FROM schools WHERE MailState = 'California' AND County = 'Colusa') * 1.0 /      (SELECT COUNT(*) FROM schools WHERE MailState = 'California' AND County = 'Humboldt') AS Ratio; 
SELECT COUNT(*) AS ActiveSchoolsCount FROM schools WHERE MailState = 'California' AND City = 'San Joaquin' AND StatusType = 'Active'; 
SELECT s.Phone, s.Ext FROM schools s JOIN satscores ss ON s.CDSCode = ss.cds ORDER BY ss.AvgScrWrite DESC LIMIT 1 OFFSET 332; 
SELECT School, Phone, Ext  FROM schools  WHERE Zip = '95203-3704'; 
SELECT Website  FROM schools  WHERE (AdmFName1 = 'Mike' AND AdmLName1 = 'Larson')     OR (AdmFName2 = 'Mike' AND AdmLName2 = 'Larson')     OR (AdmFName3 = 'Mike' AND AdmLName3 = 'Larson')     OR (AdmFName1 = 'Dante' AND AdmLName1 = 'Alvarez')     OR (AdmFName2 = 'Dante' AND AdmLName2 = 'Alvarez')     OR (AdmFName3 = 'Dante' AND AdmLName3 = 'Alvarez'); 
SELECT Website  FROM schools  WHERE Virtual = 'P' AND Charter = 1 AND County = 'San Joaquin'; 
SELECT COUNT(*) AS CharterSchoolCount FROM schools WHERE City = 'Hickman' AND DOC = '52' AND Charter = 1; 
SELECT COUNT(*) FROM schools s JOIN frpm f ON s.CDSCode = f.CDSCode WHERE s.County = 'Los Angeles'   AND s.Charter = 0   AND (f.`Free Meal Count (K-12)` * 100 / f.`Enrollment (K-12)`) < 0.18; 
SELECT schools.School AS SchoolName, schools.City,         schools.AdmFName1 || ' ' || schools.AdmLName1 AS Admin1FullName,         schools.AdmFName2 || ' ' || schools.AdmLName2 AS Admin2FullName,         schools.AdmFName3 || ' ' || schools.AdmLName3 AS Admin3FullName FROM schools WHERE schools.Charter = 1 AND schools.CharterNum = '00D2'; 
SELECT COUNT(*) AS TotalSchools FROM schools WHERE MailCity = 'Hickman' AND CharterNum = '00D4'; 
SELECT      (SUM(CASE WHEN `Charter Funding Type` = 'Locally Funded' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) AS `Ratio Percentage` FROM      `frpm` WHERE      `County Name` = 'Santa Clara County'      AND `Charter School (Y/N)` = 'Y'; 
SELECT COUNT(*) AS DirectlyFundedSchoolCount FROM schools WHERE County = 'Stanislaus'    AND FundingType = 'Directly Funded'    AND OpenDate BETWEEN '2000-01-01' AND '2005-12-31'; 
SELECT COUNT(*) AS TotalClosures FROM schools WHERE DOCType = 'Community College District'    AND ClosedDate LIKE '1989%'    AND City = 'San Francisco'; 
SELECT County, COUNT(*) AS NumberOfClosures FROM schools WHERE SOC = '11' AND ClosedDate BETWEEN '1980-01-01' AND '1989-12-31' GROUP BY County ORDER BY NumberOfClosures DESC LIMIT 1; 
SELECT NCESDist  FROM schools  WHERE SOC = '31'; 
SELECT      SUM(CASE WHEN StatusType = 'Active' THEN 1 ELSE 0 END) AS ActiveDistrictCommunityDaySchools,     SUM(CASE WHEN StatusType = 'Closed' THEN 1 ELSE 0 END) AS ClosedDistrictCommunityDaySchools FROM schools WHERE County = 'Alpine' AND DOCType = 'District Community Day School'; 
SELECT `District Code`  FROM `schools`  JOIN `frpm` ON `schools`.`CDSCode` = `frpm`.`CDSCode`  WHERE `City` = 'Fresno' AND `Magnet` = 0; 
SELECT SUM(`Enrollment (Ages 5-17)`) AS Total_Enrollment FROM frpm JOIN schools ON frpm.CDSCode = schools.CDSCode WHERE schools.City = 'Fremont'  AND frpm.`Academic Year` = '2014-2015'  AND schools.EdOpsCode = 'SSS'; 
SELECT f.`FRPM Count (Ages 5-17)` FROM frpm f JOIN schools s ON f.`CDSCode` = s.`CDSCode` WHERE s.`EdOpsName` = 'Youth Authority School' AND s.`MailStreet` = 'PO Box 1040'; 
SELECT `Low Grade` FROM `frpm` JOIN `schools` ON `frpm`.`CDSCode` = `schools`.`CDSCode` WHERE `schools`.`NCESDist` = '0613360' AND `schools`.`EdOpsCode` = 'SPECON'; 
SELECT s.School, s.EdOpsName FROM schools s JOIN frpm f ON s.CDSCode = f.CDSCode WHERE f.`NSLP Provision Status` = 'Provision 2' AND f.`County Code` = '37'; 
SELECT s.City  FROM schools s JOIN frpm f ON s.CDSCode = f.CDSCode WHERE f.`NSLP Provision Status` = '2'    AND f.`Low Grade` = '9'    AND f.`High Grade` = '12'    AND s.County = 'Merced'    AND s.EILCode = 'HS'; 
SELECT s.School, f.`Percent (%) Eligible FRPM (Ages 5-17)` FROM schools s JOIN frpm f ON s.CDSCode = f.CDSCode WHERE s.County = 'Los Angeles' AND f.`Low Grade` = 'Kindergarten' AND f.`High Grade` = '9'; 
SELECT GSserved, COUNT(*) AS count FROM schools WHERE LOWER(TRIM(City)) LIKE '%adelanto%' AND GSserved IS NOT NULL GROUP BY GSserved ORDER BY count DESC LIMIT 1; 
SELECT County, COUNT(*) AS SchoolCount FROM schools WHERE County IN ('San Diego', 'Santa Barbara') AND Virtual = 'F' GROUP BY County ORDER BY SchoolCount DESC LIMIT 1; 
SELECT s.School, s.DOCType AS SchoolType, s.Latitude FROM schools s WHERE s.Latitude = (SELECT MAX(Latitude) FROM schools); 
SELECT s.School, s.City, f.`Low Grade` FROM schools s JOIN frpm f ON s.CDSCode = f.CDSCode WHERE s.State = 'CA' ORDER BY s.Latitude ASC LIMIT 1; 
SELECT GSoffered  FROM schools  WHERE ABS(Longitude) = (SELECT MAX(ABS(Longitude)) FROM schools); 
SELECT      s.City,     COUNT(s.CDSCode) AS SchoolsCount FROM      schools s JOIN      frpm f ON s.CDSCode = f.CDSCode WHERE      s.Magnet = 1      AND f.`Low Grade` = 'K'     AND f.`High Grade` = '8'     AND f.`NSLP Provision Status` = 'Multiple Provision Types' GROUP BY      s.City; 
WITH AllAdmins AS (     SELECT AdmFName1 AS FirstName, District     FROM schools     WHERE AdmFName1 IS NOT NULL     UNION ALL     SELECT AdmFName2 AS FirstName, District     FROM schools     WHERE AdmFName2 IS NOT NULL     UNION ALL     SELECT AdmFName3 AS FirstName, District     FROM schools     WHERE AdmFName3 IS NOT NULL ), NameCounts AS (     SELECT          FirstName,         District,         COUNT(*) AS NameCount     FROM AllAdmins     GROUP BY FirstName, District ), GlobalCounts AS (     SELECT          FirstName,         SUM(NameCount) AS TotalCount     FROM NameCounts     GROUP BY FirstName ), RankedNames AS (     SELECT          FirstName,         TotalCount,         ROW_NUMBER() OVER (ORDER BY TotalCount DESC, FirstName ASC) AS RowNum     FROM GlobalCounts ) SELECT FirstName, TotalCount FROM RankedNames WHERE RowNum <= 2 ORDER BY TotalCount DESC, FirstName ASC; 
SELECT s.District, f.`Percent (%) Eligible Free (K-12)` FROM schools s JOIN frpm f ON s.CDSCode = f.CDSCode WHERE s.AdmFName1 = 'Alusine'; 
SELECT      sc.AdmLName1 AS AdministratorLastName,      sc.District AS DistrictName,      sc.County AS CountyName,      sc.School AS SchoolName FROM      schools sc JOIN      frpm f ON sc.CDSCode = f.CDSCode WHERE      sc.CharterNum = '40'; 
SELECT AdmEmail1, AdmEmail2, AdmEmail3  FROM schools  WHERE County = 'San Bernardino'  AND District = 'San Bernardino City Unified'  AND OpenDate BETWEEN '2009-01-01' AND '2010-12-31'  AND SOC = '62'  AND DOC = '54'; 
SELECT sc.School, sc.AdmEmail1  FROM satscores sat JOIN schools sc ON sat.cds = sc.CDSCode WHERE sat.NumGE1500 = (     SELECT MAX(NumGE1500)      FROM satscores ); 
SELECT COUNT(DISTINCT a.account_id)  FROM account a JOIN district d ON a.district_id = d.district_id WHERE a.frequency = 'POPLATEK PO OBRATU' AND d.A3 = 'East Bohemia'; 
SELECT COUNT(DISTINCT a.account_id) AS eligible_accounts FROM account a JOIN district d ON a.district_id = d.district_id WHERE d.A3 = 'Prague'   AND a.account_id IN (SELECT account_id FROM loan); 
SELECT      CASE          WHEN AVG(A12) > AVG(A13) THEN '1995'         ELSE '1996'      END AS Higher_Unemployment_Year FROM district; 
SELECT COUNT(DISTINCT d.district_id) AS district_count FROM district d JOIN client c ON d.district_id = c.district_id WHERE c.gender = 'F' AND d.A11 > 6000 AND d.A11 < 10000; 
SELECT COUNT(DISTINCT client.client_id) AS male_customers_count FROM client JOIN district ON client.district_id = district.district_id WHERE client.gender = 'M' AND district.A3 = 'North Bohemia' AND district.A11 > 8000; 
WITH oldest_females AS (     SELECT          c.client_id,          c.district_id,          c.birth_date,         a.account_id     FROM client c     JOIN disp d ON c.client_id = d.client_id     JOIN account a ON d.account_id = a.account_id     WHERE c.gender = 'F'      AND c.birth_date = (         SELECT MIN(birth_date)         FROM client         WHERE gender = 'F'     ) ), lowest_avg_salary_district AS (     SELECT          MIN(A11) AS lowest_avg_salary     FROM district ), highest_avg_salary_district AS (     SELECT          MAX(A11) AS highest_avg_salary     FROM district ) SELECT      o.account_id,     d.A11 AS avg_salary_of_oldest_female,     h.highest_avg_salary,     l.lowest_avg_salary,     h.highest_avg_salary - l.lowest_avg_salary AS salary_gap FROM oldest_females o JOIN district d ON o.district_id = d.district_id CROSS JOIN lowest_avg_salary_district l CROSS JOIN highest_avg_salary_district h WHERE d.A11 = l.lowest_avg_salary; 
SELECT DISTINCT a.account_id FROM client c JOIN disp d ON c.client_id = d.client_id JOIN account a ON d.account_id = a.account_id JOIN district dist ON c.district_id = dist.district_id WHERE c.birth_date = (SELECT MAX(c1.birth_date) FROM client c1)   AND dist.A11 = (SELECT MAX(dist1.A11) FROM district dist1); 
SELECT COUNT(*) AS weekly_owners_count FROM disp JOIN account ON disp.account_id = account.account_id WHERE disp.type = 'OWNER' AND account.frequency = 'POPLATEK TYDNE'; 
SELECT c.client_id  FROM client c JOIN disp d ON c.client_id = d.client_id JOIN account a ON d.account_id = a.account_id WHERE d.type = 'DISPONENT' AND a.frequency = 'POPLATEK PO OBRATU'; 
WITH MinAmount AS (     SELECT MIN(l.amount) AS min_amount     FROM loan l     JOIN account a ON l.account_id = a.account_id     WHERE l.status = 'A'       AND l.date BETWEEN '1997-01-01' AND '1997-12-31'       AND a.frequency = 'POPLATEK TYDNE' ) SELECT a.account_id, a.frequency, l.amount FROM account a JOIN loan l ON a.account_id = l.account_id WHERE l.status = 'A'   AND l.date BETWEEN '1997-01-01' AND '1997-12-31'   AND a.frequency = 'POPLATEK TYDNE'   AND l.amount = (SELECT min_amount FROM MinAmount); 
SELECT a.account_id, l.amount FROM account a JOIN loan l ON a.account_id = l.account_id WHERE l.duration > 12   AND a.date BETWEEN '1993-01-01' AND '1993-12-31'   AND l.amount = (       SELECT MAX(amount)       FROM loan l2       WHERE l2.duration > 12   ); 
SELECT COUNT(*)  FROM client  JOIN district ON client.district_id = district.district_id  JOIN disp ON client.client_id = disp.client_id  JOIN account ON disp.account_id = account.account_id  WHERE client.gender = 'F'    AND client.birth_date < '1950-01-01'    AND district.A2 = 'Sokolov'; 
SELECT account_id FROM account WHERE date = (     SELECT MIN(date)     FROM account     WHERE date BETWEEN '1995-01-01' AND '1995-12-31' ); 
WITH LatestTransactions AS (     SELECT account_id, MAX(date) AS latest_date     FROM trans     GROUP BY account_id ), AccountBalances AS (     SELECT t.account_id, t.balance     FROM trans t     INNER JOIN LatestTransactions lt     ON t.account_id = lt.account_id AND t.date = lt.latest_date ) SELECT DISTINCT a.account_id FROM account a LEFT JOIN AccountBalances ab ON a.account_id = ab.account_id WHERE a.date < '1997-01-01' AND (ab.balance > 3000 OR ab.balance IS NULL); 
SELECT c.client_id  FROM client c JOIN disp d ON c.client_id = d.client_id JOIN card ca ON d.disp_id = ca.disp_id WHERE ca.issued = '1994-03-03'; 
SELECT a.date AS account_open_date FROM account a JOIN trans t ON a.account_id = t.account_id WHERE t.amount = 1000 AND t.date = '1995-03-24'; 
SELECT a.district_id FROM loan l JOIN account a ON l.account_id = a.account_id WHERE l.date = '1994-01-05'; 
SELECT MAX(t.amount) AS biggest_transaction FROM trans t JOIN account a ON t.account_id = a.account_id JOIN disp d ON a.account_id = d.account_id JOIN client c ON d.client_id = c.client_id JOIN card cd ON d.disp_id = cd.disp_id WHERE cd.issued = '1996-10-21'; 
SELECT c.gender FROM client c JOIN disp d ON c.client_id = d.client_id AND d.type = 'OWNER' JOIN account a ON d.account_id = a.account_id JOIN district dis ON a.district_id = dis.district_id WHERE dis.district_id = (     SELECT district_id     FROM district     ORDER BY A11 DESC     LIMIT 1 ) ORDER BY c.birth_date ASC LIMIT 1; 
WITH largest_loan_account AS (     SELECT account_id     FROM loan     ORDER BY amount DESC     LIMIT 1 ) SELECT t.amount FROM trans t JOIN account a ON t.account_id = a.account_id WHERE t.account_id = (SELECT account_id FROM largest_loan_account)   AND t.date >= a.date ORDER BY t.date ASC LIMIT 1; 
SELECT COUNT(DISTINCT client.client_id) AS female_clients_count FROM client JOIN account ON client.district_id = account.district_id JOIN district ON account.district_id = district.district_id WHERE district.A2 = 'Jesenik' AND client.gender = 'F'; 
SELECT disp.disp_id FROM trans JOIN disp ON trans.account_id = disp.account_id WHERE trans.amount = 1000 AND trans.date = '1995-03-24'; 
SELECT COUNT(*) AS num_accounts_opened FROM account a JOIN disp d ON a.account_id = d.account_id JOIN client c ON d.client_id = c.client_id JOIN district di ON c.district_id = di.district_id WHERE di.A2 = 'Litomerice' AND a.date BETWEEN '1996-01-01' AND '1996-12-31'; 
SELECT d.A2  FROM client c JOIN account a ON c.district_id = a.district_id JOIN district d ON a.district_id = d.district_id WHERE c.gender = 'F' AND c.birth_date = '1976-01-29'; 
SELECT c.birth_date FROM client c JOIN disp d ON c.client_id = d.client_id JOIN account a ON d.account_id = a.account_id JOIN loan l ON a.account_id = l.account_id WHERE l.amount = 98832 AND l.date = '1996-01-03'; 
SELECT a.account_id FROM account a JOIN disp dp ON a.account_id = dp.account_id JOIN client c ON dp.client_id = c.client_id JOIN district d ON c.district_id = d.district_id WHERE TRIM(LOWER(d.A3)) = 'prague'   AND dp.type = 'OWNER' ORDER BY a.date ASC LIMIT 1; 
SELECT      (CAST(COUNT(CASE WHEN c.gender = 'M' THEN 1 END) AS FLOAT) / COUNT(c.client_id)) * 100 AS male_percentage FROM      client c JOIN      district d ON c.district_id = d.district_id WHERE      d.A3 = 'south Bohemia'      AND CAST(d.A4 AS INTEGER) = (         SELECT              MAX(CAST(A4 AS INTEGER))         FROM              district         WHERE              A3 = 'south Bohemia'     ); 
WITH FirstLoan AS (     SELECT l.account_id, MIN(l.date) AS first_loan_date     FROM loan l     GROUP BY l.account_id     HAVING MIN(l.date) = '1993-07-05' ), ClientAccount AS (     SELECT d.client_id, d.account_id     FROM disp d     JOIN FirstLoan fl ON d.account_id = fl.account_id     WHERE d.type = 'OWNER' ), BalanceStart AS (     SELECT t.account_id, t.balance AS balance_start     FROM (         SELECT t.account_id, t.balance, t.date,                ROW_NUMBER() OVER (PARTITION BY t.account_id ORDER BY t.date DESC) AS rn         FROM trans t         WHERE t.date <= '1993-03-22'     ) sub     WHERE sub.rn = 1 ), BalanceEnd AS (     SELECT t.account_id, t.balance AS balance_end     FROM (         SELECT t.account_id, t.balance, t.date,                ROW_NUMBER() OVER (PARTITION BY t.account_id ORDER BY t.date DESC) AS rn         FROM trans t         WHERE t.date <= '1998-12-27'     ) sub     WHERE sub.rn = 1 ) SELECT ca.client_id, ca.account_id, bs.balance_start, be.balance_end,         CASE             WHEN bs.balance_start = 0 THEN NULL            ELSE ((be.balance_end - bs.balance_start) * 100.0 / bs.balance_start)         END AS increase_rate FROM ClientAccount ca LEFT JOIN BalanceStart bs ON ca.account_id = bs.account_id LEFT JOIN BalanceEnd be ON ca.account_id = be.account_id; 
SELECT (SUM(CASE WHEN status = 'A' THEN amount ELSE 0 END) * 100.0) / SUM(amount) AS percentage_paid_no_issue FROM loan; 
SELECT (COUNT(*) * 100.0 / (SELECT COUNT(*) FROM loan WHERE amount < 100000)) AS percentage FROM loan WHERE amount < 100000 AND status = 'C'; 
SELECT a.account_id, d.A2 AS district_name, d.A3 AS district_region FROM account a JOIN district d ON a.district_id = d.district_id WHERE a.frequency = 'POPLATEK MESICNE' AND a.date >= '1993-01-01' AND a.date < '1994-01-01'; 
SELECT DISTINCT a.account_id, a.frequency FROM account a JOIN disp d ON a.account_id = d.account_id JOIN client c ON d.client_id = c.client_id JOIN district di ON c.district_id = di.district_id WHERE di.A3 = 'east Bohemia'   AND d.type = 'OWNER'   AND a.date BETWEEN '1995-01-01' AND '2000-12-31'; 
SELECT account.account_id AS account_id, account.date AS account_opening_date FROM account JOIN client ON account.district_id = client.district_id JOIN district ON client.district_id = district.district_id WHERE district.A2 = 'Prachatice'; 
SELECT d.A2 AS district, d.A3 AS region FROM loan l JOIN account a ON l.account_id = a.account_id JOIN district d ON a.district_id = d.district_id WHERE l.loan_id = 4990; 
SELECT l.account_id, d.A2 AS district, d.A3 AS region FROM loan l JOIN account a ON l.account_id = a.account_id JOIN district d ON a.district_id = d.district_id WHERE l.amount > 300000; 
SELECT      loan.loan_id,     district.A3 AS district,     district.A11 AS average_salary FROM      loan JOIN      account ON loan.account_id = account.account_id JOIN      district ON account.district_id = district.district_id WHERE      loan.duration = 60; 
SELECT         d.A3 AS district,        d.A2 AS state,        ((d.A13 - d.A12) / d.A12) * 100 AS unemployment_rate_increment_percentage FROM loan l JOIN account a ON l.account_id = a.account_id JOIN district d ON a.district_id = d.district_id WHERE l.status = 'D'   AND DATE(l.date, '+' || l.duration || ' months') >= DATE('now')   AND d.A12 IS NOT NULL AND d.A12 > 0   AND d.A13 IS NOT NULL; 
SELECT      COUNT(CASE WHEN d.A2 = 'Decin' AND strftime('%Y', a.date) = '1993' THEN a.account_id END) * 100.0 /     COUNT(CASE WHEN strftime('%Y', a.date) = '1993' THEN a.account_id END) AS percentage FROM      account a JOIN      district d ON a.district_id = d.district_id; 
SELECT account_id  FROM account  WHERE frequency = 'POPLATEK MESICNE'; 
SELECT d.A2 AS district_name, COUNT(c.client_id) AS female_account_holders FROM client c JOIN district d ON c.district_id = d.district_id WHERE c.gender = 'F' GROUP BY d.A2 ORDER BY COUNT(c.client_id) DESC LIMIT 9; 
SELECT d.A2 AS district_name, t.amount FROM district d JOIN account a ON d.district_id = a.district_id JOIN trans t ON a.account_id = t.account_id WHERE t.type = 'VYDAJ'   AND t.date LIKE '1996-01%' ORDER BY t.amount DESC LIMIT 10; 
SELECT COUNT(DISTINCT a.account_id) FROM account a JOIN client c ON a.district_id = c.district_id JOIN district d ON c.district_id = d.district_id LEFT JOIN disp di ON a.account_id = di.account_id LEFT JOIN card ca ON di.disp_id = ca.disp_id WHERE d.A3 = 'South Bohemia' AND ca.card_id IS NULL; 
SELECT d.A3 AS district_name, COUNT(l.loan_id) AS active_loan_count FROM loan l LEFT JOIN account a ON l.account_id = a.account_id LEFT JOIN district d ON a.district_id = d.district_id WHERE l.status IN ('C', 'D') GROUP BY d.district_id, d.A3 ORDER BY active_loan_count DESC LIMIT 1; 
SELECT AVG(loan.amount) AS average_loan_amount FROM loan JOIN account ON loan.account_id = account.account_id JOIN disp ON account.account_id = disp.account_id JOIN client ON disp.client_id = client.client_id WHERE client.gender = 'M'; 
SELECT A3 AS branch_location, A2 AS district_name FROM district WHERE A13 = (SELECT MAX(A13) FROM district); 
WITH max_crimes_district AS (     SELECT district_id     FROM district     WHERE A16 = (SELECT MAX(A16) FROM district) ) SELECT COUNT(account_id) AS num_accounts FROM account WHERE district_id IN (SELECT district_id FROM max_crimes_district) AND date BETWEEN '1996-01-01' AND '1996-12-31'; 
SELECT COUNT(DISTINCT a.account_id) AS negative_balance_accounts FROM account a JOIN trans t ON a.account_id = t.account_id WHERE a.frequency = 'POPLATEK MESICNE'    AND t.operation = 'VYBER KARTOU'    AND t.balance < 0; 
SELECT COUNT(*) AS loan_count FROM loan JOIN account ON loan.account_id = account.account_id WHERE loan.date BETWEEN '1995-01-01' AND '1997-12-31'   AND loan.amount >= 250000   AND account.frequency = 'POPLATEK MESICNE'; 
SELECT COUNT(DISTINCT account.account_id)  FROM account JOIN client ON account.district_id = client.district_id JOIN loan ON account.account_id = loan.account_id WHERE client.district_id = 1 AND loan.status IN ('C', 'D'); 
SELECT COUNT(DISTINCT c.client_id) AS male_clients_count FROM client c JOIN district d ON c.district_id = d.district_id WHERE d.A15 = (     SELECT MAX(d1.A15)     FROM district d1     WHERE d1.A15 < (SELECT MAX(d2.A15) FROM district d2) ) AND c.gender = 'M'; 
SELECT COUNT(*) AS high_level_credit_cards_count FROM card JOIN disp ON card.disp_id = disp.disp_id WHERE card.type = 'gold' AND disp.type = 'OWNER'; 
SELECT COUNT(*)  FROM account  JOIN district ON account.district_id = district.district_id  WHERE district.A2 = 'Pisek'; 
SELECT DISTINCT d.district_id FROM district d INNER JOIN account a ON d.district_id = a.district_id INNER JOIN trans t ON a.account_id = t.account_id WHERE t.date BETWEEN '1997-01-01' AND '1997-12-31'    AND t.amount > 10000; 
SELECT DISTINCT a.account_id FROM account a JOIN `order` o ON a.account_id = o.account_id JOIN district d ON a.district_id = d.district_id WHERE o.k_symbol = 'SIPO' AND d.A3 = 'Pisek'; 
SELECT DISTINCT a.account_id FROM account a JOIN disp d ON a.account_id = d.account_id JOIN card c ON d.disp_id = c.disp_id WHERE c.type = 'gold'; 
SELECT AVG(t.amount) AS average_amount FROM trans t WHERE t.operation = 'VYBER KARTOU'   AND strftime('%Y', t.date) = '2021'; 
WITH avg_amount AS (     SELECT COALESCE(AVG(t2.amount), 0) AS avg_amount     FROM trans t2     WHERE t2.operation = 'VYBER KARTOU'       AND t2.date BETWEEN '1998-01-01' AND '1998-12-31' ) SELECT DISTINCT d.client_id FROM trans t JOIN disp d ON t.account_id = d.account_id JOIN card c ON d.disp_id = c.disp_id WHERE t.operation = 'VYBER KARTOU'   AND t.amount < avg_amount   AND t.date BETWEEN '1998-01-01' AND '1998-12-31'; 
SELECT DISTINCT client.client_id, client.gender, client.birth_date  FROM client JOIN disp ON client.client_id = disp.client_id JOIN account ON disp.account_id = account.account_id JOIN card ON disp.disp_id = card.disp_id JOIN loan ON account.account_id = loan.account_id WHERE client.gender = 'F' AND disp.type = 'OWNER'; 
SELECT COUNT(DISTINCT a.account_id)  FROM client c JOIN district d ON c.district_id = d.district_id JOIN disp dp ON c.client_id = dp.client_id JOIN account a ON dp.account_id = a.account_id WHERE c.gender = 'F' AND d.A3 = 'south Bohemia'; 
SELECT a.account_id FROM account a JOIN district d ON a.district_id = d.district_id JOIN disp dp ON a.account_id = dp.account_id WHERE d.A2 = 'Tabor' AND dp.type = 'OWNER'; 
SELECT DISTINCT a.frequency FROM account a JOIN disp d ON a.account_id = d.account_id JOIN district dist ON a.district_id = dist.district_id WHERE d.type != 'OWNER' AND dist.A11 > 8000 AND dist.A11 <= 9000; 
SELECT COUNT(DISTINCT a.account_id) AS account_count FROM account a JOIN district d ON a.district_id = d.district_id JOIN trans t ON a.account_id = t.account_id WHERE d.A3 = 'North Bohemia' AND t.bank = 'AB'; 
SELECT DISTINCT d.A2 AS district_name FROM district d JOIN account a ON d.district_id = a.district_id JOIN trans t ON a.account_id = t.account_id WHERE t.type = 'VYDAJ'; 
SELECT AVG(d.A15) AS avg_crimes_1995 FROM district d WHERE d.A15 > 4000   AND d.district_id IN (     SELECT a.district_id     FROM account a     WHERE a.date >= '1997-01-01'   ); 
SELECT COUNT(DISTINCT c.card_id) AS classic_cards_eligible_for_loan FROM card c JOIN disp d ON c.disp_id = d.disp_id WHERE c.type = 'classic' AND d.type = 'OWNER'; 
SELECT COUNT(*) AS male_clients_count FROM client JOIN district ON client.district_id = district.district_id WHERE client.gender = 'M' AND district.A2 = 'Hl.m. Praha'; 
SELECT      (CAST(SUM(CASE WHEN type = 'gold' AND issued < '1998-01-01' THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)) * 100 AS percent_of_gold FROM card; 
SELECT c.client_id, c.gender, c.birth_date, c.district_id FROM loan l JOIN account a ON l.account_id = a.account_id JOIN disp d ON a.account_id = d.account_id JOIN client c ON d.client_id = c.client_id WHERE l.amount = (SELECT MAX(amount) FROM loan) AND d.type = 'OWNER'; 
SELECT d.A15 AS number_of_committed_crimes_1995 FROM account a JOIN district d ON a.district_id = d.district_id WHERE a.account_id = 532; 
SELECT a.district_id FROM `order` o JOIN `account` a ON o.account_id = a.account_id WHERE o.order_id = 33333; 
SELECT * FROM trans WHERE account_id IN (     SELECT account_id     FROM disp     WHERE client_id = 3356 ) AND operation = 'VYBER'; 
SELECT COUNT(DISTINCT account.account_id)  FROM account  JOIN loan ON account.account_id = loan.account_id  WHERE account.frequency = 'POPLATEK TYDNE' AND loan.amount < 200000; 
SELECT c.type  FROM card c JOIN disp d ON c.disp_id = d.disp_id WHERE d.client_id = 13539; 
SELECT d.A3 AS region FROM client c JOIN district d ON c.district_id = d.district_id WHERE c.client_id = 3541; 
SELECT d.A2 AS district_name, COUNT(*) AS account_count FROM district d JOIN client c ON d.district_id = c.district_id JOIN disp dp ON c.client_id = dp.client_id JOIN loan l ON dp.account_id = l.account_id WHERE l.status = 'A' GROUP BY d.A2 ORDER BY account_count DESC LIMIT 1; 
SELECT client.client_id, client.gender, client.birth_date, client.district_id FROM client JOIN disp ON client.client_id = disp.client_id JOIN `order` ON disp.account_id = `order`.account_id WHERE `order`.order_id = 32423; 
SELECT t.* FROM trans t JOIN account a ON t.account_id = a.account_id WHERE a.district_id = 5; 
SELECT COUNT(*)  FROM account a JOIN district d ON a.district_id = d.district_id WHERE d.A3 = 'Jesenik'; 
SELECT DISTINCT c.client_id FROM client c JOIN disp d ON c.client_id = d.client_id JOIN card ca ON d.disp_id = ca.disp_id WHERE ca.type = 'junior' AND ca.issued >= '1997-01-01'; 
SELECT      (COUNT(DISTINCT c.client_id) * 100.0 /      (SELECT COUNT(DISTINCT c1.client_id)      FROM client c1      JOIN account a1 ON c1.district_id = a1.district_id      JOIN district d1 ON c1.district_id = d1.district_id      WHERE d1.A11 > 10000)) AS percentage_of_women FROM      client c JOIN      account a ON c.district_id = a.district_id JOIN      district d ON c.district_id = d.district_id WHERE      c.gender = 'F' AND d.A11 > 10000; 
WITH loan_aggregates AS (     SELECT          strftime('%Y', l.date) AS loan_year,         SUM(l.amount) AS total_amount     FROM          loan l     JOIN          disp d ON l.account_id = d.account_id     JOIN          client c ON d.client_id = c.client_id     WHERE          c.gender = 'M' AND strftime('%Y', l.date) IN ('1996', '1997')     GROUP BY          strftime('%Y', l.date) ) SELECT      CASE          WHEN amount_1996 IS NULL OR amount_1996 = 0 THEN NULL         ELSE ((amount_1997 - amount_1996) / amount_1996) * 100     END AS growth_rate FROM (     SELECT          MAX(CASE WHEN loan_year = '1996' THEN total_amount ELSE NULL END) AS amount_1996,         MAX(CASE WHEN loan_year = '1997' THEN total_amount ELSE NULL END) AS amount_1997     FROM          loan_aggregates ) AS loan_growth; 
SELECT COUNT(*) AS credit_card_withdrawals FROM trans WHERE operation = 'VYBER KARTOU' AND date > '1995-12-31'; 
SELECT      ABS(SUM(CASE WHEN A3 = 'North Bohemia' THEN A16 ELSE 0 END) - SUM(CASE WHEN A3 = 'East Bohemia' THEN A16 ELSE 0 END)) AS crime_difference FROM district; 
SELECT type, COUNT(*) AS total FROM disp WHERE account_id BETWEEN 1 AND 10 GROUP BY type; 
SELECT frequency AS account_statement_frequency  FROM account  WHERE account_id = 3;  SELECT k_symbol AS aim_of_debiting  FROM "order"  WHERE account_id = 3 AND amount = 327; 
SELECT strftime('%Y', c.birth_date) AS birth_year FROM client c JOIN disp d ON c.client_id = d.client_id WHERE d.type = 'OWNER' AND d.account_id = 2; 
SELECT COUNT(*) AS total_accounts FROM account a JOIN disp d ON a.account_id = d.account_id WHERE d.type = 'OWNER' AND a.frequency = 'POPLATEK PO OBRATU'; 
SELECT l.amount AS debt_amount, l.status AS payment_status FROM client c JOIN disp d ON c.client_id = d.client_id JOIN loan l ON d.account_id = l.account_id WHERE c.client_id = 992; 
SELECT      t.balance AS balance_after_transaction_851,      c.gender  FROM      trans t  JOIN      account a ON t.account_id = a.account_id  JOIN      disp d ON a.account_id = d.account_id  JOIN      client c ON d.client_id = c.client_id  WHERE      d.type = 'OWNER'      AND c.client_id = 4      AND t.trans_id = 851; 
SELECT c.type  FROM card c JOIN disp d ON c.disp_id = d.disp_id WHERE d.client_id = 9; 
SELECT SUM(t.amount) AS total_paid FROM disp d JOIN trans t ON d.account_id = t.account_id WHERE d.client_id = 1   AND t.date BETWEEN '1998-01-01' AND '1998-12-31'   AND t.type = 'VYDAJ'; 
SELECT c.client_id, c.gender, c.birth_date  FROM client c JOIN district d ON c.district_id = d.district_id WHERE c.birth_date BETWEEN '1983-01-01' AND '1987-12-31' AND d.A2 = 'East Bohemia'; 
SELECT c.client_id FROM client c JOIN disp d ON c.client_id = d.client_id JOIN loan l ON d.account_id = l.account_id WHERE c.gender = 'F' ORDER BY l.amount DESC LIMIT 3; 
SELECT COUNT(DISTINCT c.client_id) AS male_customers_count FROM client c JOIN disp d ON c.client_id = d.client_id JOIN `order` o ON d.account_id = o.account_id WHERE c.gender = 'M' AND c.birth_date BETWEEN '1974-01-01' AND '1976-12-31' AND o.k_symbol = 'SIPO' AND o.amount > 4000; 
SELECT COUNT(*) AS account_count FROM account WHERE date > '1996-12-31'; 
SELECT COUNT(DISTINCT client.client_id) AS female_customers_with_junior_card FROM client JOIN disp ON client.client_id = disp.client_id JOIN card ON disp.disp_id = card.disp_id WHERE client.gender = 'F' AND card.type = 'junior'; 
SELECT      (COUNT(DISTINCT c.client_id) * 100.0 / (SELECT COUNT(DISTINCT c2.client_id)                                              FROM client c2                                             JOIN district d2 ON c2.district_id = d2.district_id                                             WHERE d2.A3 LIKE '%Prague%')) AS percentage_female FROM client c JOIN district d ON c.district_id = d.district_id WHERE c.gender = 'F' AND d.A3 LIKE '%Prague%'; 
SELECT      (CAST(COUNT(DISTINCT c.client_id) AS FLOAT) /      (SELECT COUNT(DISTINCT d.client_id)       FROM account a       JOIN disp d ON a.account_id = d.account_id       WHERE a.frequency = 'POPLATEK TYDNE')) * 100 AS percentage_male_clients FROM account a JOIN disp d ON a.account_id = d.account_id JOIN client c ON d.client_id = c.client_id WHERE a.frequency = 'POPLATEK TYDNE' AND c.gender = 'M'; 
SELECT COUNT(DISTINCT c.client_id) AS weekly_owners_count FROM client c JOIN disp d ON c.client_id = d.client_id JOIN account a ON d.account_id = a.account_id WHERE d.type = 'OWNER' AND a.frequency = 'POPLATEK TYDNE'; 
SELECT a.account_id, l.amount, l.duration, a.date FROM account a JOIN loan l ON a.account_id = l.account_id WHERE l.duration > 24   AND a.date < '1997-01-01'   AND l.amount = (     SELECT MIN(l2.amount)     FROM loan l2     JOIN account a2 ON l2.account_id = a2.account_id     WHERE l2.duration > 24       AND a2.date < '1997-01-01'   ); 
SELECT DISTINCT a.account_id FROM account a JOIN disp d ON a.account_id = d.account_id JOIN client c ON d.client_id = c.client_id JOIN district dis ON c.district_id = dis.district_id WHERE c.gender = 'F' AND c.birth_date = (SELECT MIN(c2.birth_date)                      FROM client c2                      WHERE c2.gender = 'F') AND dis.A11 = (SELECT MIN(dis2.A11)                 FROM district dis2                JOIN client c3 ON dis2.district_id = c3.district_id                WHERE c3.gender = 'F'); 
SELECT COUNT(DISTINCT c.client_id) AS client_count FROM client c JOIN district d ON c.district_id = d.district_id WHERE c.birth_date BETWEEN '1920-01-01' AND '1920-12-31'   AND d.A3 = 'east Bohemia'; 
SELECT COUNT(*)  FROM loan  JOIN account ON loan.account_id = account.account_id  WHERE loan.duration = 24 AND account.frequency = 'POPLATEK TYDNE'; 
SELECT AVG(loan.amount) AS average_loan_amount FROM loan JOIN account ON loan.account_id = account.account_id WHERE loan.status IN ('C', 'D') AND account.frequency = 'POPLATEK PO OBRATU'; 
SELECT client.client_id, client.district_id FROM client JOIN disp ON client.client_id = disp.client_id WHERE disp.type = 'OWNER'; 
SELECT c.client_id,         CAST((julianday('now') - julianday(c.birth_date)) / 365.25 AS INTEGER) AS age FROM client c JOIN disp d ON c.client_id = d.client_id JOIN card ca ON d.disp_id = ca.disp_id LEFT JOIN loan l ON d.account_id = l.account_id WHERE ca.type = 'gold'    AND d.type = 'OWNER'   AND (l.status = 'A' OR l.loan_id IS NULL); 
SELECT bond_type, COUNT(bond_type) AS bond_count FROM bond GROUP BY bond_type ORDER BY bond_count DESC LIMIT 1; 
SELECT COUNT(DISTINCT m.molecule_id) AS molecule_count FROM molecule m JOIN atom a ON m.molecule_id = a.molecule_id WHERE m.label = '-' AND a.element = 'cl'; 
SELECT AVG(oxygen_count) AS avg_oxygen_atoms FROM (     SELECT a.molecule_id,             SUM(CASE WHEN a.element = 'o' THEN 1 ELSE 0 END) AS oxygen_count     FROM atom a     WHERE a.molecule_id IN (         SELECT DISTINCT molecule_id         FROM bond         WHERE bond_type = '-'     )     GROUP BY a.molecule_id ) molecule_oxygen_counts; 
SELECT AVG(single_bond_count) AS average_single_bonds_per_carcinogenic_molecule FROM (     SELECT          m.molecule_id,         COUNT(b.bond_id) AS single_bond_count     FROM molecule m     JOIN bond b ON m.molecule_id = b.molecule_id     WHERE m.label = '+' AND b.bond_type = '-'     GROUP BY m.molecule_id ) AS subquery; 
SELECT 0 AS non_carcinogenic_sodium_count; 
SELECT DISTINCT m.molecule_id  FROM molecule m JOIN bond b ON m.molecule_id = b.molecule_id WHERE b.bond_type = '#' AND m.label = '+'; 
WITH double_bond_atoms AS (     SELECT DISTINCT c.atom_id     FROM bond b     JOIN connected c ON b.bond_id = c.bond_id     WHERE b.bond_type = '='     UNION     SELECT DISTINCT c.atom_id2     FROM bond b     JOIN connected c ON b.bond_id = c.bond_id     WHERE b.bond_type = '=' ) SELECT      (CAST(SUM(CASE WHEN a.element = 'c' THEN 1 ELSE 0 END) AS FLOAT)       / NULLIF(COUNT(a.atom_id), 0)) * 100 AS percentage_of_carbon FROM      atom a JOIN      double_bond_atoms dba ON a.atom_id = dba.atom_id; 
SELECT COUNT(*)  FROM bond  WHERE bond_type = '#'; 
SELECT COUNT(*)  FROM atom  WHERE element <> 'br'; 
SELECT COUNT(*) AS carcinogenic_count FROM molecule WHERE molecule_id BETWEEN 'TR000' AND 'TR099' AND label = '+'; 
SELECT DISTINCT m.molecule_id FROM atom a JOIN molecule m ON a.molecule_id = m.molecule_id WHERE a.element = 'c'; 
SELECT a.element  FROM connected c JOIN atom a ON c.atom_id = a.atom_id WHERE c.bond_id = 'TR004_8_9'; 
SELECT DISTINCT a1.element AS element_1, a2.element AS element_2 FROM bond b JOIN connected c ON b.bond_id = c.bond_id JOIN atom a1 ON a1.atom_id = c.atom_id JOIN atom a2 ON a2.atom_id = c.atom_id2 WHERE b.bond_type = '='; 
SELECT m.label, COUNT(m.label) AS label_count FROM atom a INNER JOIN molecule m ON a.molecule_id = m.molecule_id WHERE a.element = 'h' GROUP BY m.label ORDER BY label_count DESC LIMIT 1; 
SELECT DISTINCT b.bond_type FROM atom a JOIN connected c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2 JOIN bond b ON c.bond_id = b.bond_id WHERE a.element = 'cl'; 
SELECT c.atom_id, c.atom_id2 FROM connected c JOIN bond b ON c.bond_id = b.bond_id WHERE b.bond_type = '-'; 
SELECT c.atom_id, c.atom_id2 FROM connected c JOIN atom a1 ON c.atom_id = a1.atom_id JOIN atom a2 ON c.atom_id2 = a2.atom_id JOIN molecule m ON a1.molecule_id = m.molecule_id WHERE m.label = '-'; 
SELECT atom.element, COUNT(atom.element) AS element_count FROM atom JOIN molecule ON atom.molecule_id = molecule.molecule_id WHERE molecule.label = '-' GROUP BY atom.element ORDER BY element_count ASC LIMIT 1; 
SELECT b.bond_type FROM connected c JOIN bond b ON c.bond_id = b.bond_id WHERE (c.atom_id = 'TR004_8' AND c.atom_id2 = 'TR004_20')     OR (c.atom_id = 'TR004_20' AND c.atom_id2 = 'TR004_8'); 
SELECT DISTINCT m.label FROM molecule m WHERE m.molecule_id NOT IN (     SELECT DISTINCT a.molecule_id     FROM atom a     WHERE a.element = 'sn' AND a.molecule_id IS NOT NULL ); 
SELECT COUNT(DISTINCT a.atom_id) AS total_atom_count FROM atom a JOIN connected c ON a.atom_id = c.atom_id JOIN bond b ON c.bond_id = b.bond_id WHERE b.bond_type = '-' AND a.element IN ('i', 's') UNION SELECT COUNT(DISTINCT a.atom_id) AS total_atom_count FROM atom a JOIN connected c ON a.atom_id = c.atom_id2 JOIN bond b ON c.bond_id = b.bond_id WHERE b.bond_type = '-' AND a.element IN ('i', 's'); 
SELECT c.atom_id, c.atom_id2 FROM connected c JOIN bond b ON c.bond_id = b.bond_id WHERE b.bond_type = '#'; 
SELECT c.atom_id2  FROM connected c JOIN atom a ON c.atom_id = a.atom_id WHERE a.molecule_id = 'TR181'; 
SELECT      (COUNT(DISTINCT m1.molecule_id) * 100.0) / COUNT(DISTINCT m2.molecule_id) AS percentage_without_fluorine FROM      molecule m1 LEFT JOIN atom a      ON m1.molecule_id = a.molecule_id AND a.element = 'f' JOIN molecule m2     ON m1.molecule_id = m2.molecule_id WHERE      m1.label = '+'     AND m2.label = '+'     AND a.molecule_id IS NULL; 
SELECT      CASE          WHEN COUNT(b.bond_id) = 0 THEN 0         ELSE (COUNT(b.bond_id) * 100.0) / (             SELECT COUNT(*)              FROM molecule m              WHERE m.label = '+'         )     END AS percent FROM      bond b JOIN      molecule m ON      b.molecule_id = m.molecule_id WHERE      b.bond_type = '#'; 
SELECT element, COUNT(*) AS count FROM atom WHERE molecule_id = 'TR000' GROUP BY element ORDER BY COUNT(*) DESC, element ASC LIMIT 3; 
SELECT a1.atom_id AS atom1, a2.atom_id AS atom2 FROM connected c JOIN atom a1 ON c.atom_id = a1.atom_id JOIN atom a2 ON c.atom_id2 = a2.atom_id WHERE c.bond_id = 'TR001_2_6' AND a1.molecule_id = 'TR001' AND a2.molecule_id = 'TR001'; 
SELECT      (SUM(CASE WHEN label = '+' THEN 1 ELSE 0 END) - SUM(CASE WHEN label = '-' THEN 1 ELSE 0 END)) AS difference FROM molecule; 
SELECT atom_id, atom_id2 FROM connected WHERE bond_id = 'TR000_2_5'; 
SELECT bond_id  FROM connected  WHERE atom_id2 = 'TR000_2'; 
SELECT DISTINCT m.molecule_id FROM molecule m JOIN bond b ON m.molecule_id = b.molecule_id WHERE b.bond_type = '=' ORDER BY m.molecule_id LIMIT 5; 
SELECT      CASE          WHEN EXISTS (SELECT 1 FROM molecule WHERE molecule_id = 'TR008') THEN              (SELECT                  CASE                      WHEN COUNT(b.bond_id) = 0 THEN NULL                     ELSE CAST(SUM(CASE WHEN b.bond_type = '=' THEN 1 ELSE 0 END) AS FLOAT) / CAST(COUNT(b.bond_id) AS FLOAT) * 100                 END AS percent              FROM bond b              WHERE b.molecule_id = 'TR008')         ELSE NULL     END AS percent; 
SELECT ROUND((SUM(CASE WHEN label = '+' THEN 1 ELSE 0 END) * 100.0) / COUNT(molecule_id), 3) AS percentage FROM molecule; 
SELECT      CASE          WHEN NOT EXISTS (SELECT 1 FROM atom WHERE molecule_id = 'TR206') THEN 0         ELSE (             SELECT CAST(SUM(CASE WHEN element = 'h' THEN 1 ELSE 0 END) AS FLOAT) / COUNT(atom_id) * 100             FROM atom             WHERE molecule_id = 'TR206'         )     END AS percentage; 
SELECT DISTINCT bond_type FROM bond WHERE molecule_id = 'TR000'; 
SELECT m.label FROM molecule m WHERE m.molecule_id = 'TR006'; 
SELECT b.bond_type, m.label AS carcinogenic_status FROM bond b JOIN molecule m ON b.molecule_id = m.molecule_id WHERE b.molecule_id = 'TR010' GROUP BY b.bond_type, m.label ORDER BY COUNT(b.bond_type) DESC LIMIT 1; 
SELECT DISTINCT m.molecule_id FROM molecule m JOIN bond b ON m.molecule_id = b.molecule_id WHERE m.label = '-' AND b.bond_type = '-' ORDER BY m.molecule_id LIMIT 3; 
SELECT bond_id  FROM bond  WHERE molecule_id = 'TR006'  ORDER BY bond_id ASC  LIMIT 2; 
SELECT COUNT(*) FROM bond b JOIN connected c ON b.bond_id = c.bond_id WHERE b.molecule_id = 'TR009' AND ('TR009_12' IN (c.atom_id, c.atom_id2)); 
SELECT COUNT(DISTINCT m.molecule_id) AS carcinogenic_bromine_molecules FROM molecule m JOIN atom a ON m.molecule_id = a.molecule_id WHERE m.label = '+' AND a.element = 'br'; 
SELECT b.bond_type, c.atom_id, c.atom_id2 FROM bond b JOIN connected c ON b.bond_id = c.bond_id WHERE b.bond_id = 'TR001_6_9'; 
SELECT m.molecule_id,         CASE             WHEN m.label = '+' THEN 'Carcinogenic'             ELSE 'Not Carcinogenic'         END AS carcinogenic_status FROM molecule m JOIN atom a ON m.molecule_id = a.molecule_id WHERE a.atom_id = 'TR001_10'; 
SELECT COUNT(DISTINCT molecule_id)  FROM bond  WHERE bond_type = '#'; 
SELECT COUNT(*) FROM connected WHERE atom_id LIKE 'TR%_19' OR atom_id2 LIKE 'TR%_19'; 
SELECT element  FROM atom  WHERE molecule_id = 'TR004'; 
SELECT COUNT(*)  FROM molecule  WHERE label = '-'; 
SELECT DISTINCT m.* FROM molecule m JOIN atom a ON m.molecule_id = a.molecule_id WHERE CAST(SUBSTR(a.atom_id, INSTR(a.atom_id, '_') + 1) AS INTEGER) BETWEEN 21 AND 25   AND m.label = '+'; 
SELECT DISTINCT b.* FROM bond b JOIN connected c ON b.bond_id = c.bond_id JOIN atom a1 ON c.atom_id = a1.atom_id JOIN atom a2 ON c.atom_id2 = a2.atom_id WHERE (a1.element = 'p' AND a2.element = 'n') OR (a1.element = 'n' AND a2.element = 'p'); 
SELECT      CASE          WHEN m.label = '+' THEN 'Yes'          ELSE 'No'      END AS is_carcinogenic FROM molecule m WHERE m.molecule_id = (     SELECT b.molecule_id     FROM bond b     WHERE b.bond_type = '='     GROUP BY b.molecule_id     ORDER BY COUNT(b.bond_id) DESC     LIMIT 1 ); 
SELECT      CASE         WHEN COUNT(DISTINCT a.atom_id) = 0 THEN 0         ELSE COUNT(DISTINCT c.bond_id) * 1.0 / COUNT(DISTINCT a.atom_id)     END AS avg_bonds FROM atom a LEFT JOIN connected c      ON a.atom_id = c.atom_id WHERE a.element = 'i'; 
SELECT bond_type, bond_id FROM bond WHERE bond_id LIKE '%_45'; 
SELECT element FROM atom a WHERE a.atom_id NOT IN (     SELECT atom_id     FROM connected     UNION     SELECT atom_id2     FROM connected ); 
SELECT a.atom_id FROM atom a JOIN connected c ON a.atom_id = c.atom_id JOIN bond b ON c.bond_id = b.bond_id WHERE b.molecule_id = 'TR041' AND b.bond_type = '#'; 
SELECT a.element FROM connected c JOIN atom a    ON a.atom_id = c.atom_id WHERE c.bond_id = 'TR144_8_19' UNION SELECT a.element FROM connected c JOIN atom a    ON a.atom_id = c.atom_id2 WHERE c.bond_id = 'TR144_8_19'; 
SELECT b.molecule_id, COUNT(*) AS double_bond_count FROM bond b JOIN molecule m ON b.molecule_id = m.molecule_id WHERE m.label = '+' AND b.bond_type = '=' GROUP BY b.molecule_id ORDER BY double_bond_count DESC LIMIT 1; 
SELECT a.element, COUNT(a.element) AS element_count FROM molecule m LEFT JOIN atom a ON m.molecule_id = a.molecule_id WHERE m.label = '+' GROUP BY a.element HAVING a.element IS NOT NULL ORDER BY element_count ASC LIMIT 1; 
SELECT DISTINCT a2.atom_id FROM atom a1 JOIN connected c ON a1.atom_id = c.atom_id JOIN atom a2 ON c.atom_id2 = a2.atom_id WHERE a1.element = 'pb'; 
SELECT DISTINCT a.element FROM bond b JOIN connected c ON b.bond_id = c.bond_id JOIN atom a ON a.atom_id = c.atom_id WHERE b.bond_type = '#'; 
WITH DeduplicatedConnections AS (     SELECT DISTINCT          LEAST(atom_id, atom_id2) AS atom1,         GREATEST(atom_id, atom_id2) AS atom2,         bond_id     FROM connected ), ElementCombinations AS (     SELECT          a1.element AS element1,         a2.element AS element2,         COUNT(dc.bond_id) AS bond_count     FROM DeduplicatedConnections dc     JOIN atom a1 ON dc.atom1 = a1.atom_id     JOIN atom a2 ON dc.atom2 = a2.atom_id     GROUP BY a1.element, a2.element ), MostCommonCombination AS (     SELECT          element1,         element2,         bond_count AS max_bond_count     FROM ElementCombinations     WHERE bond_count = (SELECT MAX(bond_count) FROM ElementCombinations) ), TotalBonds AS (     SELECT COUNT(DISTINCT bond_id) AS total_bonds     FROM bond ) SELECT      (mcc.max_bond_count * 100.0 / tb.total_bonds) AS percentage,     mcc.element1,     mcc.element2 FROM MostCommonCombination mcc CROSS JOIN TotalBonds tb; 
SELECT CAST(SUM(CASE WHEN m.label = '+' THEN 1 ELSE 0 END) * 100.0 / COUNT(b.bond_id) AS DECIMAL(10, 5)) AS proportion FROM bond b JOIN molecule m ON b.molecule_id = m.molecule_id WHERE b.bond_type = '-'; 
SELECT COUNT(*) AS count_of_atoms FROM atom WHERE atom.element IN ('c', 'h'); 
SELECT c.atom_id2 FROM atom a JOIN connected c ON a.atom_id = c.atom_id WHERE a.element = 's'; 
SELECT DISTINCT b.bond_type FROM atom a JOIN connected c ON a.atom_id = c.atom_id JOIN bond b ON c.bond_id = b.bond_id WHERE a.element = 'sn'; 
SELECT COUNT(DISTINCT a.element) FROM atom a JOIN connected c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2 JOIN bond b ON c.bond_id = b.bond_id WHERE b.bond_type = '-'; 
SELECT COUNT(DISTINCT a.atom_id) AS total_atoms FROM atom a JOIN connected c ON a.atom_id = c.atom_id JOIN bond b ON c.bond_id = b.bond_id WHERE b.bond_type = '#'   AND a.element IN ('p', 'br'); 
SELECT bond_id  FROM bond  WHERE molecule_id IN (SELECT molecule_id FROM molecule WHERE label = '+'); 
SELECT DISTINCT m.molecule_id FROM molecule m JOIN bond b ON m.molecule_id = b.molecule_id WHERE b.bond_type = '-' AND m.label = '-'; 
SELECT      (CAST(SUM(CASE WHEN a.element = 'cl' THEN 1 ELSE 0 END) AS FLOAT)       / COUNT(a.atom_id)) * 100 AS percent FROM      atom a JOIN      bond b ON a.molecule_id = b.molecule_id WHERE      b.bond_type = '-'; 
SELECT molecule_id, label  FROM molecule  WHERE molecule_id IN ('TR000', 'TR001', 'TR002'); 
SELECT molecule_id  FROM molecule  WHERE label = '-'; 
SELECT COUNT(*) AS total_carcinogenic_molecules FROM molecule WHERE molecule_id BETWEEN 'TR000' AND 'TR030' AND label = '+'; 
SELECT molecule_id, bond_type  FROM bond  WHERE molecule_id BETWEEN 'TR000' AND 'TR050'; 
SELECT a.element FROM atom a JOIN connected c   ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2 WHERE c.bond_id = 'TR001_10_11'; 
SELECT COUNT(DISTINCT b.bond_id) FROM bond b JOIN connected c ON b.bond_id = c.bond_id JOIN atom a ON c.atom_id = a.atom_id WHERE a.element = 'i'; 
SELECT      CASE          WHEN COUNT(*) = 0 THEN 'No molecules contain Calcium'         WHEN SUM(CASE WHEN label = '+' THEN 1 ELSE 0 END) > SUM(CASE WHEN label = '-' THEN 1 ELSE 0 END)          THEN 'Mostly carcinogenic'          ELSE 'Mostly non-carcinogenic'      END AS result FROM molecule WHERE molecule_id IN (     SELECT DISTINCT molecule_id     FROM atom     WHERE element = 'ca' ); 
SELECT      CASE WHEN          COUNT(DISTINCT CASE WHEN a1.element = 'cl' THEN a1.element END) > 0          AND COUNT(DISTINCT CASE WHEN a2.element = 'c' THEN a2.element END) > 0      THEN 1 ELSE 0 END AS has_chlorine_and_carbon FROM connected c JOIN atom a1 ON c.atom_id = a1.atom_id JOIN atom a2 ON c.atom_id2 = a2.atom_id WHERE c.bond_id = 'TR001_1_8'; 
SELECT DISTINCT m.molecule_id FROM molecule m JOIN atom a ON m.molecule_id = a.molecule_id JOIN connected c ON a.atom_id = c.atom_id JOIN bond b ON c.bond_id = b.bond_id WHERE a.element = 'c' AND m.label = '-'  LIMIT 2; 
WITH molecule_atom_counts AS (     SELECT          m.molecule_id,         COALESCE(SUM(CASE WHEN a.element = 'cl' THEN 1 ELSE 0 END), 0) AS chlorine_count,         COUNT(a.atom_id) AS total_atoms     FROM          molecule m     LEFT JOIN          atom a     ON          m.molecule_id = a.molecule_id     WHERE          m.label = '+'     GROUP BY          m.molecule_id ) SELECT      CASE          WHEN SUM(total_atoms) = 0 THEN 0         ELSE SUM(chlorine_count) * 100.0 / SUM(total_atoms)     END AS percentage FROM      molecule_atom_counts; 
SELECT DISTINCT element FROM atom WHERE molecule_id = 'TR001'; 
SELECT DISTINCT molecule_id  FROM bond  WHERE bond_type = '='; 
SELECT c.atom_id AS first_atom, c.atom_id2 AS second_atom FROM connected c JOIN bond b ON c.bond_id = b.bond_id WHERE b.bond_type = '#'; 
SELECT DISTINCT a.element FROM atom a WHERE a.atom_id IN (     SELECT c.atom_id     FROM connected c     WHERE c.bond_id = 'TR000_1_2'     UNION     SELECT c.atom_id2     FROM connected c     WHERE c.bond_id = 'TR000_1_2' ); 
SELECT COUNT(DISTINCT b.molecule_id) AS non_carcinogenic_single_bond_molecules FROM bond b JOIN molecule m ON b.molecule_id = m.molecule_id WHERE b.bond_type = '-' AND m.label = '-'; 
SELECT m.label  FROM bond b JOIN molecule m ON b.molecule_id = m.molecule_id WHERE b.bond_id = 'TR001_10_11'; 
SELECT b.bond_id,         CASE WHEN m.label = '+' THEN 'carcinogenic' ELSE 'non-carcinogenic' END AS carcinogenic_status FROM bond b JOIN molecule m ON b.molecule_id = m.molecule_id WHERE b.bond_type = '#'; 
SELECT m.molecule_id, a.element AS toxicology_element FROM molecule m JOIN atom a ON m.molecule_id = a.molecule_id WHERE m.label = '+'   AND substr(a.atom_id, 7, 1) = '4'; 
SELECT      CASE          WHEN COUNT(a.element) = 0 THEN 0         ELSE COALESCE(CAST(SUM(CASE WHEN a.element = 'h' THEN 1 ELSE 0 END) AS FLOAT), 0) / CAST(COUNT(a.element) AS FLOAT)     END AS ratio,      m.label  FROM      molecule m  LEFT JOIN      atom a  ON      m.molecule_id = a.molecule_id  WHERE      m.molecule_id = 'TR006' GROUP BY      m.label; 
SELECT      m.molecule_id,     CASE          WHEN EXISTS (             SELECT 1              FROM atom a             WHERE a.molecule_id = m.molecule_id               AND a.element = 'ca'         ) THEN              CASE                  WHEN m.label = '+' THEN 'Carcinogenic'                 WHEN m.label = '-' THEN 'Non-Carcinogenic'             END         ELSE 'No Calcium Found'     END AS compound_status FROM      molecule m; 
SELECT DISTINCT b.bond_type FROM bond b JOIN connected c ON b.bond_id = c.bond_id JOIN atom a ON c.atom_id = a.atom_id WHERE a.element = 'c'; 
SELECT DISTINCT a.element FROM atom a WHERE a.atom_id IN ('TR001_10', 'TR001_11'); 
SELECT      (COUNT(DISTINCT b.molecule_id) * 100.0 / (SELECT COUNT(DISTINCT molecule_id) FROM molecule)) AS triple_bond_percentage FROM      bond b WHERE      b.bond_type = '#'; 
SELECT      CASE          WHEN COUNT(bond_id) = 0 THEN 0         ELSE (SUM(CASE WHEN bond_type = '=' THEN 1 ELSE 0 END) * 100.0) / COUNT(bond_id)     END AS percent FROM bond WHERE molecule_id = 'TR047'; 
SELECT      COALESCE(m.label, 'Not Found') AS molecule_status FROM      atom a LEFT JOIN      molecule m ON      a.molecule_id = m.molecule_id WHERE      a.atom_id = 'TR001_1'; 
SELECT CASE             WHEN label = '+' THEN 'Yes'             ELSE 'No'         END AS is_carcinogenic FROM molecule WHERE molecule_id = 'TR151'; 
SELECT DISTINCT a.element  FROM atom a WHERE a.molecule_id = 'TR151'  AND a.element = 'cl'; 
SELECT COUNT(*) AS carcinogenic_compounds FROM molecule WHERE label = '+'; 
SELECT atom_id  FROM atom  WHERE element = 'c' AND LENGTH(molecule_id) >= 5 AND substr(molecule_id, 3, 3) NOT LIKE '%[^0-9]%' AND CAST(substr(molecule_id, 3, 3) AS INTEGER) BETWEEN 10 AND 50; 
SELECT COUNT(*)  FROM atom  WHERE molecule_id IN (     SELECT molecule_id      FROM molecule      WHERE label = '+' ); 
SELECT bond_id FROM bond WHERE bond_type = '=' AND molecule_id IN (     SELECT molecule_id     FROM molecule     WHERE label = '+' ); 
SELECT COUNT(*) FROM atom INNER JOIN molecule ON atom.molecule_id = molecule.molecule_id WHERE atom.element = 'h' AND molecule.label = '+'; 
SELECT b.molecule_id FROM bond b JOIN connected c ON b.bond_id = c.bond_id WHERE c.atom_id = 'TR000_1' AND b.bond_id = 'TR000_1_2'; 
SELECT a.atom_id FROM atom a JOIN molecule m ON a.molecule_id = m.molecule_id WHERE a.element = 'c'    AND m.label = '-'; 
SELECT      (CAST(COUNT(DISTINCT a.molecule_id) AS FLOAT) /       CAST(COUNT(DISTINCT m.molecule_id) AS FLOAT)) * 100.0 AS percentage FROM      molecule m INNER JOIN      atom a ON m.molecule_id = a.molecule_id WHERE      m.label = '+'     AND a.element = 'h'; 
SELECT      CASE          WHEN label = '+' THEN 'Yes'         WHEN label = '-' THEN 'No'         ELSE 'Molecule not found'     END AS is_carcinogenic FROM molecule WHERE molecule_id = 'TR124'; 
SELECT *  FROM atom WHERE molecule_id = 'TR186'; 
SELECT bond_type  FROM bond  WHERE bond_id = 'TR007_4_19'; 
SELECT DISTINCT a.element FROM bond b JOIN connected c ON b.bond_id = c.bond_id JOIN atom a ON c.atom_id = a.atom_id WHERE b.bond_id = 'TR000_2_4'; 
SELECT      COUNT(b.bond_id) AS double_bond_count,     CASE          WHEN m.label = '+' THEN 'carcinogenic'         ELSE 'non-carcinogenic'     END AS carcinogenic_status FROM      molecule m LEFT JOIN      bond b ON m.molecule_id = b.molecule_id AND b.bond_type = '=' WHERE      m.molecule_id = 'TR006' GROUP BY      m.molecule_id, m.label; 
SELECT m.molecule_id, a.element FROM molecule m JOIN atom a ON m.molecule_id = a.molecule_id WHERE m.label = '+' AND a.element IS NOT NULL; 
SELECT b.bond_id, a1.atom_id AS atom_1, a2.atom_id AS atom_2, b.molecule_id FROM bond b JOIN connected c ON b.bond_id = c.bond_id JOIN atom a1 ON c.atom_id = a1.atom_id JOIN atom a2 ON c.atom_id2 = a2.atom_id WHERE b.bond_type = '-'; 
SELECT DISTINCT m.molecule_id, GROUP_CONCAT(DISTINCT a.element) AS elements FROM bond b JOIN connected c ON b.bond_id = c.bond_id JOIN atom a1 ON a1.atom_id = c.atom_id JOIN atom a2 ON a2.atom_id = c.atom_id2 JOIN molecule m ON b.molecule_id = m.molecule_id WHERE b.bond_type = '#' GROUP BY m.molecule_id; 
SELECT a.element FROM atom a JOIN connected c ON a.atom_id = c.atom_id WHERE c.bond_id = 'TR000_2_3' UNION SELECT a.element FROM atom a JOIN connected c ON a.atom_id = c.atom_id2 WHERE c.bond_id = 'TR000_2_3'; 
SELECT COUNT(DISTINCT b.bond_id) AS bond_count FROM bond b JOIN connected c ON b.bond_id = c.bond_id JOIN atom a1 ON c.atom_id = a1.atom_id JOIN atom a2 ON c.atom_id2 = a2.atom_id WHERE (a1.element = 'cl' OR a2.element = 'cl'); 
SELECT a.atom_id, COUNT(DISTINCT b.bond_type) AS bond_type_count FROM atom a LEFT JOIN bond b ON a.molecule_id = b.molecule_id WHERE a.molecule_id = 'TR346' GROUP BY a.atom_id; 
SELECT      COUNT(DISTINCT CASE WHEN m.label = '+' THEN m.molecule_id END) AS carcinogenic_count,     COUNT(DISTINCT b.molecule_id) AS total_double_bond_molecules FROM      bond b JOIN      molecule m ON      b.molecule_id = m.molecule_id WHERE      b.bond_type = '='; 
SELECT COUNT(DISTINCT m.molecule_id) AS molecule_count FROM molecule m WHERE NOT EXISTS (     SELECT 1     FROM atom a     WHERE a.molecule_id = m.molecule_id     AND a.element = 's' ) AND NOT EXISTS (     SELECT 1     FROM bond b     WHERE b.molecule_id = m.molecule_id     AND b.bond_type = '=' ); 
SELECT m.label  FROM bond b JOIN molecule m ON b.molecule_id = m.molecule_id WHERE b.bond_id = 'TR001_2_4'; 
SELECT COUNT(*)  FROM atom  WHERE molecule_id = 'TR001'; 
SELECT COUNT(*) AS single_bond_count FROM bond WHERE bond_type = '-'; 
SELECT DISTINCT m.molecule_id FROM molecule m JOIN atom a ON m.molecule_id = a.molecule_id WHERE m.label = '+' AND a.element = 'cl'; 
SELECT DISTINCT m.molecule_id FROM molecule m JOIN atom a ON m.molecule_id = a.molecule_id WHERE m.label = '-'  AND a.element = 'c'; 
SELECT      (CAST(COUNT(DISTINCT m.molecule_id) AS FLOAT) /       CAST((SELECT COUNT(*) FROM molecule WHERE label = '+') AS FLOAT)     ) * 100 AS percentage FROM      molecule m INNER JOIN      atom a ON m.molecule_id = a.molecule_id WHERE      m.label = '+' AND a.element = 'cl'; 
SELECT molecule_id  FROM bond  WHERE bond_id = 'TR001_1_7'; 
SELECT COUNT(DISTINCT a.element) AS element_count FROM connected c JOIN atom a ON c.atom_id = a.atom_id WHERE c.bond_id = 'TR001_10_11'; 
SELECT b.bond_type  FROM bond b JOIN connected c ON b.bond_id = c.bond_id WHERE c.atom_id = 'TR000_1' AND c.atom_id2 = 'TR000_2'; 
SELECT m.molecule_id, m.label FROM molecule m JOIN atom a1 ON m.molecule_id = a1.molecule_id JOIN atom a2 ON m.molecule_id = a2.molecule_id WHERE a1.atom_id = 'TR000_2' AND a2.atom_id = 'TR000_4'; 
SELECT a.element,         CASE             WHEN a.element = 'cl' THEN 'Toxic'            WHEN a.element = 'c' THEN 'Non-Toxic'            WHEN a.element = 'h' THEN 'Non-Toxic'            WHEN a.element = 'o' THEN 'Non-Toxic'            WHEN a.element = 's' THEN 'Toxic'            WHEN a.element = 'n' THEN 'Non-Toxic'            WHEN a.element = 'p' THEN 'Toxic'            WHEN a.element = 'na' THEN 'Non-Toxic'            WHEN a.element = 'br' THEN 'Toxic'            WHEN a.element = 'f' THEN 'Toxic'            WHEN a.element = 'i' THEN 'Toxic'            WHEN a.element = 'sn' THEN 'Toxic'            WHEN a.element = 'pb' THEN 'Toxic'            WHEN a.element = 'te' THEN 'Toxic'            WHEN a.element = 'ca' THEN 'Non-Toxic'            ELSE 'Unknown'        END AS toxicology,        m.label AS molecule_label FROM atom a INNER JOIN molecule m ON a.molecule_id = m.molecule_id WHERE a.atom_id = 'TR000_1'; 
SELECT      CASE          WHEN label = '+' THEN 'Carcinogenic'          WHEN label = '-' THEN 'Non-carcinogenic'          ELSE 'Unknown'      END AS carcinogenic_status FROM molecule WHERE molecule_id = 'TR000'; 
SELECT      (CAST(SUM(CASE WHEN b.bond_type = '-' THEN 1 ELSE 0 END) AS FLOAT) / COUNT(b.bond_id)) * 100 AS percentage FROM      bond b; 
SELECT      COUNT(DISTINCT m.molecule_id) AS carcinogenic_nitrogen_molecules_count FROM      molecule m JOIN      atom a ON      m.molecule_id = a.molecule_id WHERE      m.label = '+'     AND a.element = 'n'; 
SELECT DISTINCT m.molecule_id FROM molecule m JOIN atom a ON m.molecule_id = a.molecule_id JOIN connected c ON a.atom_id = c.atom_id JOIN bond b ON c.bond_id = b.bond_id WHERE a.element = 's' AND b.bond_type = '='; 
SELECT molecule.molecule_id FROM molecule JOIN atom ON molecule.molecule_id = atom.molecule_id WHERE molecule.label = '-' GROUP BY molecule.molecule_id HAVING COUNT(atom.molecule_id) > 5; 
SELECT DISTINCT a1.element FROM bond b JOIN connected c ON b.bond_id = c.bond_id JOIN atom a1 ON a1.atom_id = c.atom_id WHERE b.bond_type = '='   AND b.molecule_id = 'TR024'  UNION  SELECT DISTINCT a2.element FROM bond b JOIN connected c ON b.bond_id = c.bond_id JOIN atom a2 ON a2.atom_id = c.atom_id2 WHERE b.bond_type = '='   AND b.molecule_id = 'TR024'; 
SELECT molecule.molecule_id, COUNT(atom.atom_id) AS atom_count FROM molecule JOIN atom ON molecule.molecule_id = atom.molecule_id WHERE molecule.label = '+' GROUP BY molecule.molecule_id ORDER BY atom_count DESC LIMIT 1; 
SELECT      0.0 AS percentage FROM      molecule LIMIT 1; 
SELECT COUNT(*) AS carcinogenic_molecules_count FROM molecule WHERE label = '+'; 
SELECT COUNT(DISTINCT b.molecule_id) AS molecule_count FROM bond b WHERE b.bond_type = '-' AND b.molecule_id BETWEEN 'TR004' AND 'TR010'; 
SELECT COUNT(*)  FROM atom  WHERE molecule_id = 'TR008'  AND element = 'c'; 
SELECT a.element FROM atom a JOIN molecule m ON a.molecule_id = m.molecule_id WHERE m.label = '-' AND a.atom_id = 'TR004_7'; 
SELECT COUNT(DISTINCT m.molecule_id) AS total_molecules FROM molecule m JOIN bond b ON m.molecule_id = b.molecule_id JOIN connected c ON b.bond_id = c.bond_id JOIN atom a1 ON c.atom_id = a1.atom_id JOIN atom a2 ON c.atom_id2 = a2.atom_id WHERE b.bond_type = '='   AND ((a1.element = 'o' AND a2.element != 'o')         OR (a2.element = 'o' AND a1.element != 'o')); 
SELECT COUNT(DISTINCT m.molecule_id) AS non_carcinogenic_molecules_with_triple_bonds FROM molecule m JOIN bond b ON m.molecule_id = b.molecule_id WHERE b.bond_type = '#' AND m.label = '-'; 
SELECT      a.element AS value,     'element' AS type FROM      atom a WHERE      a.molecule_id = 'TR002' UNION ALL SELECT      b.bond_type AS value,     'bond_type' AS type FROM      bond b WHERE      b.molecule_id = 'TR002'; 
SELECT a.atom_id FROM atom a JOIN connected c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2 JOIN bond b ON c.bond_id = b.bond_id WHERE a.element = 'c'   AND b.bond_type = '='   AND a.molecule_id = 'TR012'; 
SELECT a.atom_id  FROM atom a JOIN molecule m ON a.molecule_id = m.molecule_id WHERE m.label = '+' AND a.element = 'o'; 
SELECT *  FROM cards  WHERE cardKingdomFoilId IS NOT NULL AND cardKingdomId IS NOT NULL; 
SELECT *  FROM cards  WHERE borderColor = 'borderless'    AND cardKingdomFoilId IS NULL    AND cardKingdomId IS NOT NULL; 
SELECT name  FROM cards  WHERE faceConvertedManaCost = (SELECT MAX(faceConvertedManaCost) FROM cards); 
SELECT name  FROM cards  WHERE edhrecRank < 100 AND frameVersion = '2015'; 
SELECT c.name  FROM cards c  INNER JOIN legalities l  ON c.uuid = l.uuid  WHERE c.rarity = 'mythic'  AND l.format = 'gladiator'  AND l.status = 'Banned'; 
SELECT c.name,         COALESCE(l.status, 'Not Applicable') AS status FROM cards c LEFT JOIN legalities l      ON c.uuid = l.uuid AND l.format = 'vintage' WHERE c.types LIKE '%Artifact%'        AND (c.side IS NULL OR c.side = ''); 
SELECT c.id, c.artist FROM cards c JOIN legalities l ON c.uuid = l.uuid WHERE (c.power = '*' OR c.power IS NULL) AND l.format = 'commander' AND l.status = 'Legal'; 
SELECT      c.id AS card_id,      COALESCE(r.text, 'No Ruling') AS ruling_text,      CASE          WHEN c.hasContentWarning = 1 OR c.text IS NULL OR c.types IS NULL THEN 'Missing/Degraded'         ELSE 'Normal'     END AS property_status FROM      cards c LEFT JOIN      rulings r  ON      c.uuid = r.uuid WHERE      c.artist = 'Stephen Daniele'; 
SELECT rulings.text  FROM rulings  JOIN cards ON rulings.uuid = cards.uuid  WHERE cards.name = 'Sublime Epiphany' AND cards.number = '74'; 
WITH CardRulings AS (     SELECT          c.uuid,          c.name AS card_name,         c.artist AS artist_name,         c.isPromo AS is_promotional,         COUNT(r.uuid) AS ruling_count     FROM          cards c     LEFT JOIN          rulings r ON c.uuid = r.uuid     GROUP BY          c.uuid ), RankedRulings AS (     SELECT          *,         ROW_NUMBER() OVER (ORDER BY ruling_count DESC) AS rank     FROM          CardRulings ) SELECT      card_name,      artist_name,      is_promotional FROM      RankedRulings WHERE      rank = 1; 
SELECT fd.language  FROM cards c INNER JOIN foreign_data fd ON fd.uuid = c.uuid WHERE LOWER(c.name) = 'annul'    AND c.number = '29'; 
SELECT DISTINCT c.name FROM cards c JOIN foreign_data fd ON c.uuid = fd.uuid WHERE LOWER(fd.language) = 'japanese'; 
SELECT      CASE          WHEN COUNT(*) = 0 THEN 0         ELSE (COUNT(CASE WHEN fd.language = 'Chinese Simplified' THEN 1 ELSE NULL END) * 100.0 / COUNT(*))     END AS percentage FROM      foreign_data fd; 
SELECT DISTINCT sets.name, sets.totalSetSize FROM sets JOIN set_translations  ON sets.code = set_translations.setCode  WHERE set_translations.language = 'Italian'; 
SELECT COUNT(DISTINCT type)  FROM cards  WHERE artist = 'Aaron Boyd'; 
SELECT keywords  FROM cards  WHERE name = 'Angel of Mercy'; 
SELECT COUNT(*) FROM cards WHERE power = '*'; 
SELECT promoTypes  FROM cards  WHERE name = 'Duress'; 
SELECT borderColor  FROM cards  WHERE name = 'Ancestor''s Chosen'; 
SELECT originalType  FROM cards  WHERE name = 'Ancestor''s Chosen'; 
SELECT DISTINCT st.language  FROM cards c LEFT JOIN sets s ON c.setCode = s.code LEFT JOIN set_translations st ON s.code = st.setCode WHERE LOWER(c.name) = 'angel of mercy' AND st.language IS NOT NULL; 
SELECT COUNT(*)  FROM legalities  INNER JOIN cards ON cards.uuid = legalities.uuid WHERE legalities.status = 'restricted' AND cards.isTextless = 0; 
SELECT r.text  FROM rulings r WHERE r.uuid IN (SELECT uuid FROM cards WHERE LOWER(name) = LOWER('Condemn')); 
SELECT COUNT(*) FROM cards INNER JOIN legalities ON cards.uuid = legalities.uuid WHERE legalities.status = 'restricted'   AND cards.isStarter = 1; 
SELECT l.status  FROM cards c INNER JOIN legalities l ON l.uuid = c.uuid WHERE LOWER(TRIM(c.name)) = LOWER('Cloudchaser Eagle'); 
SELECT type  FROM cards  WHERE name = 'Benalish Knight'; 
SELECT l.format, l.status  FROM legalities l JOIN cards c ON l.uuid = c.uuid WHERE LOWER(c.name) = LOWER('Benalish Knight'); 
SELECT DISTINCT c.artist  FROM cards c  LEFT JOIN foreign_data fd ON c.uuid = fd.uuid  WHERE LOWER(fd.language) = 'phyrexian'    AND c.artist IS NOT NULL; 
SELECT (CAST(COUNT(id) FILTER (WHERE borderColor = 'borderless') AS FLOAT) / COUNT(id)) * 100 AS percentage_borderless_cards FROM cards; 
SELECT COUNT(c.uuid) AS reprinted_cards_count FROM cards c LEFT JOIN foreign_data fd ON c.uuid = fd.uuid AND fd.language = 'German' WHERE c.isReprint = 1; 
SELECT COUNT(*) FROM cards LEFT JOIN foreign_data ON cards.uuid = foreign_data.uuid WHERE cards.borderColor = 'borderless'   AND COALESCE(TRIM(foreign_data.language), '') = 'Russian'; 
WITH french_story_spotlight AS (     SELECT COUNT(c.id) AS french_count     FROM cards c     INNER JOIN foreign_data fd ON c.uuid = fd.uuid AND fd.language = 'French'     WHERE c.isStorySpotlight = 1 ), total_story_spotlight AS (     SELECT COUNT(id) AS total_count     FROM cards     WHERE isStorySpotlight = 1 ) SELECT      CASE          WHEN t.total_count = 0 THEN 0         ELSE (CAST(f.french_count AS FLOAT) / CAST(t.total_count AS FLOAT)) * 100     END AS percentage_of_french_story_spotlight_cards FROM      french_story_spotlight f CROSS JOIN      total_story_spotlight t; 
SELECT COUNT(*)  FROM cards  WHERE toughness = '99'; 
SELECT name  FROM cards  WHERE artist = 'Aaron Boyd'; 
SELECT COUNT(*)  FROM cards  WHERE borderColor = 'black' AND availability = 'mtgo'; 
SELECT id  FROM cards  WHERE convertedManaCost = 0; 
SELECT DISTINCT layout  FROM cards  WHERE keywords LIKE '%flying%'; 
SELECT COUNT(*)  FROM cards  WHERE originalType = 'Summon - Angel' AND (subtypes IS NULL OR subtypes != 'Angel'); 
SELECT id  FROM cards  WHERE cardKingdomFoilId IS NOT NULL    AND cardKingdomId IS NOT NULL; 
SELECT id  FROM cards  WHERE duelDeck = 'a'; 
SELECT edhrecRank  FROM cards  WHERE frameVersion = '2015'; 
SELECT DISTINCT c.artist FROM cards c INNER JOIN foreign_data fd  ON c.uuid = fd.uuid WHERE fd.language = 'Chinese Simplified'; 
SELECT c.name FROM cards c WHERE c.availability = 'paper'   AND NOT EXISTS (     SELECT 1     FROM foreign_data fd     WHERE fd.uuid = c.uuid       AND fd.language != 'Japanese'   )   AND EXISTS (     SELECT 1     FROM foreign_data fd     WHERE fd.uuid = c.uuid       AND fd.language = 'Japanese'   ); 
SELECT COUNT(DISTINCT c.uuid) AS banned_white_border_count FROM cards c JOIN legalities l   ON c.uuid = l.uuid AND l.status = 'Banned' WHERE c.borderColor = 'white'; 
SELECT l.uuid, f.language FROM legalities l LEFT JOIN foreign_data f ON l.uuid = f.uuid WHERE l.format = 'legacy'; 
SELECT rulings.text  FROM cards LEFT JOIN rulings ON cards.uuid = rulings.uuid WHERE cards.name = 'Beacon of Immortality'; 
SELECT l.status AS legality_status,         COUNT(DISTINCT CASE WHEN c.frameVersion = 'future' THEN c.uuid END) AS card_count FROM legalities l JOIN cards c ON c.uuid = l.uuid GROUP BY l.status; 
SELECT name, colors  FROM cards  WHERE setCode = 'OGW'; 
SELECT      c.name AS card_name,      fd.language,      fd.name AS translated_name FROM      cards c LEFT JOIN      foreign_data fd  ON      c.uuid = fd.uuid WHERE      c.setCode = '10E'      AND c.convertedManaCost = 5; 
SELECT c.name, r.date FROM cards c LEFT JOIN rulings r ON c.uuid = r.uuid WHERE c.originalType = 'Creature - Elf'; 
SELECT      cards.id,      COALESCE(cards.colors, 'No Color') AS colors,     COALESCE(GROUP_CONCAT(DISTINCT legalities.format), 'Unknown') AS formats FROM cards LEFT JOIN (     SELECT DISTINCT uuid, format      FROM legalities ) AS legalities ON cards.uuid = legalities.uuid WHERE cards.id BETWEEN 1 AND 20 GROUP BY cards.id, cards.colors; 
SELECT c.id, c.name, c.originalType, c.colors, fd.language  FROM cards c  JOIN foreign_data fd ON c.uuid = fd.uuid  WHERE c.originalType = 'Artifact'    AND ',' || c.colors || ',' LIKE '%,B,%'    AND fd.language IS NOT NULL    AND LOWER(fd.language) NOT LIKE '%english%'; 
SELECT c.name, r.date AS ruling_date FROM cards c LEFT JOIN rulings r ON c.uuid = r.uuid WHERE c.rarity = 'uncommon' ORDER BY      r.date IS NULL ASC,     r.date ASC LIMIT 3; 
SELECT COUNT(*) FROM cards WHERE artist = 'John Avon'    AND cardKingdomId IS NOT NULL    AND cardKingdomFoilId IS NOT NULL; 
SELECT COUNT(*)  FROM cards  WHERE borderColor = 'white'  AND cardKingdomFoilId IS NOT NULL  AND cardKingdomId IS NOT NULL; 
SELECT COUNT(*)  FROM cards  WHERE artist = 'UDON'    AND availability = 'mtgo'    AND hand = '-1'; 
SELECT COUNT(*)  FROM cards  WHERE frameVersion = '1993'    AND availability = 'paper'    AND hasContentWarning = 1; 
SELECT manaCost  FROM cards  WHERE layout = 'normal'    AND frameVersion = '2003'    AND borderColor = 'black'    AND availability = 'mtgo,paper'; 
SELECT SUM(CAST(manaCost AS REAL)) AS total_unconverted_mana_cost FROM cards WHERE artist = 'Rob Alexander'; 
SELECT DISTINCT subtypes, supertypes  FROM cards  WHERE availability = 'arena'; 
SELECT DISTINCT st.setCode FROM set_translations st WHERE st.language = 'Spanish'; 
SELECT (CAST(SUM(CASE WHEN isOnlineOnly = 1 THEN 1 ELSE 0 END) AS FLOAT) / COUNT(id)) * 100 AS percentage FROM cards WHERE frameEffects = 'legendary'; 
SELECT      (CAST(SUM(CASE WHEN isStorySpotlight = 1 AND isTextless = 0 THEN 1 ELSE 0 END) AS FLOAT) / COUNT(id)) * 100 AS percentage,      id  FROM      cards  WHERE      isStorySpotlight = 1 AND isTextless = 0  GROUP BY      id; 
WITH total_spanish_cards AS (     SELECT COUNT(*) AS total_count     FROM foreign_data     WHERE language = 'Spanish' ) SELECT      f.name,     (COUNT(f.id) * 100.0 / total_spanish_cards.total_count) AS percentage FROM      foreign_data f CROSS JOIN      total_spanish_cards WHERE      f.language = 'Spanish' GROUP BY      f.name; 
SELECT DISTINCT st.language FROM set_translations AS st JOIN sets AS s ON st.setCode = s.code WHERE s.baseSetSize = 309 AND st.language IS NOT NULL; 
SELECT COUNT(DISTINCT st.setCode) AS brazilian_portuguese_sets_count FROM sets s JOIN set_translations st ON s.code = st.setCode WHERE s.block = 'Commander' AND st.language = 'Portuguese (Brasil)'; 
SELECT DISTINCT c.id, c.name, l.status FROM cards c JOIN legalities l ON c.uuid = l.uuid WHERE LOWER(c.types) LIKE '%creature%'   AND l.status = 'Legal'; 
SELECT DISTINCT type FROM (     SELECT DISTINCT subtypes AS type     FROM cards     WHERE subtypes IS NOT NULL AND supertypes IS NOT NULL      UNION      SELECT DISTINCT supertypes AS type     FROM cards     WHERE subtypes IS NOT NULL AND supertypes IS NOT NULL ) combined_types; 
SELECT COUNT(*)  FROM cards  WHERE (power IS NULL OR power = '*' OR power = '')    AND LOWER(text) LIKE '%triggered ability%'; 
SELECT COUNT(*) FROM cards c INNER JOIN legalities l ON l.uuid = c.uuid WHERE c.side IS NULL   AND l.format = 'premodern'   AND c.text LIKE '%This is a triggered mana ability%'; 
SELECT c.id  FROM cards c  WHERE c.artist = 'Erica Yang'  AND c.availability = 'paper'; 
SELECT c.artist  FROM cards c  JOIN foreign_data fd ON c.uuid = fd.uuid  WHERE fd.text LIKE '%das perfekte gegenmittel zu einer dichten formation%'; 
SELECT fd.name AS foreign_name FROM cards c JOIN foreign_data fd ON c.uuid = fd.uuid WHERE fd.language = 'French'   AND c.type LIKE '%Creature%'   AND c.layout = 'normal'   AND c.borderColor = 'black'   AND c.artist = 'Matthew D. Wilson'; 
SELECT COUNT(*) FROM cards LEFT JOIN rulings ON cards.uuid = rulings.uuid WHERE cards.rarity = 'rare' AND rulings.date = '2007-02-01'; 
SELECT st.language, st.translation  FROM sets s INNER JOIN set_translations st ON s.code = st.setCode WHERE s.baseSetSize = 180; 
SELECT      (COUNT(CASE WHEN c.hasContentWarning = 0 THEN 1 ELSE NULL END) * 100.0 / COUNT(*)) AS percentage FROM cards c JOIN legalities l ON c.uuid = l.uuid WHERE l.format = 'commander' AND l.status = 'Legal'; 
SELECT      CASE          WHEN total_cards_without_power = 0 THEN 0         ELSE              (total_french_cards_without_power * 100.0 / total_cards_without_power)     END AS percentage FROM (     SELECT         COUNT(*) AS total_cards_without_power,         COUNT(CASE WHEN fd.language = 'French' THEN 1 END) AS total_french_cards_without_power     FROM          cards c     LEFT JOIN          foreign_data fd ON c.uuid = fd.uuid     WHERE          c.power IS NULL OR c.power = '*' ) AS counts; 
WITH Japanese_sets AS (     SELECT s.type     FROM set_translations st     LEFT JOIN sets s      ON st.setCode = s.code     WHERE st.language = 'Japanese' ) SELECT      CASE          WHEN COUNT(*) = 0 THEN 0         ELSE (SUM(CASE WHEN type = 'expansion' THEN 1 ELSE 0 END) * 100.0) / COUNT(*)     END AS percentage_of_expansion_sets FROM      Japanese_sets; 
SELECT availability  FROM cards  WHERE artist = 'Daren Bader'; 
SELECT COUNT(*)  FROM cards  WHERE borderColor = 'borderless'  AND edhrecRank > 12000  AND colors IS NOT NULL; 
SELECT COUNT(*)  FROM cards  WHERE isOversized = 1 AND isReprint = 1 AND isPromo = 1; 
SELECT name  FROM cards  WHERE (power IS NULL OR power = '*')    AND LOWER(COALESCE(promoTypes, '')) LIKE '%arenaleague%'  ORDER BY name ASC  LIMIT 3; 
SELECT language FROM foreign_data WHERE multiverseid = 149934; 
SELECT id  FROM cards  WHERE cardKingdomFoilId IS NOT NULL AND cardKingdomId IS NOT NULL  ORDER BY cardKingdomFoilId ASC  LIMIT 3; 
SELECT (CAST(COUNT(*) FILTER (WHERE isTextless = 1 AND layout = 'normal') AS FLOAT) / COUNT(*)) * 100 AS proportion_of_textless_normal_layout_cards FROM cards; 
SELECT number  FROM cards  WHERE side IS NULL AND subtypes LIKE '%Angel%' AND subtypes LIKE '%Wizard%'; 
SELECT name  FROM sets  WHERE (mtgoCode IS NULL OR mtgoCode = '')  ORDER BY name ASC  LIMIT 3; 
SELECT st.language  FROM set_translations AS st INNER JOIN sets AS s ON st.setCode = s.code WHERE s.mcmName = 'Archenemy' AND s.code = 'ARC'; 
SELECT sets.name, set_translations.translation  FROM sets  INNER JOIN set_translations ON sets.code = set_translations.setCode  WHERE sets.id = 5; 
SELECT st.language, s.type AS expansion_type FROM sets AS s JOIN set_translations AS st ON s.code = st.setCode WHERE s.id = 206; 
SELECT DISTINCT sets.id, sets.name FROM sets INNER JOIN cards     ON sets.code = cards.setCode INNER JOIN foreign_data     ON cards.uuid = foreign_data.uuid WHERE sets.block = 'Shadowmoor'   AND foreign_data.language = 'Italian' ORDER BY sets.name ASC LIMIT 2; 
SELECT s.id, s.name FROM sets s WHERE s.isForeignOnly = 1   AND s.isFoilOnly = 1; 
SELECT s.name AS set_name, s.baseSetSize AS max_baseSetSize FROM sets s LEFT JOIN set_translations st ON s.code = st.setCode AND st.language = 'Russian' ORDER BY s.baseSetSize DESC LIMIT 1; 
SELECT      COUNT(CASE WHEN c.isOnlineOnly = 1 THEN 1 END) * 100.0 / COUNT(*) AS percentage FROM cards c JOIN foreign_data fd ON c.uuid = fd.uuid WHERE fd.language = 'Chinese Simplified'; 
SELECT COUNT(*) FROM sets s WHERE (s.mtgoCode IS NULL OR s.mtgoCode = '')   AND s.code IN (     SELECT st.setCode     FROM set_translations st     GROUP BY st.setCode     HAVING SUM(CASE WHEN st.language = 'Japanese' THEN 1 ELSE 0 END) > 0        AND SUM(CASE WHEN st.language != 'Japanese' THEN 1 ELSE 0 END) = 0   ); 
SELECT id FROM cards WHERE borderColor = 'black'; 
SELECT id  FROM cards  WHERE frameEffects = 'extendedart'; 
SELECT name  FROM cards  WHERE borderColor = 'black' AND isFullArt = 1; 
SELECT st.language FROM set_translations st WHERE st.setCode IN (     SELECT code     FROM sets     WHERE id = 174 ); 
SELECT name FROM sets WHERE code = 'ALL'; 
WITH CardUUID AS (   SELECT uuid   FROM cards   WHERE TRIM(LOWER(name)) = TRIM(LOWER('A Pedra Fellwar')) ) SELECT fd.language FROM foreign_data fd JOIN CardUUID cu ON fd.uuid = cu.uuid; 
SELECT code  FROM sets  WHERE releaseDate = '2007-07-13'; 
SELECT baseSetSize, code  FROM sets  WHERE block IN ('Masques', 'Mirage'); 
SELECT code FROM sets WHERE type = 'expansion'; 
SELECT COALESCE(fd.name, 'No foreign name') AS foreign_name,         COALESCE(fd.type, 'No type information') AS card_type FROM cards c LEFT JOIN foreign_data fd ON c.uuid = fd.uuid WHERE c.watermark = 'boros' AND fd.uuid IS NOT NULL; 
SELECT DISTINCT fd.language, fd.flavorText, c.type FROM cards c LEFT JOIN foreign_data fd ON c.uuid = fd.uuid WHERE c.watermark = 'colorpie'; 
SELECT (     (CAST(COUNT(CASE WHEN c.convertedManaCost = 10 THEN 1 END) AS FLOAT) / COUNT(c.convertedManaCost)) * 100 ) AS percentage FROM cards c JOIN sets s ON c.setCode = s.code WHERE s.name = 'Abyssal Horror'; 
SELECT code  FROM sets  WHERE type = 'expansion' AND name LIKE '%commander%'; 
SELECT fd.name AS foreign_name, fd.type  FROM cards c LEFT JOIN foreign_data fd      ON c.uuid = fd.uuid WHERE c.watermark = 'abzan'; 
SELECT fd.language, c.type FROM cards c INNER JOIN foreign_data fd ON c.uuid = fd.uuid WHERE c.watermark = 'azorius'; 
SELECT COUNT(*)  FROM cards  WHERE artist = 'Aaron Miller'  AND cardKingdomFoilId IS NOT NULL  AND cardKingdomId IS NOT NULL; 
SELECT COUNT(*)  FROM cards  WHERE availability LIKE '%paper%' AND hand = '3'; 
SELECT name  FROM cards  WHERE isTextless = 0; 
SELECT convertedManaCost  FROM cards  WHERE name = 'Ancestor`s Chosen'; 
SELECT COUNT(*)  FROM cards  WHERE borderColor = 'white'    AND (power IS NULL OR power = '*'); 
SELECT name  FROM cards  WHERE isPromo = 1 AND side IS NOT NULL; 
SELECT subtypes, supertypes  FROM cards  WHERE name = 'Molimo, Maro-Sorcerer'; 
SELECT DISTINCT purchaseUrls  FROM cards  WHERE promoTypes = 'bundle'; 
SELECT COUNT(DISTINCT artist)  FROM cards  WHERE borderColor = 'black'  AND availability LIKE '%arena,mtgo%'; 
SELECT name, convertedManaCost  FROM cards  WHERE name IN ('Serra Angel', 'Shrine Keeper')  ORDER BY convertedManaCost DESC  LIMIT 1; 
SELECT artist  FROM cards  WHERE flavorName = 'Battra, Dark Destroyer'; 
SELECT name  FROM cards  WHERE frameVersion = '2003'  ORDER BY convertedManaCost DESC  LIMIT 3; 
SELECT st.translation  FROM set_translations st JOIN sets s ON st.setCode = s.code JOIN cards c ON c.setCode = s.code WHERE st.language = 'Italian'   AND c.name = 'Ancestor''s Chosen'; 
SELECT COUNT(*)  FROM set_translations  WHERE setCode IN (     SELECT DISTINCT c.setCode      FROM cards c      WHERE c.name = 'Angel of Mercy' ); 
SELECT DISTINCT c.name FROM cards c JOIN sets s      ON c.setCode = s.code JOIN set_translations st      ON s.code = st.setCode WHERE st.translation = 'Hauptset Zehnte Edition'   AND st.language = 'German'; 
SELECT c.name AS card_name,         fd.name AS translated_name,         fd.language,         fd.text FROM cards c LEFT JOIN foreign_data fd    ON c.uuid = fd.uuid WHERE c.name = 'Ancestor''s Chosen'   AND (fd.language = 'Korean' OR fd.language IS NULL); 
SELECT COUNT(*)  FROM cards  JOIN set_translations  ON cards.setCode = set_translations.setCode  WHERE cards.artist = 'Adam Rex'  AND set_translations.translation = 'Hauptset Zehnte Edition'; 
SELECT s.baseSetSize  FROM sets s JOIN set_translations st     ON s.code = st.setCode WHERE st.translation = 'Hauptset Zehnte Edition'; 
SELECT translation  FROM set_translations  WHERE setCode = (SELECT code FROM sets WHERE name = 'Eighth Edition') AND language = 'Chinese Simplified'; 
SELECT s.name  FROM cards c  JOIN sets s ON c.setCode = s.code  WHERE c.name = 'Angel of Mercy' AND s.mtgoCode IS NOT NULL; 
SELECT s.releaseDate  FROM sets s JOIN cards c ON s.code = c.setCode WHERE c.name = 'Ancestor''s Chosen'; 
SELECT s.type  FROM sets s JOIN set_translations st ON s.code = st.setCode WHERE st.translation = 'Hauptset Zehnte Edition'; 
SELECT COUNT(DISTINCT s.code) AS ItalianTranslatedSets FROM sets s LEFT JOIN set_translations st      ON s.code = st.setCode WHERE s.block = 'Ice Age'       AND st.language = 'Italian'       AND st.translation IS NOT NULL; 
SELECT s.name, s.isForeignOnly  FROM cards c  JOIN sets s ON c.setCode = s.code  WHERE c.name = 'Adarkar Valkyrie'; 
SELECT COUNT(DISTINCT s.code) AS set_count FROM sets s JOIN set_translations st ON s.code = st.setCode WHERE st.language = 'Italian'   AND s.baseSetSize < 100; 
SELECT COUNT(*)  FROM cards  WHERE setCode = (SELECT code FROM sets WHERE name = 'Coldsnap')  AND borderColor = 'black'; 
SELECT c.name FROM cards c JOIN sets s ON c.setCode = s.code WHERE s.name = 'Coldsnap'   AND c.convertedManaCost = (     SELECT MAX(c2.convertedManaCost)     FROM cards c2     JOIN sets s2 ON c2.setCode = s2.code     WHERE s2.name = 'Coldsnap'   ); 
SELECT DISTINCT artist  FROM cards  WHERE artist IN ('Jeremy Jarvis', 'Aaron Miller', 'Chippy')  AND setCode = (SELECT code FROM sets WHERE name = 'Coldsnap'); 
SELECT *  FROM cards  WHERE setCode = (SELECT code FROM sets WHERE name = 'Coldsnap')  AND number = '4'; 
SELECT COUNT(*)  FROM cards C JOIN sets S ON C.setCode = S.code WHERE S.name = 'Coldsnap'   AND C.convertedManaCost > 5   AND (TRIM(C.power) IS NULL OR TRIM(C.power) = '*'); 
SELECT fd.flavorText FROM foreign_data fd JOIN cards c ON fd.uuid = c.uuid WHERE fd.language = 'Italian' AND c.name = 'Ancestor''s Chosen'; 
SELECT DISTINCT f.language  FROM foreign_data f JOIN cards c    ON f.uuid = c.uuid WHERE c.name = 'Ancestor''s Chosen'    AND f.flavorText IS NOT NULL; 
SELECT f.type  FROM foreign_data f  JOIN cards c ON f.uuid = c.uuid  WHERE f.language = 'German' AND c.name = 'Ancestor''s Chosen'; 
SELECT foreign_data.text FROM foreign_data JOIN cards ON foreign_data.uuid = cards.uuid JOIN sets ON cards.setCode = sets.setCode WHERE sets.name = 'Coldsnap' AND foreign_data.language = 'Italian'; 
WITH MaxManaCost AS (   SELECT uuid, convertedManaCost   FROM cards   WHERE setCode = (SELECT code FROM sets WHERE name = 'Coldsnap' LIMIT 1)   ORDER BY convertedManaCost DESC   LIMIT 1 ) SELECT fd.name AS ItalianName, mmc.convertedManaCost FROM MaxManaCost mmc JOIN cards c ON mmc.uuid = c.uuid LEFT JOIN foreign_data fd ON c.uuid = fd.uuid WHERE fd.language = 'Italian'; 
SELECT r.date AS ruling_date FROM rulings r INNER JOIN cards c ON r.uuid = c.uuid WHERE c.name = 'Reminisce'; 
SELECT      (CAST(SUM(CASE WHEN c.convertedManaCost = 7 THEN 1 ELSE 0 END) AS FLOAT) / COUNT(c.id)) * 100 AS percentage FROM      cards c INNER JOIN      sets s ON c.setCode = s.code WHERE      s.name = 'Coldsnap'; 
SELECT      (CAST(SUM(CASE WHEN c.cardKingdomFoilId IS NOT NULL AND c.cardKingdomId IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) /      COUNT(c.id)) * 100 AS percentage_incredibly_powerful FROM      cards c JOIN      sets s ON c.setCode = s.code WHERE      s.name = 'Coldsnap'; 
SELECT code FROM sets WHERE releaseDate = '2017-07-14'; 
SELECT keyruneCode FROM sets WHERE code = 'PKHC'; 
SELECT mcmId  FROM sets  WHERE code = 'SS2'; 
SELECT mcmName  FROM sets  WHERE releaseDate = '2017-06-09'; 
SELECT type  FROM sets  WHERE name = 'From the Vault: Lore'; 
SELECT parentCode  FROM sets  WHERE name = 'Commander 2014 Oversized'; 
SELECT      c.name AS card_name,      COALESCE(r.text, 'No rulings available') AS ruling_text,      CASE          WHEN c.hasContentWarning = 1 THEN 'Yes'         ELSE 'No'     END AS has_missing_or_degraded_properties FROM cards c LEFT JOIN rulings r ON c.uuid = r.uuid WHERE c.artist = 'Jim Pavelec'   AND c.uuid IS NOT NULL; 
SELECT s.releaseDate  FROM sets s  JOIN cards c ON s.code = c.setCode  WHERE c.name = 'Evacuation'; 
SELECT s.baseSetSize  FROM sets s JOIN set_translations st ON s.code = st.setCode WHERE st.translation = 'Rinascita di Alara'; 
SELECT s.type  FROM sets s JOIN set_translations st ON s.code = st.setCode WHERE st.translation = 'Huitime dition'; 
SELECT st.translation FROM set_translations st JOIN sets s ON s.code = st.setCode WHERE st.language = 'French'   AND EXISTS (     SELECT 1     FROM cards c     JOIN foreign_data fd ON fd.uuid = c.uuid     WHERE fd.name = 'Tendo Ice Bridge'       AND c.setCode = s.code   ); 
SELECT COUNT(*)  FROM set_translations WHERE setCode IN (SELECT code FROM sets WHERE name = 'Tenth Edition')    AND translation IS NOT NULL; 
SELECT st.translation AS japanese_set_name FROM cards c JOIN sets s ON c.setCode = s.code JOIN set_translations st ON s.code = st.setCode WHERE c.name = 'Fellwar Stone' AND st.language = 'Japanese'; 
SELECT c.name  FROM cards c  JOIN sets s ON c.setCode = s.code  WHERE s.name = 'Journey into Nyx Hero''s Path'  ORDER BY c.convertedManaCost DESC  LIMIT 1; 
SELECT s.releaseDate  FROM sets s JOIN set_translations st ON s.code = st.setCode WHERE st.translation = 'Ola de fro'; 
SELECT s.type  FROM sets s JOIN cards c ON s.code = c.setCode WHERE c.name = 'Samite Pilgrim'; 
SELECT COUNT(*) FROM cards WHERE convertedManaCost = 3 AND setCode = (SELECT code FROM sets WHERE name = 'World Championship Decks 2004'); 
SELECT st.translation  FROM set_translations AS st JOIN sets AS s ON st.setCode = s.code WHERE s.name = 'Mirrodin' AND st.language = 'Chinese Simplified'; 
SELECT      (SUM(CASE WHEN c.hasFoil = 0 AND c.hasNonFoil = 1 THEN 1 ELSE 0 END) * 100.0 /      COUNT(CASE WHEN fd.language = 'Japanese' THEN fd.uuid ELSE NULL END)) AS percentage FROM      cards c JOIN      foreign_data fd ON c.uuid = fd.uuid WHERE      fd.language = 'Japanese'; 
SELECT      (SUM(CASE WHEN c.isOnlineOnly = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(CASE WHEN fd.language = 'Portuguese (Brazil)' THEN 1 ELSE NULL END)) AS percentage_online_only FROM foreign_data fd JOIN cards c ON fd.uuid = c.uuid WHERE fd.language = 'Portuguese (Brazil)'; 
SELECT DISTINCT availability  FROM cards  WHERE artist = 'Aleksi Briclot' AND isTextless = 1; 
SELECT id  FROM sets  WHERE baseSetSize = (SELECT MAX(baseSetSize) FROM sets); 
SELECT artist  FROM cards  WHERE side IS NULL  ORDER BY convertedManaCost DESC  LIMIT 1; 
SELECT frameEffects, COUNT(frameEffects) AS effect_count FROM cards WHERE cardKingdomFoilId IS NOT NULL AND cardKingdomId IS NOT NULL GROUP BY frameEffects ORDER BY effect_count DESC LIMIT 1; 
SELECT COUNT(*) FROM cards WHERE (power IS NULL OR TRIM(power) = '*')    AND hasFoil = 0    AND LOWER(duelDeck) = 'a'; 
SELECT id  FROM sets  WHERE type = 'commander'  ORDER BY totalSetSize DESC  LIMIT 1; 
SELECT c.name, c.manaCost FROM cards c JOIN legalities l ON c.uuid = l.uuid WHERE l.format = 'duel' ORDER BY LENGTH(     REPLACE(         REPLACE(             REPLACE(                 REPLACE(                     REPLACE(                         REPLACE(                             COALESCE(c.manaCost, ''), '{', ''                         ), '}', ''                     ), 'W', ''                 ), 'U', ''             ), 'B', ''         ), 'R', ''     ), 'G', '' ) DESC LIMIT 10; 
SELECT c.originalReleaseDate AS oldestReleaseDate, l.format FROM cards c JOIN legalities l ON c.uuid = l.uuid WHERE c.rarity = 'mythic'    AND c.originalReleaseDate IS NOT NULL   AND c.originalReleaseDate = (       SELECT MIN(originalReleaseDate)       FROM cards       WHERE rarity = 'mythic' AND originalReleaseDate IS NOT NULL   )   AND l.status = 'Legal'; 
SELECT COUNT(DISTINCT cards.id) AS card_count FROM cards INNER JOIN foreign_data      ON cards.uuid = foreign_data.uuid WHERE cards.artist = 'Volkan Baa'   AND foreign_data.language = 'French'; 
SELECT COUNT(*) FROM cards c WHERE c.rarity = 'rare'    AND c.types = 'Enchantment'    AND c.name = 'Abundance'   AND NOT EXISTS (       SELECT 1        FROM legalities l       WHERE l.uuid = c.uuid         AND l.status != 'Legal'   ); 
WITH format_banned_counts AS (     SELECT         format,         COUNT(*) AS banned_count     FROM legalities     WHERE status = 'Banned'     GROUP BY format ), max_banned_format AS (     SELECT         format     FROM format_banned_counts     WHERE banned_count = (SELECT MAX(banned_count) FROM format_banned_counts) ) SELECT     mbf.format,     GROUP_CONCAT(DISTINCT c.name) AS card_names FROM max_banned_format mbf JOIN legalities l ON l.format = mbf.format AND l.status = 'Banned' JOIN cards c ON l.uuid = c.uuid GROUP BY mbf.format; 
SELECT st.language  FROM sets s INNER JOIN set_translations st ON s.code = st.setCode WHERE s.name = 'Battlebond'; 
WITH artist_card_counts AS (     SELECT artist, COUNT(id) AS card_count     FROM cards     WHERE artist IS NOT NULL     GROUP BY artist ), least_artist AS (     SELECT artist     FROM artist_card_counts     WHERE card_count = (SELECT MIN(card_count) FROM artist_card_counts) ), cards_by_least_artist AS (     SELECT c.uuid     FROM cards c     JOIN least_artist la ON c.artist = la.artist ) SELECT DISTINCT l.format FROM legalities l JOIN cards_by_least_artist cba ON l.uuid = cba.uuid; 
SELECT l.status  FROM cards c LEFT JOIN legalities l    ON c.uuid = l.uuid WHERE c.frameVersion = '1997'    AND c.artist = 'D. Alexander Gregory'    AND c.hasContentWarning = 1   AND l.format = 'legacy'; 
SELECT c.name, l.format FROM cards c LEFT JOIN legalities l      ON c.uuid = l.uuid WHERE c.edhrecRank = 1 AND l.status = 'Banned'; 
WITH annual_set_data AS (     SELECT          strftime('%Y', s.releaseDate) AS release_year,         s.id AS set_id,         st.language AS language     FROM sets s     LEFT JOIN set_translations st ON s.code = st.setCode     WHERE s.releaseDate BETWEEN '2012-01-01' AND '2015-12-31' ), language_stats AS (     SELECT          release_year,         language,         COUNT(language) AS language_count     FROM annual_set_data     GROUP BY release_year, language ), ranked_languages AS (     SELECT          release_year,         language,         language_count,         DENSE_RANK() OVER (PARTITION BY release_year ORDER BY language_count DESC) AS rank     FROM language_stats ), common_language_per_year AS (     SELECT          release_year,         GROUP_CONCAT(language) AS common_language     FROM ranked_languages     WHERE rank = 1     GROUP BY release_year ), annual_set_count AS (     SELECT          release_year,         COUNT(DISTINCT set_id) AS num_sets     FROM annual_set_data     GROUP BY release_year ) SELECT      AVG(num_sets) AS average_sets,      GROUP_CONCAT(DISTINCT common_language) AS common_languages FROM annual_set_count LEFT JOIN common_language_per_year ON annual_set_count.release_year = common_language_per_year.release_year; 
SELECT DISTINCT artist  FROM cards  WHERE borderColor = 'black' AND availability = 'arena'; 
SELECT l.uuid FROM legalities l JOIN cards c ON l.uuid = c.uuid WHERE l.format = 'oldschool' AND l.status IN ('banned', 'restricted'); 
SELECT COUNT(*)  FROM cards  WHERE artist = 'Matthew D. Wilson' AND availability = 'paper'; 
SELECT r.text FROM rulings AS r JOIN cards AS c ON r.uuid = c.uuid WHERE c.artist = 'Kev Walker' ORDER BY r.date DESC; 
SELECT c.name, l.format FROM cards c JOIN sets s ON c.setCode = s.code LEFT JOIN legalities l ON c.uuid = l.uuid WHERE s.name = 'Hour of Devastation' AND l.status = 'Legal'; 
SELECT s.name FROM sets s LEFT JOIN set_translations st_korean      ON s.code = st_korean.setCode AND st_korean.language = 'Korean' LEFT JOIN set_translations st_japanese     ON s.code = st_japanese.setCode AND st_japanese.language = 'Japanese' WHERE st_korean.setCode IS NOT NULL   AND st_japanese.setCode IS NULL; 
SELECT      c.frameVersion,      c.name,      CASE          WHEN EXISTS (             SELECT 1              FROM legalities l              WHERE l.uuid = c.uuid AND l.status = 'Banned'         ) THEN 'Banned'         ELSE 'Not Banned'     END AS status FROM cards c WHERE c.artist = 'Allen Williams'; 
SELECT DisplayName, Reputation  FROM users  WHERE DisplayName IN ('Harlan', 'Jarrod Dixon')  ORDER BY Reputation DESC  LIMIT 1; 
SELECT DisplayName  FROM users  WHERE CreationDate LIKE '2011%'; 
SELECT COUNT(*)  FROM users  WHERE LastAccessDate > '2014-09-01'; 
SELECT DisplayName  FROM users  ORDER BY Views DESC  LIMIT 1; 
SELECT COUNT(*) AS UserCount FROM users WHERE UpVotes > 100 AND DownVotes > 1; 
SELECT COUNT(*) AS UserCount FROM users WHERE Views > 10 AND CreationDate > '2013-12-31'; 
SELECT COUNT(*) AS PostCount FROM posts WHERE OwnerUserId = (SELECT Id FROM users WHERE DisplayName = 'csgillespie'); 
SELECT p.Title FROM posts p JOIN users u ON p.OwnerUserId = u.Id WHERE u.DisplayName = 'csgillespie'; 
SELECT u.DisplayName  FROM posts p JOIN users u ON p.OwnerUserId = u.Id WHERE p.Title = 'Eliciting priors from experts'; 
SELECT p.Title  FROM posts p JOIN users u ON p.OwnerUserId = u.Id WHERE u.DisplayName = 'csgillespie' ORDER BY p.ViewCount DESC LIMIT 1; 
SELECT u.DisplayName FROM posts p JOIN users u ON p.OwnerUserId = u.Id WHERE p.FavoriteCount = (SELECT MAX(FavoriteCount) FROM posts); 
SELECT SUM(p.CommentCount) AS TotalComments FROM posts p JOIN users u ON p.OwnerUserId = u.Id WHERE u.DisplayName = 'csgillespie'; 
SELECT p.AnswerCount  FROM posts p  JOIN users u ON p.OwnerUserId = u.Id  WHERE u.DisplayName = 'csgillespie'  ORDER BY p.AnswerCount DESC  LIMIT 1; 
SELECT p.LastEditorDisplayName  FROM posts p  WHERE LOWER(p.Title) = LOWER('Examples for teaching: Correlation does not mean causation'); 
SELECT COUNT(*) AS RootPostCount FROM posts WHERE OwnerUserId = (SELECT Id FROM users WHERE DisplayName = 'csgillespie') AND ParentId IS NULL; 
SELECT DISTINCT u.DisplayName FROM users u JOIN posts p ON u.Id = p.OwnerUserId WHERE p.ClosedDate IS NOT NULL; 
SELECT COUNT(*) FROM posts p JOIN users u ON p.OwnerUserId = u.Id WHERE u.Age > 65 AND p.Score >= 20; 
SELECT u.Location  FROM posts p JOIN users u ON p.OwnerUserId = u.Id WHERE p.Title = 'Eliciting priors from experts'; 
SELECT Body  FROM posts  WHERE Id = (SELECT ExcerptPostId FROM tags WHERE TagName = 'bayesian'); 
SELECT p.Body FROM tags t JOIN posts p ON t.ExcerptPostId = p.Id WHERE t.Count = (SELECT MAX(Count) FROM tags WHERE ExcerptPostId IS NOT NULL); 
SELECT COUNT(*) AS BadgeCount FROM badges WHERE UserId = (SELECT Id FROM users WHERE DisplayName = 'csgillespie'); 
SELECT b.Name FROM badges b JOIN users u ON b.UserId = u.Id WHERE u.DisplayName = 'csgillespie'; 
SELECT COUNT(b.Id) AS BadgeCount FROM badges b JOIN users u ON b.UserId = u.Id WHERE u.DisplayName = 'csgillespie' AND strftime('%Y', b.Date) = '2011'; 
SELECT u.DisplayName FROM users u JOIN (     SELECT UserId, COUNT(Id) AS BadgeCount     FROM badges     GROUP BY UserId     ORDER BY BadgeCount DESC     LIMIT 1 ) max_badge_user ON u.Id = max_badge_user.UserId; 
SELECT AVG(p.Score) AS AverageScore FROM posts p JOIN users u ON p.OwnerUserId = u.Id WHERE u.DisplayName = 'csgillespie'; 
SELECT CAST(COUNT(b.Id) AS FLOAT) / COUNT(DISTINCT u.DisplayName) AS AverageBadges FROM users u JOIN badges b ON u.Id = b.UserId WHERE u.Views > 200; 
SELECT      (CAST(COUNT(p.Id) FILTER (WHERE u.Age > 65) AS FLOAT) / COUNT(p.Id)) * 100 AS Percentage FROM      posts p JOIN      users u ON p.OwnerUserId = u.Id WHERE      p.Score > 5; 
SELECT COUNT(*) AS VoteCount  FROM votes  WHERE UserId = 58 AND CreationDate = '2010-07-19'; 
SELECT CreationDate  FROM votes  GROUP BY CreationDate  ORDER BY COUNT(Id) DESC  LIMIT 1; 
SELECT COUNT(Id) AS RevivalBadgeCount FROM badges WHERE Name = 'Revival'; 
SELECT p.Title  FROM posts p JOIN comments c ON p.Id = c.PostId WHERE c.Score = (SELECT MAX(Score) FROM comments); 
SELECT CommentCount  FROM posts  WHERE ViewCount = 1910; 
SELECT p.FavoriteCount FROM comments c JOIN posts p ON c.PostId = p.Id WHERE c.UserId = 3025 AND c.CreationDate = '2014-04-23 20:29:39.0'; 
SELECT c.Text  FROM comments c JOIN posts p ON c.PostId = p.Id WHERE p.ParentId = 107829 AND p.CommentCount = 1; 
SELECT p.Id,         CASE             WHEN p.ClosedDate IS NULL THEN 'Not Well-Finished'            ELSE 'Well-Finished'        END AS PostStatus FROM posts p JOIN comments c ON p.Id = c.PostId WHERE c.UserId = 23853 AND c.CreationDate = '2013-07-12 09:08:18.0'; 
SELECT u.Reputation  FROM posts p JOIN users u ON p.OwnerUserId = u.Id WHERE p.Id = 65041; 
SELECT COUNT(*) AS PostCount FROM posts p JOIN users u ON p.OwnerUserId = u.Id WHERE u.DisplayName = 'Tiago Pasqualini'; 
SELECT u.DisplayName  FROM votes v  JOIN users u ON v.UserId = u.Id  WHERE v.Id = 6347; 
SELECT COUNT(*) AS VoteCount FROM votes WHERE PostId IN (     SELECT Id     FROM posts     WHERE Title LIKE '%data visualization%' ); 
SELECT b.Name FROM badges b JOIN users u ON b.UserId = u.Id WHERE u.DisplayName = 'DatEpicCoderGuyWhoPrograms'; 
SELECT      (CAST(COUNT(posts.Id) AS FLOAT) / NULLIF(COUNT(votes.Id), 0)) AS Times FROM      posts LEFT JOIN      votes ON posts.Id = votes.PostId WHERE      posts.OwnerUserId = 24; 
SELECT ViewCount  FROM posts  WHERE Title = 'Integration of Weka and/or RapidMiner into Informatica PowerCenter/Developer'; 
SELECT Text FROM comments WHERE Score = 17; 
SELECT DisplayName  FROM users  WHERE WebsiteUrl = 'http://stackoverflow.com'; 
SELECT b.Name  FROM badges b JOIN users u ON b.UserId = u.Id WHERE u.DisplayName = 'SilentGhost'; 
SELECT u.DisplayName  FROM comments c  JOIN users u ON c.UserId = u.Id  WHERE c.Text = 'thank you user93!'; 
SELECT c.Text  FROM comments c JOIN users u ON c.UserId = u.Id WHERE u.DisplayName = 'A Lion'; 
SELECT u.DisplayName, u.Reputation FROM users u JOIN posts p ON u.Id = p.OwnerUserId WHERE p.Title = 'Understanding what Dassault iSight is doing?'; 
SELECT c.Text  FROM comments c JOIN posts p ON c.PostId = p.Id WHERE p.Title = 'How does gentle boosting differ from AdaBoost?'; 
SELECT u.DisplayName  FROM users u JOIN badges b ON u.Id = b.UserId WHERE b.Name = 'Necromancer' LIMIT 10; 
SELECT u.DisplayName FROM posts p JOIN users u ON p.LastEditorUserId = u.Id WHERE p.Title = 'Open source tools for visualizing multi-dimensional data'; 
SELECT Title FROM posts JOIN users ON posts.LastEditorUserId = users.Id WHERE users.DisplayName = 'Vebjorn Ljosa'; 
SELECT u.WebsiteUrl, SUM(p.Score) AS TotalScore FROM posts p JOIN users u ON p.LastEditorUserId = u.Id WHERE u.DisplayName = 'Yevgeny' GROUP BY u.WebsiteUrl; 
SELECT c.* FROM comments c JOIN posts p ON c.PostId = p.Id JOIN postHistory ph ON ph.PostId = p.Id WHERE p.Title = 'Why square the difference instead of taking the absolute value in standard deviation?'   AND ph.UserId = c.UserId; 
SELECT SUM(BountyAmount) AS TotalBountyAmount FROM votes WHERE PostId IN (     SELECT Id     FROM posts     WHERE Title LIKE '%data%' ); 
SELECT u.DisplayName FROM votes v JOIN posts p ON v.PostId = p.Id JOIN users u ON v.UserId = u.Id WHERE v.BountyAmount = 50 AND p.Title LIKE '%variance%'; 
WITH AverageViewCount AS (     SELECT AVG(ViewCount) AS AvgViewCount     FROM posts     WHERE Tags LIKE '%<humor>%' ) SELECT      posts.Title,      comments.Text,      AverageViewCount.AvgViewCount FROM      posts LEFT JOIN      comments ON comments.PostId = posts.Id CROSS JOIN      AverageViewCount WHERE      posts.Tags LIKE '%<humor>%'; 
SELECT COUNT(*) AS TotalComments FROM comments WHERE UserId = 13; 
SELECT Id  FROM users  ORDER BY Reputation DESC  LIMIT 1; 
SELECT Id  FROM users  ORDER BY Views  LIMIT 1; 
SELECT COUNT(DISTINCT UserId) AS TotalUsers FROM badges WHERE Name = 'Supporter'   AND Date >= '2011-01-01'   AND Date < '2012-01-01'; 
SELECT COUNT(DISTINCT UserId) AS UserCount FROM badges GROUP BY UserId HAVING COUNT(Name) > 5; 
SELECT COUNT(DISTINCT u.Id) AS UserCount FROM users u JOIN badges b1 ON u.Id = b1.UserId AND b1.Name = 'Teacher' JOIN badges b2 ON u.Id = b2.UserId AND b2.Name = 'Supporter' WHERE u.Location = 'New York'; 
SELECT u.DisplayName, u.Reputation FROM posts p JOIN users u ON p.OwnerUserId = u.Id WHERE p.Id = 1; 
SELECT u.Id, u.DisplayName FROM users u JOIN posts p ON u.Id = p.OwnerUserId JOIN (     SELECT UserId, PostId, COUNT(*) AS HistoryCount     FROM postHistory     GROUP BY UserId, PostId     HAVING COUNT(*) = 1 ) ph ON u.Id = ph.UserId AND p.Id = ph.PostId WHERE p.ViewCount >= 1000; 
WITH UserCommentCounts AS (     SELECT          u.Id AS UserId,         u.DisplayName,         COUNT(c.Id) AS CommentCount     FROM users u     JOIN comments c ON u.Id = c.UserId     GROUP BY u.Id, u.DisplayName ), TopCommenters AS (     SELECT          ucc.UserId,         ucc.DisplayName,         ucc.CommentCount     FROM UserCommentCounts ucc     WHERE ucc.CommentCount = (         SELECT MAX(CommentCount) FROM UserCommentCounts     ) ) SELECT      tc.DisplayName,     b.Name AS BadgeName,     tc.CommentCount FROM TopCommenters tc LEFT JOIN badges b ON tc.UserId = b.UserId; 
SELECT COUNT(DISTINCT u.Id) AS UserCount FROM users u JOIN badges b ON u.Id = b.UserId WHERE u.Location = 'India' AND b.Name = 'Teacher'; 
WITH TotalStudentBadges AS (     SELECT COUNT(*) AS TotalCount     FROM badges     WHERE Name = 'Student' ), YearlyCounts AS (     SELECT          strftime('%Y', Date) AS BadgeYear,         COUNT(*) AS YearlyCount     FROM badges     WHERE Name = 'Student'     GROUP BY strftime('%Y', Date) ) SELECT      CASE          WHEN (SELECT TotalCount FROM TotalStudentBadges) = 0 THEN NULL         ELSE (             COALESCE((SELECT YearlyCount                        FROM YearlyCounts                        WHERE BadgeYear = '2010'), 0) * 100.0 / (SELECT TotalCount FROM TotalStudentBadges)             -             COALESCE((SELECT YearlyCount                        FROM YearlyCounts                        WHERE BadgeYear = '2011'), 0) * 100.0 / (SELECT TotalCount FROM TotalStudentBadges)         )     END AS PercentageDifference FROM TotalStudentBadges LIMIT 1; 
SELECT ph.PostHistoryTypeId, COUNT(DISTINCT c.UserId) AS UniqueCommenters FROM postHistory ph LEFT JOIN comments c ON c.PostId = ph.PostId WHERE ph.PostId = 3720 GROUP BY ph.PostHistoryTypeId; 
SELECT p.*, p.ViewCount AS Popularity FROM posts p JOIN postLinks pl ON p.Id = pl.PostId WHERE pl.RelatedPostId = 61217; 
SELECT p.Score, pl.LinkTypeId FROM posts p JOIN postLinks pl ON p.Id = pl.PostId WHERE p.Id = 395; 
SELECT Id AS PostId, OwnerUserId AS UserId FROM posts WHERE Score > 60; 
SELECT SUM(FavoriteCount) AS TotalFavoriteCount FROM posts WHERE OwnerUserId = 686 AND strftime('%Y', CreationDate) = '2011'; 
SELECT      AVG(u.UpVotes) AS AverageUpVotes,     AVG(u.Age) AS AverageUserAge FROM      users u WHERE      u.Id IN (         SELECT              p.OwnerUserId         FROM              posts p         GROUP BY              p.OwnerUserId         HAVING              COUNT(p.OwnerUserId) > 10     ); 
SELECT COUNT(DISTINCT UserId) AS UserCount FROM badges WHERE Name = 'Announcer'; 
SELECT Name  FROM badges  WHERE Date = '2010-07-19 19:39:08.0'; 
SELECT COUNT(*) AS PositiveCommentsCount FROM comments WHERE Score > 60; 
SELECT Text  FROM comments  WHERE CreationDate = '2010-07-19 19:25:47.0'; 
SELECT COUNT(Id) AS PostCount FROM posts WHERE Score = 10; 
SELECT b.Name  FROM badges b  JOIN users u ON b.UserId = u.Id  WHERE u.Reputation = (SELECT MAX(Reputation) FROM users); 
SELECT u.Reputation FROM users u JOIN badges b ON u.Id = b.UserId WHERE b.Date = '2010-07-19 19:39:08.0'; 
SELECT b.Name  FROM badges b JOIN users u ON b.UserId = u.Id WHERE u.DisplayName = 'Pierre'; 
SELECT b.Date  FROM badges b  JOIN users u ON b.UserId = u.Id  WHERE u.Location = 'Rochester, NY'; 
SELECT      (CAST(COUNT(DISTINCT CASE WHEN Name = 'Teacher' THEN UserId END) AS FLOAT) / COUNT(DISTINCT UserId)) * 100 AS Percentage FROM      badges; 
SELECT      (CAST(COUNT(DISTINCT u.Id) FILTER (WHERE u.Age BETWEEN 13 AND 18) AS FLOAT) / COUNT(DISTINCT u.Id)) * 100 AS TeenagerPercentage FROM      badges b JOIN      users u ON b.UserId = u.Id WHERE      b.Name = 'Organizer'; 
SELECT c.Score  FROM comments c JOIN posts p ON c.PostId = p.Id WHERE p.CreaionDate = '2010-07-19 19:19:56.0'; 
SELECT c.Text  FROM comments c JOIN posts p ON c.PostId = p.Id WHERE p.CreaionDate = '2010-07-19 19:37:33.0'; 
SELECT u.Age  FROM users u  JOIN badges b ON u.Id = b.UserId  WHERE u.Location = 'Vienna, Austria'; 
SELECT COUNT(DISTINCT b.UserId) AS AdultSupporterCount FROM badges b JOIN users u ON b.UserId = u.Id WHERE b.Name = 'Supporter' AND u.Age BETWEEN 19 AND 65; 
SELECT SUM(u.Views) AS TotalViews FROM badges b JOIN users u ON b.UserId = u.Id WHERE b.Date = '2010-07-19 19:39:08.0'; 
SELECT DISTINCT b.Name FROM badges b JOIN users u ON b.UserId = u.Id WHERE u.Reputation = (SELECT MIN(Reputation) FROM users); 
SELECT b.Name  FROM badges b JOIN users u ON b.UserId = u.Id WHERE u.DisplayName = 'Sharpie'; 
SELECT COUNT(*) AS ElderSupporterCount FROM badges b JOIN users u ON b.UserId = u.Id WHERE b.Name = 'Supporter' AND u.Age > 65; 
SELECT DisplayName FROM users WHERE Id = 30; 
SELECT COUNT(*) AS UserCount  FROM users  WHERE Location = 'New York'; 
SELECT COUNT(*) AS TotalVotes FROM votes WHERE CreationDate LIKE '2010%'; 
SELECT COUNT(*) AS AdultUserCount FROM users WHERE Age BETWEEN 19 AND 65; 
SELECT DisplayName, Views  FROM users  WHERE Views = (SELECT MAX(Views) FROM users); 
SELECT      CASE          WHEN Votes2011 = 0 THEN NULL         ELSE CAST(Votes2010 AS FLOAT) / Votes2011     END AS Ratio FROM (     SELECT          SUM(CASE WHEN strftime('%Y', CreationDate) = '2010' THEN 1 ELSE 0 END) AS Votes2010,         SUM(CASE WHEN strftime('%Y', CreationDate) = '2011' THEN 1 ELSE 0 END) AS Votes2011     FROM votes ); 
SELECT DISTINCT t.TagName FROM tags t JOIN posts p ON t.ExcerptPostId = p.Id OR t.WikiPostId = p.Id JOIN users u ON p.OwnerUserId = u.Id WHERE u.DisplayName = 'John Salvatier'; 
SELECT COUNT(*) AS PostCount FROM posts WHERE OwnerUserId = (SELECT Id FROM users WHERE DisplayName = 'Daniel Vassallo'); 
SELECT COUNT(*) AS VoteCount FROM votes v JOIN users u ON v.UserId = u.Id WHERE u.DisplayName = 'Harlan'; 
SELECT Id  FROM posts  WHERE OwnerUserId = (SELECT Id FROM users WHERE DisplayName = 'slashnick')  ORDER BY AnswerCount DESC  LIMIT 1; 
SELECT u.DisplayName, SUM(p.ViewCount) AS TotalViewCount FROM posts p JOIN users u ON p.OwnerUserId = u.Id WHERE u.DisplayName IN ('Harvey Motulsky', 'Noah Snyder') GROUP BY u.DisplayName ORDER BY TotalViewCount DESC LIMIT 1; 
SELECT COUNT(*) AS PostCount FROM posts p JOIN users u ON p.OwnerUserId = u.Id WHERE u.DisplayName = 'Matt Parker' AND p.Id > 4; 
SELECT COUNT(c.Id) AS NegativeCommentsCount FROM comments c JOIN posts p ON c.PostId = p.Id JOIN users u ON p.OwnerUserId = u.Id WHERE u.DisplayName = 'Neil McGuigan' AND c.Score < 60; 
SELECT DISTINCT t.TagName FROM posts p JOIN tags t ON p.Tags LIKE '%' || t.TagName || '%' JOIN users u ON p.OwnerUserId = u.Id WHERE u.DisplayName = 'Mark Meckes' AND p.CommentCount = 0; 
SELECT u.DisplayName FROM users u JOIN badges b ON u.Id = b.UserId WHERE b.Name = 'Organizer'; 
SELECT      (COUNT(p.Id) * 100.0) / (SELECT COUNT(Id) FROM posts WHERE OwnerDisplayName = 'Community') AS percentage FROM posts p JOIN tags t ON p.Tags LIKE '%' || t.TagName || '%' WHERE t.TagName = 'r' AND p.OwnerDisplayName = 'Community'; 
SELECT      (SELECT COALESCE(SUM(ViewCount), 0)       FROM posts       WHERE OwnerDisplayName = 'Mornington')      -      (SELECT COALESCE(SUM(ViewCount), 0)       FROM posts       WHERE OwnerDisplayName = 'Amos')      AS ViewCountDifference; 
SELECT COUNT(DISTINCT UserId) AS UserCount FROM badges WHERE Name = 'Commentator' AND strftime('%Y', Date) = '2014'; 
SELECT COUNT(*)  FROM posts  WHERE CreaionDate BETWEEN '2010-07-21 00:00:00' AND '2010-07-21 23:59:59'; 
SELECT DisplayName, Age  FROM users  WHERE Views = (SELECT MAX(Views) FROM users); 
SELECT LastEditDate, LastEditorUserId  FROM posts  WHERE Title = 'Detecting a given face in a database of facial images'; 
SELECT COUNT(*)  FROM comments  WHERE UserId = 13 AND Score < 60; 
SELECT DISTINCT p.Title AS PostTitle, u.DisplayName AS UserDisplayName FROM comments c JOIN posts p ON c.PostId = p.Id JOIN users u ON c.UserId = u.Id WHERE c.Score > 60; 
SELECT b.Name  FROM badges b JOIN users u ON b.UserId = u.Id WHERE u.Location = 'North Pole'    AND CAST(strftime('%Y', b.Date) AS INTEGER) = 2011; 
SELECT u.DisplayName, u.WebsiteUrl FROM posts p JOIN users u ON p.OwnerUserId = u.Id WHERE p.FavoriteCount > 150; 
SELECT      COUNT(ph.Id) AS PostHistoryCount,      MAX(ph.CreationDate) AS LastEditDate FROM      postHistory ph JOIN      posts p ON ph.PostId = p.Id WHERE      p.Title = 'What is the best introductory Bayesian statistics textbook?'; 
SELECT u.LastAccessDate, u.Location FROM users u JOIN badges b ON u.Id = b.UserId WHERE b.Name = 'Outliers'; 
SELECT p2.Title  FROM posts p1 JOIN postLinks pl ON p1.Id = pl.PostId JOIN posts p2 ON pl.RelatedPostId = p2.Id WHERE p1.Title = 'How to tell if something happened in a data set which monitors a value over time'; 
SELECT p.Id AS PostId, b.Name AS BadgeName FROM posts p JOIN users u ON p.OwnerUserId = u.Id JOIN badges b ON u.Id = b.UserId WHERE u.DisplayName = 'Samuel'    AND strftime('%Y', b.Date) = '2013'   AND strftime('%Y', p.CreaionDate) = '2013'; 
SELECT p.OwnerDisplayName  FROM posts p  WHERE p.ViewCount = (SELECT MAX(ViewCount) FROM posts); 
SELECT u.DisplayName, u.Location FROM users u JOIN posts p ON u.Id = p.OwnerUserId JOIN tags t ON p.Id = t.ExcerptPostId WHERE t.TagName = 'hypothesis-testing'; 
SELECT p.Title AS RelatedPostTitle, pl.LinkTypeId FROM posts AS p JOIN postLinks AS pl ON p.Id = pl.RelatedPostId WHERE pl.PostId = (SELECT Id FROM posts WHERE Title = 'What are principal component scores?'); 
SELECT u.DisplayName FROM posts child JOIN posts parent ON child.ParentId = parent.Id JOIN users u ON parent.OwnerUserId = u.Id WHERE child.Score = (SELECT MAX(Score) FROM posts WHERE ParentId IS NOT NULL); 
SELECT u.DisplayName, u.WebsiteUrl FROM votes v JOIN users u ON v.UserId = u.Id WHERE v.VoteTypeId = 8 ORDER BY v.BountyAmount DESC LIMIT 1; 
SELECT Title FROM posts ORDER BY ViewCount DESC LIMIT 5; 
SELECT COUNT(*) AS TagCount FROM tags WHERE "Count" BETWEEN 5000 AND 7000; 
SELECT OwnerUserId  FROM posts  WHERE FavoriteCount = (SELECT MAX(FavoriteCount) FROM posts); 
SELECT Age  FROM users  WHERE Reputation = (SELECT MAX(Reputation) FROM users); 
SELECT COUNT(DISTINCT p.Id) AS PostCount FROM posts p JOIN votes v ON p.Id = v.PostId WHERE v.CreationDate LIKE '2011%' AND v.BountyAmount = 50; 
SELECT Id  FROM users  WHERE Age = (SELECT MIN(Age) FROM users); 
SELECT SUM(Score) AS TotalScore FROM posts WHERE LasActivityDate LIKE '2010-07-19%'; 
SELECT COUNT(pl.Id) * 1.0 / COUNT(DISTINCT strftime('%Y-%m', pl.CreationDate)) AS AverageMonthlyLinks FROM postLinks pl JOIN posts p1 ON pl.PostId = p1.Id WHERE strftime('%Y', pl.CreationDate) = '2010'   AND p1.AnswerCount <= 2   AND p1.AnswerCount IS NOT NULL; 
SELECT p.Id  FROM posts p JOIN votes v ON p.Id = v.PostId WHERE v.UserId = 1465 ORDER BY p.FavoriteCount DESC LIMIT 1; 
SELECT p.Title FROM posts p JOIN postLinks pl ON p.Id = pl.PostId WHERE pl.CreationDate = (SELECT MIN(CreationDate) FROM postLinks); 
SELECT u.DisplayName FROM users u WHERE u.Id = (     SELECT b.UserId     FROM badges b     GROUP BY b.UserId     ORDER BY COUNT(b.Name) DESC     LIMIT 1 ); 
SELECT MIN(v.CreationDate) AS FirstVoteDate FROM votes v JOIN users u ON v.UserId = u.Id WHERE u.DisplayName = 'chl'; 
SELECT MIN(p.CreaionDate) AS FirstPostDate FROM users u JOIN posts p ON u.Id = p.OwnerUserId WHERE u.Age = (SELECT MIN(Age) FROM users WHERE Age IS NOT NULL); 
SELECT      CASE          WHEN EXISTS (             SELECT 1              FROM badges              WHERE Name = 'Autobiographer'         ) THEN (             SELECT u.DisplayName             FROM badges b             JOIN users u ON b.UserId = u.Id             WHERE b.Name = 'Autobiographer'             ORDER BY b.Date ASC             LIMIT 1         )         ELSE 'No Autobiographer Badge Found'     END AS DisplayName; 
SELECT COUNT(DISTINCT u.Id) AS UserCount FROM users u JOIN posts p ON u.Id = p.OwnerUserId WHERE u.Location = 'United Kingdom' GROUP BY u.Id HAVING SUM(p.FavoriteCount) >= 4; 
SELECT AVG(PostVoteCount) AS AveragePostsVoted FROM (     SELECT v.UserId, COUNT(DISTINCT v.PostId) AS PostVoteCount     FROM votes v     JOIN users u ON v.UserId = u.Id     WHERE u.Age = (SELECT MAX(Age) FROM users)     GROUP BY v.UserId ) SubQuery; 
SELECT DisplayName  FROM users  WHERE Reputation = (SELECT MAX(Reputation) FROM users); 
SELECT COUNT(*) AS UserCount  FROM users  WHERE Reputation > 2000 AND Views > 1000; 
SELECT DisplayName FROM users WHERE Age BETWEEN 19 AND 65; 
SELECT COUNT(*) AS PostCount FROM posts p JOIN users u ON p.OwnerUserId = u.Id WHERE u.DisplayName = 'Jay Stevens' AND strftime('%Y', p.CreaionDate) = '2010'; 
SELECT Id, Title  FROM posts  WHERE OwnerUserId = (SELECT Id FROM users WHERE DisplayName = 'Harvey Motulsky')  ORDER BY ViewCount DESC  LIMIT 1; 
SELECT Id, Title  FROM posts  WHERE Score = (SELECT MAX(Score) FROM posts); 
SELECT AVG(Score) AS AverageScore FROM posts WHERE OwnerUserId = (SELECT Id FROM users WHERE DisplayName = 'Stephen Turner'); 
SELECT u.DisplayName FROM users u JOIN posts p ON u.Id = p.OwnerUserId WHERE p.ViewCount > 20000 AND strftime('%Y', p.CreaionDate) = '2011'; 
SELECT p.Id AS PostId, u.DisplayName AS OwnerDisplayName FROM posts p INNER JOIN users u ON p.OwnerUserId = u.Id WHERE strftime('%Y', p.CreaionDate) = '2010' ORDER BY p.FavoriteCount DESC LIMIT 1; 
SELECT      (CAST(COUNT(p.Id) AS FLOAT) / CAST(COUNT(all_posts.Id) AS FLOAT)) * 100 AS Percentage FROM      posts p INNER JOIN      users u ON p.OwnerUserId = u.Id INNER JOIN      (SELECT Id FROM posts WHERE strftime('%Y', CreationDate) = '2011') all_posts     ON p.Id = all_posts.Id WHERE      strftime('%Y', p.CreationDate) = '2011'      AND u.Reputation > 1000; 
SELECT      (CAST(COUNT(Id) FILTER (WHERE Age BETWEEN 13 AND 18) AS FLOAT) / COUNT(Id)) * 100 AS percentage  FROM users; 
SELECT p.ViewCount AS TotalViews, u.DisplayName AS UserName FROM posts p JOIN users u ON p.LastEditorUserId = u.Id WHERE p.Title = 'Computer Game Datasets'; 
SELECT COUNT(*) AS TotalPosts FROM posts WHERE ViewCount > (SELECT AVG(ViewCount) FROM posts); 
SELECT COUNT(*) AS CommentCount FROM comments WHERE PostId = (     SELECT Id     FROM posts     WHERE Score = (SELECT MAX(Score) FROM posts) ); 
SELECT COUNT(*) AS NumberOfPosts FROM posts WHERE ViewCount > 35000 AND CommentCount = 0; 
SELECT u.DisplayName, u.Location FROM posts p JOIN users u ON p.LastEditorUserId = u.Id WHERE p.Id = 183 ORDER BY p.LastEditDate DESC LIMIT 1; 
SELECT b.Name FROM badges b JOIN users u ON b.UserId = u.Id WHERE u.DisplayName = 'Emmett' AND b.Date = (     SELECT MAX(b2.Date)     FROM badges b2     JOIN users u2 ON b2.UserId = u2.Id     WHERE u2.DisplayName = 'Emmett' ); 
SELECT COUNT(*) AS AdultUsersWithOver5000Upvotes FROM users WHERE Age BETWEEN 19 AND 65 AND UpVotes > 5000; 
SELECT      julianday(badges.Date) - julianday(users.CreationDate) AS DaysToBadge FROM      badges JOIN      users ON badges.UserId = users.Id WHERE      users.DisplayName = 'Zolomon'; 
SELECT      u.Id AS UserId,      COUNT(DISTINCT p.Id) AS NumberOfPosts,      COUNT(DISTINCT c.Id) AS NumberOfComments FROM      users u LEFT JOIN      posts p ON u.Id = p.OwnerUserId LEFT JOIN      comments c ON u.Id = c.UserId WHERE      u.CreationDate = (SELECT MAX(CreationDate) FROM users) GROUP BY      u.Id; 
SELECT c.Text, u.DisplayName FROM comments c JOIN posts p ON c.PostId = p.Id LEFT JOIN users u ON c.UserId = u.Id WHERE p.Title = 'Analysing wind data with R' ORDER BY c.CreationDate DESC LIMIT 10; 
SELECT COUNT(DISTINCT UserId) AS UserCount FROM badges WHERE Name = 'Citizen Patrol'; 
SELECT COUNT(*)  FROM posts  WHERE Id IN (     SELECT ExcerptPostId      FROM tags      WHERE TagName = 'careers' ); 
SELECT Reputation, Views  FROM users  WHERE DisplayName = 'Jarrod Dixon'; 
SELECT      (SELECT COUNT(*)       FROM comments c      JOIN posts p ON c.PostId = p.Id      WHERE p.Title = 'Clustering 1D data') AS CommentCount,     (SELECT COUNT(*)      FROM posts p      WHERE p.ParentId = (SELECT Id FROM posts WHERE Title = 'Clustering 1D data')) AS AnswerCount; 
SELECT CreationDate  FROM users  WHERE DisplayName = 'IrishStat'; 
SELECT COUNT(DISTINCT PostId) AS NumberOfPosts FROM votes WHERE BountyAmount >= 30; 
WITH MostInfluentialUser AS (     SELECT Id AS UserId     FROM users     ORDER BY Reputation DESC     LIMIT 1 ), UserPosts AS (     SELECT *     FROM posts     WHERE OwnerUserId = (SELECT UserId FROM MostInfluentialUser) ), TotalPosts AS (     SELECT COUNT(Id) AS TotalCount     FROM UserPosts ), HighScorePosts AS (     SELECT COUNT(Id) AS HighScoreCount     FROM UserPosts     WHERE Score > 50 ) SELECT      (CAST(HighScorePosts.HighScoreCount AS FLOAT) / TotalPosts.TotalCount) * 100 AS Percentage FROM      HighScorePosts, TotalPosts; 
SELECT COUNT(*)  FROM posts  WHERE Score < 20; 
SELECT COUNT(*)  FROM tags  WHERE Id < 15 AND "Count" <= 20; 
SELECT ExcerptPostId, WikiPostId  FROM tags  WHERE TagName = 'sample'; 
SELECT u.Reputation, u.UpVotes  FROM comments c JOIN users u ON c.UserId = u.Id WHERE c.Text = 'fine, you win :)'; 
SELECT c.Text  FROM comments c JOIN posts p ON c.PostId = p.Id WHERE p.Title LIKE '%linear regression%'; 
SELECT c.Text  FROM comments c JOIN posts p ON c.PostId = p.Id WHERE p.ViewCount BETWEEN 100 AND 150 ORDER BY c.Score DESC LIMIT 1; 
SELECT u.CreationDate, u.Age FROM users u JOIN comments c ON u.Id = c.UserId WHERE c.Text LIKE '%http://%'; 
SELECT COUNT(DISTINCT c.PostId)  FROM comments c JOIN posts p ON c.PostId = p.Id WHERE c.Score = 0 AND p.ViewCount < 5; 
SELECT COUNT(*) FROM comments c JOIN posts p ON c.PostId = p.Id WHERE p.CommentCount = 1 AND c.Score = 0; 
SELECT COUNT(DISTINCT u.Id) AS TotalUsers FROM comments c JOIN users u ON c.UserId = u.Id WHERE c.Score = 0 AND u.Age = 40; 
SELECT p.Id AS PostId, c.Text AS CommentText FROM posts p JOIN comments c ON p.Id = c.PostId WHERE p.Title = 'Group differences on a five point Likert item'; 
SELECT u.UpVotes  FROM users u JOIN comments c ON u.Id = c.UserId WHERE c.Text = 'Define "valuable"...'; 
SELECT c.Text  FROM comments c JOIN users u ON c.UserId = u.Id WHERE u.DisplayName = 'Harvey Motulsky'; 
SELECT DISTINCT u.DisplayName FROM comments c JOIN users u ON c.UserId = u.Id WHERE c.Score BETWEEN 1 AND 5 AND u.DownVotes = 0; 
SELECT      (CAST(COUNT(c.UserId) AS FLOAT) / (SELECT COUNT(UserId) FROM comments c2 JOIN users u2 ON c2.UserId = u2.Id WHERE c2.Score BETWEEN 5 AND 10) * 100) AS Percentage FROM comments c JOIN users u ON c.UserId = u.Id WHERE c.Score BETWEEN 5 AND 10 AND u.UpVotes = 0; 
SELECT sp.power_name FROM hero_power hp JOIN superpower sp ON hp.power_id = sp.id JOIN superhero sh ON hp.hero_id = sh.id WHERE sh.superhero_name = '3-D Man'; 
SELECT COUNT(DISTINCT hero_id)  FROM hero_power WHERE power_id = (SELECT id FROM superpower WHERE power_name = 'Super Strength'); 
SELECT COUNT(*)  FROM superhero  WHERE id IN (     SELECT hero_id      FROM hero_power      WHERE power_id = (         SELECT id          FROM superpower          WHERE power_name = 'Super Strength'     ) ) AND height_cm > 200; 
SELECT s.full_name FROM superhero s JOIN hero_power hp ON s.id = hp.hero_id GROUP BY s.full_name HAVING COUNT(hp.power_id) > 15; 
SELECT COUNT(*) AS superhero_count FROM superhero WHERE eye_colour_id = (SELECT id FROM colour WHERE colour = 'Blue'); 
SELECT colour.colour  FROM superhero  JOIN colour ON superhero.skin_colour_id = colour.id  WHERE superhero.superhero_name = 'Apocalypse'; 
SELECT COUNT(DISTINCT hero_power.hero_id) AS superhero_count FROM hero_power INNER JOIN superpower ON hero_power.power_id = superpower.id INNER JOIN superhero ON hero_power.hero_id = superhero.id INNER JOIN colour ON superhero.eye_colour_id = colour.id WHERE superpower.power_name = 'Agility' AND colour.colour = 'Blue'; 
SELECT s.superhero_name FROM superhero s JOIN colour e ON s.eye_colour_id = e.id JOIN colour h ON s.hair_colour_id = h.id WHERE e.colour = 'Blue' AND h.colour = 'Blond'; 
SELECT COUNT(*) AS superhero_count FROM superhero JOIN publisher ON superhero.publisher_id = publisher.id WHERE publisher.publisher_name = 'Marvel Comics'; 
SELECT superhero_name, height_cm FROM superhero WHERE publisher_id = (SELECT id FROM publisher WHERE publisher_name = 'Marvel Comics') ORDER BY height_cm DESC; 
SELECT publisher.publisher_name  FROM superhero  JOIN publisher ON superhero.publisher_id = publisher.id  WHERE superhero.superhero_name = 'Sauron'; 
SELECT c.colour, COUNT(s.id) AS superhero_count FROM superhero s JOIN colour c ON s.eye_colour_id = c.id JOIN publisher p ON s.publisher_id = p.id WHERE p.publisher_name = 'Marvel Comics' GROUP BY c.colour ORDER BY superhero_count DESC; 
SELECT AVG(height_cm) AS average_height FROM superhero WHERE publisher_id = (SELECT id FROM publisher WHERE publisher_name = 'Marvel Comics'); 
SELECT s.superhero_name, s.full_name FROM superhero AS s JOIN publisher AS p ON s.publisher_id = p.id JOIN hero_power AS hp ON s.id = hp.hero_id JOIN superpower AS sp ON hp.power_id = sp.id WHERE p.publisher_name = 'Marvel Comics' AND sp.power_name = 'Super Strength'; 
SELECT COUNT(*)  FROM superhero  WHERE publisher_id = (SELECT id FROM publisher WHERE publisher_name = 'DC Comics'); 
SELECT p.publisher_name FROM superhero s JOIN hero_attribute ha ON s.id = ha.hero_id JOIN attribute a ON ha.attribute_id = a.id JOIN publisher p ON s.publisher_id = p.id WHERE a.attribute_name = 'Speed' ORDER BY ha.attribute_value ASC LIMIT 1; 
SELECT COUNT(*)  FROM superhero  WHERE eye_colour_id = (SELECT id FROM colour WHERE colour = 'Gold')  AND publisher_id = (SELECT id FROM publisher WHERE publisher_name = 'Marvel Comics'); 
SELECT publisher.publisher_name FROM superhero JOIN publisher ON superhero.publisher_id = publisher.id WHERE superhero.superhero_name = 'Blue Beetle II'; 
SELECT COUNT(*) FROM superhero JOIN colour ON superhero.hair_colour_id = colour.id WHERE colour.colour = 'Blond'; 
SELECT s.superhero_name, s.full_name, ha.attribute_value  FROM superhero s JOIN hero_attribute ha ON s.id = ha.hero_id JOIN attribute a ON ha.attribute_id = a.id WHERE a.attribute_name = 'Intelligence' ORDER BY ha.attribute_value ASC LIMIT 1; 
SELECT race  FROM race  WHERE id = (SELECT race_id FROM superhero WHERE superhero_name = 'Copycat'); 
SELECT s.superhero_name, s.full_name FROM superhero s JOIN hero_attribute ha ON s.id = ha.hero_id JOIN attribute a ON ha.attribute_id = a.id WHERE a.attribute_name = 'Durability' AND ha.attribute_value < 50; 
SELECT s.superhero_name FROM superhero s JOIN hero_power hp ON s.id = hp.hero_id JOIN superpower sp ON hp.power_id = sp.id WHERE sp.power_name = 'Death Touch'; 
SELECT COUNT(DISTINCT s.id) AS female_superheroes_count FROM superhero s JOIN gender g ON s.gender_id = g.id JOIN hero_attribute ha ON s.id = ha.hero_id JOIN attribute a ON ha.attribute_id = a.id WHERE g.gender = 'Female' AND a.attribute_name = 'Strength' AND ha.attribute_value = 100; 
SELECT s.superhero_name FROM superhero s JOIN hero_power hp ON s.id = hp.hero_id GROUP BY s.id, s.superhero_name ORDER BY COUNT(hp.power_id) DESC LIMIT 1; 
SELECT COUNT(*) AS vampire_superheroes_count FROM superhero JOIN race ON superhero.race_id = race.id WHERE race.race = 'Vampire'; 
SELECT      (COUNT(s.id) * 100.0 / (SELECT COUNT(id) FROM superhero)) AS percentage_bad_alignment,     COUNT(CASE WHEN p.publisher_name = 'Marvel Comics' THEN s.id END) AS marvel_bad_alignment_count FROM      superhero s JOIN      alignment a ON s.alignment_id = a.id LEFT JOIN      publisher p ON s.publisher_id = p.id WHERE      a.alignment = 'Bad'; 
SELECT      ABS(         (SELECT COUNT(*)           FROM superhero           INNER JOIN publisher ON superhero.publisher_id = publisher.id           WHERE publisher.publisher_name = 'Marvel Comics') -          (SELECT COUNT(*)           FROM superhero           INNER JOIN publisher ON superhero.publisher_id = publisher.id           WHERE publisher.publisher_name = 'DC Comics')     ) AS difference; 
SELECT id  FROM publisher  WHERE publisher_name = 'Star Trek'; 
SELECT AVG(attribute_value) AS average_attribute_value FROM hero_attribute; 
SELECT COUNT(*) AS total_superheroes_without_full_name  FROM superhero  WHERE full_name IS NULL; 
SELECT colour.colour  FROM superhero  JOIN colour ON superhero.eye_colour_id = colour.id  WHERE superhero.id = 75; 
SELECT sp.power_name FROM superhero sh JOIN hero_power hp ON sh.id = hp.hero_id JOIN superpower sp ON hp.power_id = sp.id WHERE sh.superhero_name = 'Deathlok'; 
SELECT AVG(weight_kg) AS average_weight FROM superhero WHERE gender_id = (SELECT id FROM gender WHERE gender = 'Female'); 
SELECT DISTINCT sp.power_name FROM superhero AS sh JOIN hero_power AS hp ON sh.id = hp.hero_id JOIN superpower AS sp ON hp.power_id = sp.id JOIN gender AS g ON sh.gender_id = g.id WHERE g.gender = 'Male' LIMIT 5; 
SELECT superhero_name  FROM superhero  JOIN race ON superhero.race_id = race.id  WHERE race.race = 'Alien'; 
SELECT s.superhero_name  FROM superhero s JOIN colour c ON s.eye_colour_id = c.id WHERE s.height_cm BETWEEN 170 AND 190 AND c.colour = 'No Colour'; 
SELECT sp.power_name  FROM hero_power hp  JOIN superpower sp ON hp.power_id = sp.id  WHERE hp.hero_id = 56; 
SELECT full_name  FROM superhero  WHERE race_id = (SELECT id FROM race WHERE race = 'Demi-God')  LIMIT 5; 
SELECT COUNT(*) AS bad_superheroes_count FROM superhero WHERE alignment_id = 2; 
SELECT race  FROM race  WHERE id = (SELECT race_id FROM superhero WHERE weight_kg = 169); 
SELECT colour.colour  FROM superhero JOIN race ON superhero.race_id = race.id JOIN colour ON superhero.hair_colour_id = colour.id WHERE superhero.height_cm = 185 AND race.race = 'Human'; 
SELECT colour.colour  FROM superhero  JOIN colour ON superhero.eye_colour_id = colour.id  WHERE superhero.weight_kg = (SELECT MAX(weight_kg) FROM superhero); 
SELECT (SUM(CASE WHEN publisher.publisher_name = 'Marvel Comics' THEN 1 ELSE 0 END) * 100.0 / COUNT(superhero.id)) AS percentage FROM superhero JOIN publisher ON superhero.publisher_id = publisher.id WHERE superhero.height_cm BETWEEN 150 AND 180; 
SELECT s.superhero_name FROM superhero s JOIN gender g ON s.gender_id = g.id WHERE g.gender = 'Male' AND s.weight_kg > (SELECT AVG(weight_kg) * 0.79 FROM superhero); 
SELECT sp.power_name, COUNT(hp.power_id) AS power_count FROM hero_power hp JOIN superpower sp ON hp.power_id = sp.id GROUP BY sp.power_name ORDER BY power_count DESC LIMIT 1; 
SELECT ha.attribute_value FROM hero_attribute ha JOIN superhero s ON ha.hero_id = s.id WHERE s.superhero_name = 'Abomination'; 
SELECT sp.power_name  FROM hero_power hp  JOIN superpower sp ON hp.power_id = sp.id  WHERE hp.hero_id = 1; 
SELECT COUNT(DISTINCT hero_id) AS number_of_heroes_with_stealth_power FROM hero_power JOIN superpower ON hero_power.power_id = superpower.id WHERE superpower.power_name = 'stealth'; 
SELECT s.full_name FROM superhero s JOIN hero_attribute ha ON s.id = ha.hero_id JOIN attribute a ON ha.attribute_id = a.id WHERE a.attribute_name = 'Strength' ORDER BY ha.attribute_value DESC LIMIT 1; 
SELECT COUNT(superhero.id) * 1.0 / COUNT(*) AS average FROM superhero WHERE skin_colour_id = 1; 
SELECT COUNT(*)  FROM superhero  WHERE publisher_id = (SELECT id FROM publisher WHERE publisher_name = 'Dark Horse Comics'); 
SELECT s.superhero_name  FROM superhero s JOIN publisher p ON s.publisher_id = p.id JOIN hero_attribute ha ON s.id = ha.hero_id JOIN attribute a ON ha.attribute_id = a.id WHERE p.publisher_name = 'Dark Horse Comics' AND a.attribute_name = 'Durability' ORDER BY ha.attribute_value DESC LIMIT 1; 
SELECT colour.colour  FROM superhero  JOIN colour ON superhero.eye_colour_id = colour.id  WHERE superhero.full_name = 'Abraham Sapien'; 
SELECT s.superhero_name  FROM superhero s JOIN hero_power hp ON s.id = hp.hero_id JOIN superpower sp ON hp.power_id = sp.id WHERE sp.power_name = 'Flight'; 
SELECT c1.colour AS eye_colour, c2.colour AS hair_colour, c3.colour AS skin_colour FROM superhero s JOIN gender g ON s.gender_id = g.id JOIN publisher p ON s.publisher_id = p.id JOIN colour c1 ON s.eye_colour_id = c1.id JOIN colour c2 ON s.hair_colour_id = c2.id JOIN colour c3 ON s.skin_colour_id = c3.id WHERE g.gender = 'Female' AND p.publisher_name = 'Dark Horse Comics'; 
SELECT s.superhero_name, p.publisher_name FROM superhero s JOIN publisher p ON s.publisher_id = p.id WHERE s.hair_colour_id = s.skin_colour_id AND s.hair_colour_id = s.eye_colour_id; 
SELECT race.race  FROM superhero  JOIN race ON superhero.race_id = race.id  WHERE superhero.superhero_name = 'A-Bomb'; 
SELECT      (CAST(COUNT(s.id) AS FLOAT) / (SELECT COUNT(*) FROM superhero WHERE gender_id = (SELECT id FROM gender WHERE gender = 'Female')) * 100) AS percentage_of_blue_female_superheroes FROM      superhero s WHERE      s.gender_id = (SELECT id FROM gender WHERE gender = 'Female')      AND s.skin_colour_id = (SELECT id FROM colour WHERE colour = 'Blue'); 
SELECT superhero_name, race  FROM superhero  JOIN race ON superhero.race_id = race.id  WHERE full_name = 'Charles Chandler'; 
SELECT gender.gender FROM superhero JOIN gender ON superhero.gender_id = gender.id WHERE superhero.superhero_name = 'Agent 13'; 
SELECT s.superhero_name FROM superhero s JOIN hero_power hp ON s.id = hp.hero_id JOIN superpower sp ON hp.power_id = sp.id WHERE sp.power_name = 'Adaptation'; 
SELECT COUNT(*) AS power_count FROM hero_power WHERE hero_id = (SELECT id FROM superhero WHERE superhero_name = 'Amazo'); 
SELECT sp.power_name FROM superhero AS sh JOIN hero_power AS hp ON sh.id = hp.hero_id JOIN superpower AS sp ON hp.power_id = sp.id WHERE sh.full_name = 'Hunter Zolomon'; 
SELECT superhero.height_cm  FROM superhero JOIN colour ON superhero.eye_colour_id = colour.id WHERE colour.colour = 'Amber'; 
SELECT s.superhero_name FROM superhero s JOIN colour e ON s.eye_colour_id = e.id JOIN colour h ON s.hair_colour_id = h.id WHERE e.colour = 'Black' AND h.colour = 'Black'; 
SELECT DISTINCT colour.colour AS eye_colour FROM superhero JOIN colour ON superhero.eye_colour_id = colour.id WHERE superhero.skin_colour_id = (SELECT id FROM colour WHERE colour = 'Gold'); 
SELECT full_name  FROM superhero  JOIN race ON superhero.race_id = race.id  WHERE race.race = 'Vampire'; 
SELECT superhero_name  FROM superhero  WHERE alignment_id = (SELECT id FROM alignment WHERE alignment = 'Neutral'); 
SELECT COUNT(DISTINCT ha.hero_id) AS hero_count FROM hero_attribute ha JOIN attribute a ON ha.attribute_id = a.id WHERE a.attribute_name = 'Strength' AND ha.attribute_value = (     SELECT MAX(ha2.attribute_value)     FROM hero_attribute ha2     JOIN attribute a2 ON ha2.attribute_id = a2.id     WHERE a2.attribute_name = 'Strength' ); 
SELECT r.race, a.alignment FROM superhero AS s JOIN race AS r ON s.race_id = r.id JOIN alignment AS a ON s.alignment_id = a.id WHERE s.superhero_name = 'Cameron Hicks'; 
SELECT (CAST(COUNT(*) AS FLOAT) / (SELECT COUNT(*) FROM superhero WHERE publisher_id = (SELECT id FROM publisher WHERE publisher_name = 'Marvel Comics')) * 100) AS percent_female_heroes FROM superhero WHERE gender_id = (SELECT id FROM gender WHERE gender = 'Female') AND publisher_id = (SELECT id FROM publisher WHERE publisher_name = 'Marvel Comics'); 
SELECT AVG(weight_kg) AS average_weight FROM superhero WHERE race_id = (SELECT id FROM race WHERE race = 'Alien'); 
SELECT      ABS(         (SELECT weight_kg FROM superhero WHERE full_name = 'Emil Blonsky') -          (SELECT weight_kg FROM superhero WHERE full_name = 'Charles Chandler')     ) AS weight_difference; 
SELECT superhero_name, AVG(height_cm) AS average_height FROM superhero GROUP BY superhero_name; 
SELECT sp.power_name  FROM superhero s JOIN hero_power hp ON s.id = hp.hero_id JOIN superpower sp ON hp.power_id = sp.id WHERE s.superhero_name = 'Abomination'; 
SELECT COUNT(*)  FROM superhero  WHERE race_id = 21 AND gender_id = 1; 
SELECT s.superhero_name FROM superhero s JOIN hero_attribute ha ON s.id = ha.hero_id JOIN attribute a ON ha.attribute_id = a.id WHERE a.attribute_name = 'Speed' ORDER BY ha.attribute_value DESC LIMIT 1; 
SELECT COUNT(*)  FROM superhero  WHERE alignment_id = 3; 
SELECT a.attribute_name, ha.attribute_value FROM hero_attribute ha JOIN attribute a ON ha.attribute_id = a.id JOIN superhero s ON ha.hero_id = s.id WHERE s.superhero_name = '3-D Man'; 
SELECT s.superhero_name FROM superhero s JOIN colour e ON s.eye_colour_id = e.id JOIN colour h ON s.hair_colour_id = h.id WHERE e.colour = 'Blue' AND h.colour = 'Brown'; 
SELECT publisher.publisher_name FROM superhero JOIN publisher ON superhero.publisher_id = publisher.id WHERE superhero.superhero_name IN ('Hawkman', 'Karate Kid', 'Speedy'); 
SELECT COUNT(*) AS superhero_count  FROM superhero  WHERE publisher_id = 1; 
SELECT (CAST(COUNT(*) AS FLOAT) / (SELECT COUNT(*) FROM superhero) * 100.0) AS percentage_blue_eyes FROM superhero WHERE eye_colour_id = 7; 
SELECT      (CAST(SUM(CASE WHEN gender_id = 2 THEN 1 ELSE 0 END) AS FLOAT) /       CAST(SUM(CASE WHEN gender_id = 1 THEN 1 ELSE 0 END) AS FLOAT)) AS ratio FROM superhero; 
SELECT superhero_name  FROM superhero  WHERE height_cm = (SELECT MAX(height_cm) FROM superhero); 
SELECT id FROM superpower WHERE power_name = 'cryokinesis'; 
SELECT superhero_name FROM superhero WHERE id = 294; 
SELECT full_name  FROM superhero  WHERE weight_kg IS NULL OR weight_kg = 0; 
SELECT colour.colour  FROM superhero  JOIN colour ON superhero.eye_colour_id = colour.id  WHERE superhero.full_name = 'Karen Beecher-Duncan'; 
SELECT sp.power_name  FROM superhero AS sh JOIN hero_power AS hp ON sh.id = hp.hero_id JOIN superpower AS sp ON hp.power_id = sp.id WHERE sh.full_name = 'Helen Parr'; 
SELECT race.race  FROM superhero  JOIN race ON superhero.race_id = race.id  WHERE superhero.weight_kg = 108 AND superhero.height_cm = 188; 
SELECT publisher.publisher_name  FROM superhero  JOIN publisher ON superhero.publisher_id = publisher.id  WHERE superhero.id = 38; 
SELECT r.race FROM hero_attribute ha JOIN superhero s ON ha.hero_id = s.id JOIN race r ON s.race_id = r.id WHERE ha.attribute_value = (SELECT MAX(attribute_value) FROM hero_attribute); 
SELECT a.alignment, sp.power_name FROM superhero AS sh LEFT JOIN alignment AS a ON sh.alignment_id = a.id LEFT JOIN hero_power AS hp ON sh.id = hp.hero_id LEFT JOIN superpower AS sp ON hp.power_id = sp.id WHERE sh.superhero_name = 'Atom IV'; 
SELECT s.full_name  FROM superhero s JOIN colour c ON s.eye_colour_id = c.id WHERE c.colour = 'Blue' LIMIT 5; 
SELECT AVG(ha.attribute_value) AS average_attribute_value FROM superhero s JOIN hero_attribute ha ON s.id = ha.hero_id WHERE s.alignment_id = 3; 
SELECT colour.colour  FROM superhero JOIN colour ON superhero.skin_colour_id = colour.id JOIN hero_attribute ON superhero.id = hero_attribute.hero_id WHERE hero_attribute.attribute_value = 100; 
SELECT COUNT(*)  FROM superhero  WHERE alignment_id = 1 AND gender_id = 2; 
SELECT s.superhero_name  FROM superhero s JOIN hero_attribute ha ON s.id = ha.hero_id WHERE ha.attribute_value BETWEEN 75 AND 80; 
SELECT race.race  FROM superhero  JOIN race ON superhero.race_id = race.id  JOIN gender ON superhero.gender_id = gender.id  JOIN colour ON superhero.hair_colour_id = colour.id  WHERE colour.colour = 'Blue' AND gender.gender = 'Male'; 
SELECT      (CAST(SUM(CASE WHEN gender_id = 2 THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)) * 100 AS female_percentage FROM superhero WHERE alignment_id = 2; 
SELECT      (SELECT COUNT(*)       FROM superhero T1      JOIN colour T2 ON T1.eye_colour_id = T2.id      WHERE (T1.weight_kg = 0 OR T1.weight_kg IS NULL) AND T2.id = 7)      -      (SELECT COUNT(*)       FROM superhero T1      JOIN colour T2 ON T1.eye_colour_id = T2.id      WHERE (T1.weight_kg = 0 OR T1.weight_kg IS NULL) AND T2.id = 1) AS difference; 
SELECT ha.attribute_value  FROM hero_attribute ha JOIN attribute a ON ha.attribute_id = a.id JOIN superhero s ON ha.hero_id = s.id WHERE a.attribute_name = 'Strength' AND s.superhero_name = 'Hulk'; 
SELECT sp.power_name FROM superhero sh JOIN hero_power hp ON sh.id = hp.hero_id JOIN superpower sp ON hp.power_id = sp.id WHERE sh.superhero_name = 'Ajax'; 
SELECT COUNT(*) AS green_skinned_villains FROM superhero JOIN colour ON superhero.skin_colour_id = colour.id JOIN alignment ON superhero.alignment_id = alignment.id WHERE colour.colour = 'Green' AND alignment.alignment = 'Bad'; 
SELECT COUNT(*)  FROM superhero  WHERE gender_id = (SELECT id FROM gender WHERE gender = 'Female')  AND publisher_id = (SELECT id FROM publisher WHERE publisher_name = 'Marvel Comics'); 
SELECT s.superhero_name FROM superhero s JOIN hero_power hp ON s.id = hp.hero_id JOIN superpower sp ON hp.power_id = sp.id WHERE sp.power_name = 'Wind Control' ORDER BY s.superhero_name ASC; 
SELECT gender.gender  FROM superhero  JOIN hero_power ON superhero.id = hero_power.hero_id  JOIN superpower ON hero_power.power_id = superpower.id  JOIN gender ON superhero.gender_id = gender.id  WHERE superpower.power_name = 'Phoenix Force'; 
SELECT superhero_name  FROM superhero  WHERE publisher_id = (SELECT id FROM publisher WHERE publisher_name = 'DC Comics')  ORDER BY weight_kg DESC  LIMIT 1; 
SELECT AVG(height_cm) AS average_height FROM superhero JOIN race ON superhero.race_id = race.id JOIN publisher ON superhero.publisher_id = publisher.id WHERE race.race <> 'Human' AND publisher.publisher_name = 'Dark Horse Comics'; 
SELECT COUNT(DISTINCT hero_id) AS fastest_superheroes_count FROM hero_attribute WHERE attribute_id = (SELECT id FROM attribute WHERE attribute_name = 'Speed') AND attribute_value = 100; 
SELECT      ABS(         (SELECT COUNT(*) FROM superhero AS s           JOIN publisher AS p ON s.publisher_id = p.id           WHERE p.publisher_name = 'DC Comics') -          (SELECT COUNT(*) FROM superhero AS s           JOIN publisher AS p ON s.publisher_id = p.id           WHERE p.publisher_name = 'Marvel Comics')     ) AS difference; 
SELECT a.attribute_name FROM hero_attribute ha JOIN attribute a ON ha.attribute_id = a.id WHERE ha.hero_id = (SELECT id FROM superhero WHERE superhero_name = 'Black Panther') ORDER BY ha.attribute_value ASC LIMIT 1; 
SELECT colour.colour  FROM superhero JOIN colour ON superhero.eye_colour_id = colour.id WHERE superhero.superhero_name = 'Abomination'; 
SELECT superhero_name, height_cm  FROM superhero  ORDER BY height_cm DESC  LIMIT 1; 
SELECT superhero_name  FROM superhero  WHERE full_name = 'Charles Chandler'; 
SELECT (COUNT(s.id) * 100.0 / (SELECT COUNT(id) FROM superhero WHERE publisher_id = (SELECT id FROM publisher WHERE publisher_name = 'George Lucas'))) AS female_percentage FROM superhero s WHERE s.gender_id = (SELECT id FROM gender WHERE gender = 'Female') AND s.publisher_id = (SELECT id FROM publisher WHERE publisher_name = 'George Lucas'); 
SELECT      (COUNT(CASE WHEN a.alignment = 'Good' THEN 1 END) * 100.0 / COUNT(s.id)) AS percentage_good_superheroes FROM      superhero s JOIN      alignment a ON s.alignment_id = a.id JOIN      publisher p ON s.publisher_id = p.id WHERE      p.publisher_name = 'Marvel Comics'; 
SELECT COUNT(*) AS total_superheroes FROM superhero WHERE full_name LIKE 'John%'; 
SELECT hero_id  FROM hero_attribute  WHERE attribute_value = (SELECT MIN(attribute_value) FROM hero_attribute); 
SELECT s.full_name  FROM superhero s JOIN race r ON s.race_id = r.id WHERE r.race = 'Alien'; 
SELECT s.full_name  FROM superhero s JOIN colour c ON s.eye_colour_id = c.id WHERE s.weight_kg < 100 AND c.colour = 'Brown'; 
SELECT ha.attribute_value FROM superhero AS s JOIN hero_attribute AS ha ON s.id = ha.hero_id WHERE s.superhero_name = 'Aquababy'; 
SELECT weight_kg, race  FROM superhero  JOIN race ON superhero.race_id = race.id  WHERE superhero.id = 40; 
SELECT AVG(height_cm) AS average_height FROM superhero WHERE alignment_id = (SELECT id FROM alignment WHERE alignment = 'Neutral'); 
SELECT DISTINCT hero_id FROM hero_attribute WHERE attribute_id = (SELECT id FROM attribute WHERE attribute_name = 'Intelligence'); 
SELECT colour.colour  FROM superhero  JOIN colour ON superhero.eye_colour_id = colour.id  WHERE superhero.superhero_name = 'Blackwulf'; 
SELECT sp.power_name  FROM superhero AS sh JOIN hero_power AS hp ON sh.id = hp.hero_id JOIN superpower AS sp ON hp.power_id = sp.id WHERE sh.height_cm > (SELECT AVG(height_cm) * 0.8 FROM superhero); 
SELECT d.driverRef  FROM qualifying q JOIN drivers d ON q.driverId = d.driverId WHERE q.raceId = 20 ORDER BY q.q1 DESC LIMIT 5; 
SELECT d.surname FROM qualifying q JOIN drivers d ON q.driverId = d.driverId WHERE q.raceId = 19 ORDER BY CAST(REPLACE(q.q2, ':', '') AS REAL) LIMIT 1; 
SELECT DISTINCT r.year FROM races r JOIN circuits c ON r.circuitId = c.circuitId WHERE LOWER(TRIM(c.location)) LIKE '%shanghai%'; 
SELECT r.url  FROM races r JOIN circuits c ON r.circuitId = c.circuitId WHERE c.name = 'Circuit de Barcelona-Catalunya'; 
SELECT races.name  FROM races  JOIN circuits ON races.circuitId = circuits.circuitId  WHERE circuits.country = 'Germany'; 
SELECT c.name AS circuitName, c.location, c.country FROM constructors con JOIN constructorResults cr ON con.constructorId = cr.constructorId JOIN races r ON cr.raceId = r.raceId JOIN circuits c ON r.circuitId = c.circuitId WHERE con.name = 'Renault'; 
SELECT COUNT(*) AS race_count FROM races r JOIN circuits c ON r.circuitId = c.circuitId WHERE r.year = 2010   AND c.country IS NOT NULL   AND c.country NOT IN (     'China', 'Japan', 'India', 'Malaysia', 'Singapore', 'South Korea', 'Turkey',     'Germany', 'France', 'Italy', 'Spain', 'United Kingdom', 'Russia', 'Netherlands',     'Belgium', 'Austria', 'Hungary', 'Finland', 'Sweden', 'Norway', 'Denmark',     'Poland', 'Czech Republic', 'Portugal', 'Switzerland', 'Ireland', 'Saudi Arabia',      'Qatar', 'Bahrain', 'Thailand', 'UAE', 'Croatia', 'Lithuania', 'Greece', 'Estonia',     'Latvia', 'Slovakia', 'Slovenia', 'Bulgaria', 'Romania', 'Serbia', 'Bosnia and Herzegovina',     'Montenegro', 'Albania', 'Moldova', 'Luxembourg', 'Iceland', 'Monaco', 'Liechtenstein'   ); 
SELECT r.name AS race_name FROM races r JOIN circuits c ON r.circuitId = c.circuitId WHERE c.country = 'Spain'; 
SELECT circuits.lat, circuits.lng  FROM circuits  JOIN races ON circuits.circuitId = races.circuitId  WHERE races.name = 'Australian Grand Prix'; 
SELECT r.url  FROM races r JOIN circuits c ON r.circuitId = c.circuitId WHERE c.name = 'Sepang International Circuit'; 
SELECT r.time  FROM races r JOIN circuits c ON r.circuitId = c.circuitId WHERE c.name LIKE '%Sepang%' AND r.time IS NOT NULL; 
SELECT circuits.lat, circuits.lng  FROM races  JOIN circuits ON races.circuitId = circuits.circuitId  WHERE races.name = 'Abu Dhabi Grand Prix'; 
SELECT constructors.nationality  FROM constructorResults  JOIN constructors ON constructorResults.constructorId = constructors.constructorId  WHERE constructorResults.raceId = 24 AND constructorResults.points = 1; 
SELECT q.q1  FROM qualifying q JOIN drivers d ON q.driverId = d.driverId WHERE d.forename = 'Bruno' AND d.surname = 'Senna' AND q.raceId = 354; 
SELECT d.nationality  FROM qualifying q JOIN drivers d ON q.driverId = d.driverId WHERE q.q2 = '0:01:40' AND q.raceId = 355; 
SELECT number  FROM qualifying  WHERE raceId = 903 AND q3 LIKE '1:54%'; 
SELECT COUNT(*) FROM results WHERE raceId IN (     SELECT raceId     FROM races     WHERE TRIM(name) = 'Bahrain Grand Prix' AND year = 2007 ) AND statusId != 1; 
SELECT s.year, s.url  FROM seasons s JOIN races r ON s.year = r.year WHERE r.raceId = 901; 
SELECT COUNT(DISTINCT r.driverId) AS finished_drivers FROM results r JOIN races ra ON r.raceId = ra.raceId JOIN status s ON r.statusId = s.statusId WHERE ra.date = '2015-11-29'   AND s.status = 'Finished'; 
SELECT d.driverId, d.forename, d.surname, d.dob  FROM drivers d  JOIN results r ON d.driverId = r.driverId  WHERE r.raceId = 592    AND r.statusId = 1  ORDER BY d.dob ASC  LIMIT 1; 
SELECT d.url  FROM lapTimes lt JOIN drivers d ON lt.driverId = d.driverId WHERE lt.raceId = 161  AND lt.time LIKE '1:27.%'; 
SELECT d.nationality FROM results r JOIN drivers d ON r.driverId = d.driverId WHERE r.raceId = 933 ORDER BY CAST(r.fastestLapSpeed AS REAL) DESC LIMIT 1; 
SELECT circuits.location, circuits.lat, circuits.lng  FROM races  JOIN circuits ON races.circuitId = circuits.circuitId  WHERE races.name = 'Malaysian Grand Prix'; 
SELECT constructors.url  FROM constructorResults  JOIN constructors ON constructorResults.constructorId = constructors.constructorId  WHERE constructorResults.raceId = 9  ORDER BY constructorResults.points DESC  LIMIT 1; 
