SELECT MAX(`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS HighestEligibleFreeRate FROM frpm WHERE `County Name` = 'Alameda'; 
SELECT s.School, f.`Percent (%) Eligible Free (Ages 5-17)`  FROM schools s JOIN frpm f ON s.CDSCode = f.CDSCode WHERE s.EdOpsName = 'Continuation' ORDER BY (`Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`) ASC LIMIT 3; 
SELECT s.Zip FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE s.County = 'Fresno' AND s.DOC = 'Fresno County Office of Education' AND f.`Charter School (Y/N)` = 1; 
SELECT s.MailStreet  FROM schools s JOIN frpm f ON s.CDSCode = f.CDSCode WHERE f.`FRPM Count (K-12)` = (SELECT MAX(`FRPM Count (K-12)`) FROM frpm); 
SELECT s.Phone FROM schools s JOIN frpm f ON s.CDSCode = f.CDSCode WHERE f.`Charter School (Y/N)` = 1 AND s.FundingType = 'Direct' AND s.OpenDate > '2000-01-01'; 
SELECT COUNT(*) AS VirtualSchoolsWithHighMathScore FROM satscores AS s JOIN schools AS sc ON s.cds = sc.CDSCode WHERE s.AvgScrMath > 400 AND sc.Virtual = 'F'; 
SELECT s.School  FROM schools s JOIN satscores ss ON s.CDSCode = ss.cds WHERE ss.NumTstTakr > 500 AND s.Magnet = 1; 
SELECT s.Phone  FROM schools s JOIN satscores ss ON s.CDSCode = ss.cds WHERE ss.NumGE1500 = (     SELECT MAX(NumGE1500)      FROM satscores ); 
SELECT s.NumTstTakr  FROM satscores AS s  JOIN frpm AS f ON s.cds = f.CDSCode  WHERE f."FRPM Count (K-12)" = (SELECT MAX("FRPM Count (K-12)") FROM frpm); 
SELECT COUNT(*) AS CharterFundedSchoolsCount FROM satscores AS s JOIN schools AS sc ON s.cds = sc.CDSCode WHERE s.AvgScrMath > 560 AND sc.FundingType = 'Directly funded' 
SELECT frpm.`FRPM Count (Ages 5-17)` FROM satscores JOIN frpm ON satscores.cds = frpm.CDSCode WHERE satscores.AvgScrRead = (SELECT MAX(AvgScrRead) FROM satscores); 
SELECT s.CDSCode FROM schools s JOIN frpm f ON s.CDSCode = f.CDSCode WHERE (f.`Enrollment (K-12)` + f.`Enrollment (Ages 5-17)`) > 500; 
SELECT MAX("Free Meal Count (Ages 5-17)" / "Enrollment (Ages 5-17)") AS HighestEligibleFreeRate FROM frpm WHERE "Enrollment (Ages 5-17)" > 0   AND "CDSCode" IN (     SELECT cds     FROM satscores     WHERE CAST(NumGE1500 AS REAL) / NumTstTakr > 0.3 ); 
SELECT s.Phone  FROM schools s JOIN satscores ss ON s.CDSCode = ss.cds ORDER BY (CAST(ss.NumGE1500 AS FLOAT) / ss.NumTstTakr) DESC LIMIT 3; 
SELECT s.NCESSchool, f.`School Name`, f.`Enrollment (Ages 5-17)` FROM frpm f JOIN schools s ON f.CDSCode = s.CDSCode ORDER BY f.`Enrollment (Ages 5-17)` DESC LIMIT 5; 
SELECT s.District, MAX(sa.AvgScrRead) AS HighestAvgReadingScore FROM satscores sa JOIN schools s ON sa.cds = s.CDSCode WHERE s.StatusType = 'Active' GROUP BY s.District ORDER BY HighestAvgReadingScore DESC LIMIT 1; 
SELECT COUNT(*) FROM satscores AS s JOIN schools AS sc ON s.cds = sc.CDSCode WHERE sc.County = 'Alameda' AND s.NumTstTakr < 100; 
SELECT s.CharterNum, sat.sname, sat.AvgScrWrite  FROM satscores AS sat JOIN schools AS s ON sat.cds = s.CDSCode WHERE sat.AvgScrWrite > 499 AND s.CharterNum IS NOT NULL ORDER BY sat.AvgScrWrite DESC; 
SELECT COUNT(*) FROM satscores AS s JOIN schools AS sc ON s.cds = sc.CDSCode WHERE sc.County = 'Fresno' AND sc.FundingType = 'Directly Funded' AND s.NumTstTakr <= 250; 
SELECT s.Phone  FROM schools s JOIN satscores ss ON s.CDSCode = ss.cds ORDER BY ss.AvgScrMath DESC LIMIT 1; 
SELECT COUNT(*)  FROM frpm  WHERE `County Name` = 'Amador' AND `Low Grade` = '9' AND `High Grade` = '12'; 
SELECT COUNT(*)  FROM frpm  JOIN schools ON frpm.CDSCode = schools.CDSCode  WHERE schools.County = 'Los Angeles'    AND frpm.`Free Meal Count (K-12)` > 500    AND frpm.`FRPM Count (K-12)` < 700; 
SELECT sname, NumTstTakr  FROM satscores  WHERE cname = 'Contra Costa'  ORDER BY NumTstTakr DESC  LIMIT 1; 
SELECT      s.School AS SchoolName,      s.Street AS FullStreetAddress FROM      schools s JOIN      frpm f ON s.CDSCode = f.CDSCode WHERE      ABS(f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30; 
SELECT s.School  FROM schools s JOIN frpm f ON s.CDSCode = f.CDSCode JOIN satscores ss ON s.CDSCode = ss.cds WHERE (f.`Free Meal Count (K-12)` / f.`Enrollment (K-12)`) > 0.1 AND ss.NumGE1500 >= 1; 
WITH RiversideSchools AS (     SELECT s.School, s.FundingType, ss.AvgScrMath     FROM schools s     JOIN satscores ss ON s.CDSCode = ss.cds     WHERE s.County = 'Riverside' ), AverageMath AS (     SELECT AVG(AvgScrMath) AS AvgOfAvgMath     FROM RiversideSchools ) SELECT rs.School, rs.FundingType FROM RiversideSchools rs CROSS JOIN AverageMath am WHERE am.AvgOfAvgMath > 400; 
SELECT s.School AS SchoolName, s.Street, s.City, s.State, s.Zip FROM schools s JOIN frpm f ON s.CDSCode = f.CDSCode WHERE s.County = 'Monterey' AND f.`High Grade` = '12' AND f.`FRPM Count (Ages 5-17)` > 800; 
SELECT s.School AS SchoolName, sa.AvgScrWrite AS WritingScore, s.Phone AS CommunicationNumber FROM schools s JOIN satscores sa ON s.CDSCode = sa.cds WHERE (s.OpenDate > '1991-12-31' OR s.ClosedDate < '2000-01-01') AND sa.AvgScrWrite IS NOT NULL; 
WITH EnrollmentDifference AS (     SELECT          s.School AS SchoolName,         s.DOCType AS DOCType,         (COALESCE(f.`Enrollment (K-12)`, 0) - COALESCE(f.`Enrollment (Ages 5-17)`, 0)) AS Difference     FROM          frpm f     INNER JOIN          schools s ON f.CDSCode = s.CDSCode     WHERE          s.FundingType = 'Locally Funded' ), AverageDifference AS (     SELECT          AVG(Difference) AS AvgDifference     FROM          EnrollmentDifference ) SELECT      SchoolName,     DOCType FROM      EnrollmentDifference WHERE      Difference > (SELECT AvgDifference FROM AverageDifference); 
SELECT OpenDate  FROM schools  WHERE CDSCode = (     SELECT CDSCode      FROM frpm      WHERE `Enrollment (K-12)` = (         SELECT MAX(`Enrollment (K-12)`)          FROM frpm     ) ); 
SELECT City, `Enrollment (K-12)` FROM schools JOIN frpm ON schools.CDSCode = frpm.CDSCode ORDER BY `Enrollment (K-12)` ASC LIMIT 5; 
SELECT `School Name`, (`Free Meal Count (K-12)` / `Enrollment (K-12)`) AS `Eligible Free Rate` FROM `frpm` WHERE `Enrollment (K-12)` IS NOT NULL ORDER BY `Enrollment (K-12)` DESC LIMIT 2 OFFSET 9; 
SELECT s.School, f.`FRPM Count (K-12)` / f.`Enrollment (K-12)` AS EligibleRate FROM frpm f JOIN schools s ON f.CDSCode = s.CDSCode WHERE s.DOC = '66' ORDER BY f.`FRPM Count (K-12)` DESC LIMIT 5; 
SELECT s.School, s.Website FROM schools s JOIN frpm f ON s.CDSCode = f.CDSCode WHERE f.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000; 
SELECT (`Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`) AS FreeRate FROM frpm WHERE `CDSCode` = (     SELECT `CDSCode`     FROM schools     WHERE `AdmFName1` = 'Kacey' AND `AdmLName1` = 'Gibson' ); 
SELECT s.AdmEmail1  FROM schools s  JOIN frpm f ON s.CDSCode = f.CDSCode  WHERE f.`Charter School (Y/N)` = 1  ORDER BY f.`Enrollment (K-12)` ASC  LIMIT 1; 
SELECT AdmFName1, AdmLName1, AdmFName2, AdmLName2, AdmFName3, AdmLName3 FROM schools JOIN satscores ON schools.CDSCode = satscores.cds WHERE NumGE1500 = (SELECT MAX(NumGE1500) FROM satscores); 
WITH MinExcellenceRate AS (     SELECT         cds,         (NumGE1500 * 1.0 / NULLIF(NumTstTakr, 0)) AS excellence_rate     FROM satscores     WHERE NumTstTakr > 0     ORDER BY excellence_rate ASC     LIMIT 1 ) SELECT s.Street, s.City, s.Zip, s.State FROM schools s JOIN satscores ss ON s.CDSCode = ss.cds JOIN MinExcellenceRate mer ON ss.cds = mer.cds; 
SELECT schools.Website  FROM schools JOIN satscores ON schools.CDSCode = satscores.cds WHERE schools.County = 'Los Angeles'    AND satscores.NumTstTakr BETWEEN 2000 AND 3000; 
SELECT AVG(satscores.NumTstTakr) AS AvgTestTakers FROM satscores JOIN schools ON satscores.cds = schools.CDSCode WHERE schools.County = 'Fresno' AND schools.OpenDate BETWEEN '1980-01-01' AND '1980-12-31'; 
SELECT s.Phone  FROM schools s JOIN satscores ss ON s.CDSCode = ss.cds WHERE s.District = 'Fresno Unified'  ORDER BY ss.AvgScrRead ASC  LIMIT 1; 
WITH ranked_scores AS (     SELECT          sc.cds AS CDSCode,          s.School AS VirtualSchoolName,         s.County,          sc.AvgScrRead,          RANK() OVER (PARTITION BY s.County ORDER BY sc.AvgScrRead DESC) AS rank     FROM satscores sc     JOIN schools s ON sc.cds = s.CDSCode     WHERE s.Virtual = 'F' ) SELECT      r.VirtualSchoolName,      r.County,      r.AvgScrRead FROM ranked_scores r WHERE r.rank <= 5 ORDER BY r.County, r.AvgScrRead DESC; 
SELECT s.EdOpsName  FROM schools s JOIN satscores ss ON s.CDSCode = ss.cds WHERE ss.AvgScrMath = (SELECT MAX(AvgScrMath) FROM satscores); 
WITH LowestScoringSchools AS (     SELECT cds, (AvgScrMath + AvgScrRead + AvgScrWrite) AS TotalScore     FROM satscores     WHERE (AvgScrMath + AvgScrRead + AvgScrWrite) = (         SELECT MIN(AvgScrMath + AvgScrRead + AvgScrWrite)         FROM satscores     ) ) SELECT s.County AS County, ss.AvgScrMath AS AvgMathScore FROM satscores AS ss JOIN LowestScoringSchools AS lss ON ss.cds = lss.cds JOIN schools AS s ON ss.cds = s.CDSCode; 
SELECT sc.City, sa.AvgScrWrite FROM satscores sa JOIN schools sc ON sa.cds = sc.CDSCode WHERE sa.NumTstTakr = (     SELECT MAX(NumTstTakr)     FROM satscores     WHERE NumGE1500 >= 1500 ) AND sa.NumGE1500 >= 1500 LIMIT 1; 
SELECT s.School, AVG(sa.AvgScrWrite) AS AvgWritingScore FROM schools s JOIN satscores sa ON s.CDSCode = sa.cds WHERE s.AdmFName1 = 'Ricci' AND s.AdmLName1 = 'Ulrich' GROUP BY s.School; 
SELECT s.School, s.District, s.County, f.`Enrollment (K-12)` FROM schools s JOIN frpm f ON s.CDSCode = f.CDSCode WHERE s.DOC = '31' ORDER BY f.`Enrollment (K-12)` DESC LIMIT 1; 
SELECT COUNT(CDSCode) * 1.0 / 12 AS MonthlyAverageOpenedSchools FROM schools WHERE County = 'Alameda'   AND DOC = 52   AND OpenDate IS NOT NULL   AND strftime('%Y', OpenDate) = '1980'; 
SELECT      (SELECT COUNT(*)       FROM schools       WHERE County = 'Orange' AND DOC = 54) /     (SELECT COUNT(*)       FROM schools       WHERE County = 'Orange' AND DOC = 52) AS Ratio; 
SELECT School, ClosedDate FROM schools WHERE StatusType = 'Closed' AND ClosedDate IS NOT NULL AND County = (     SELECT County     FROM schools     WHERE StatusType = 'Closed' AND ClosedDate IS NOT NULL     GROUP BY County     ORDER BY COUNT(*) DESC     LIMIT 1 ); 
SELECT s.School, s.Street AS PostalStreetAddress FROM satscores AS sat JOIN schools AS s ON sat.cds = s.CDSCode ORDER BY sat.AvgScrMath DESC LIMIT 1 OFFSET 6; 
SELECT sc.MailStreet, sc.School FROM satscores AS ss JOIN schools AS sc ON ss.cds = sc.CDSCode WHERE ss.AvgScrRead = (SELECT MIN(AvgScrRead) FROM satscores); 
SELECT COUNT(*) AS TotalSchools FROM satscores AS s JOIN schools AS sc ON s.cds = sc.CDSCode WHERE (s.AvgScrRead + s.AvgScrMath + s.AvgScrWrite) >= 1500 AND sc.MailCity = 'Lakeport'; 
SELECT SUM(satscores.NumTstTakr) AS TotalTestTakers FROM satscores JOIN schools ON satscores.cds = schools.CDSCode WHERE schools.MailCity = 'Fresno'; 
SELECT School, MailZip  FROM schools  WHERE AdmFName1 = 'Avetik' AND AdmLName1 = 'Atoian'; 
SELECT      (SELECT COUNT(*) FROM schools WHERE MailState = 'CA' AND County = 'Colusa') /      (SELECT COUNT(*) FROM schools WHERE MailState = 'CA' AND County = 'Humboldt') AS ratio; 
SELECT COUNT(*)  FROM schools  WHERE MailState = 'California' AND StatusType = 'Active' AND City = 'San Joaquin'; 
SELECT s.Phone, s.Ext  FROM schools s JOIN satscores ss ON s.CDSCode = ss.cds ORDER BY ss.AvgScrWrite DESC LIMIT 1 OFFSET 332; 
SELECT School, Phone, Ext FROM schools WHERE Zip = '95203-3704'; 
SELECT Website  FROM schools  WHERE (AdmFName1 = 'Mike' AND AdmLName1 = 'Larson')     OR (AdmFName2 = 'Mike' AND AdmLName2 = 'Larson')     OR (AdmFName3 = 'Mike' AND AdmLName3 = 'Larson')     OR (AdmFName1 = 'Dante' AND AdmLName1 = 'Alvarez')     OR (AdmFName2 = 'Dante' AND AdmLName2 = 'Alvarez')     OR (AdmFName3 = 'Dante' AND AdmLName3 = 'Alvarez'); 
SELECT Website  FROM schools  WHERE Virtual = 'P' AND Charter = 1 AND County = 'San Joaquin'; 
SELECT COUNT(*)  FROM schools  WHERE City = 'Hickman' AND DOC = '52' AND Charter = 1; 
SELECT COUNT(*) AS TotalNonCharteredSchools FROM schools s JOIN frpm f ON s.CDSCode = f.CDSCode WHERE s.County = 'Los Angeles'   AND s.Charter = 0   AND (f.`Free Meal Count (K-12)` * 100 / f.`Enrollment (K-12)`) < 0.18; 
SELECT s.School AS SchoolName, s.City, s.AdmFName1 || ' ' || s.AdmLName1 AS Admin1, s.AdmFName2 || ' ' || s.AdmLName2 AS Admin2, s.AdmFName3 || ' ' || s.AdmLName3 AS Admin3 FROM schools s WHERE s.Charter = 1 AND s.CharterNum = '00D2'; 
SELECT COUNT(*) FROM schools WHERE MailCity = 'Hickman' AND CharterNum = '00D4'; 
SELECT      (COUNT(CASE WHEN "Charter Funding Type" = 'Locally Funded' THEN 1 END) * 100.0 / COUNT("Charter Funding Type")) AS Ratio_Percentage FROM frpm WHERE "County Name" = 'Santa Clara'; 
SELECT COUNT(*) AS Directly_Funded_Schools_Opened FROM schools WHERE County = 'Stanislaus'    AND FundingType = 'Directly Funded'    AND OpenDate BETWEEN '2000-01-01' AND '2005-12-31'; 
SELECT COUNT(*) AS Total_Closures FROM schools WHERE DOCType = 'Community College District' AND ClosedDate LIKE '1989%' AND City = 'San Francisco'; 
SELECT County, COUNT(*) AS NumSchoolClosures FROM schools WHERE SOC = '11' AND ClosedDate BETWEEN '1980-01-01' AND '1989-12-31' GROUP BY County ORDER BY NumSchoolClosures DESC LIMIT 1; 
SELECT NCESDist  FROM schools  WHERE SOC = 31; 
SELECT      SUM(CASE WHEN StatusType = 'Active' THEN 1 ELSE 0 END) AS ActiveSchools,     SUM(CASE WHEN StatusType = 'Closed' THEN 1 ELSE 0 END) AS ClosedSchools FROM schools WHERE County = 'Alpine' AND DOCType = 'District Community Day School'; 
SELECT District Code  FROM schools  WHERE Magnet = 0 AND City = 'Fresno'; 
SELECT SUM(`Enrollment (Ages 5-17)`) AS Total_Enrollment FROM frpm JOIN schools ON frpm.CDSCode = schools.CDSCode WHERE schools.City = 'Fremont'    AND frpm.`Academic Year` = '2014-2015'    AND schools.EdOpsCode = 'SSS'; 
SELECT f.`FRPM Count (Ages 5-17)`  FROM frpm f JOIN schools s ON f.CDSCode = s.CDSCode WHERE s.EdOpsName = 'Youth Authority School' AND s.MailStreet = 'PO Box 1040'; 
SELECT f.`Low Grade` FROM `frpm` AS f JOIN `schools` AS s ON f.`CDSCode` = s.`CDSCode` WHERE s.`EdOpsCode` = 'SPECON' AND s.`NCESDist` = '0613360'; 
SELECT s.EdOpsName, s.School  FROM schools s JOIN frpm f ON s.CDSCode = f.CDSCode WHERE f.`NSLP Provision Status` = 'Provision 2' AND f.`County Code` = '37'; 
SELECT s.City  FROM schools s JOIN frpm f ON s.CDSCode = f.CDSCode WHERE f."Low Grade" = '9'    AND f."High Grade" = '12'    AND f."NSLP Provision Status" = 'Provision 2'    AND s.County = 'Merced'   AND s.EILCode = 'HS'; 
SELECT s.School, (f.`FRPM Count (Ages 5-17)` / f.`Enrollment (Ages 5-17)` * 100) AS `Percent (%) Eligible FRPM (Ages 5-17)` FROM schools s JOIN frpm f ON s.CDSCode = f.CDSCode WHERE s.County = 'Los Angeles' AND f.`Low Grade` = 'K' AND f.`High Grade` = '9'; 
SELECT GSserved, COUNT(GSserved) AS count FROM schools WHERE LOWER(TRIM(City)) = 'adelanto' AND GSserved IS NOT NULL AND GSserved != '' GROUP BY GSserved ORDER BY count DESC LIMIT 1; 
SELECT County, COUNT(*) AS NumberOfSchools FROM schools WHERE County IN ('San Diego', 'Santa Barbara') AND Virtual = 'F' GROUP BY County ORDER BY NumberOfSchools DESC LIMIT 1; 
SELECT s.School, f.SchoolType, s.Latitude FROM schools s JOIN frpm f ON s.CDSCode = f.CDSCode WHERE s.Latitude = (SELECT MAX(Latitude) FROM schools); 
SELECT s.School AS School_Name, s.City AS City, f.`Low Grade` FROM schools s JOIN frpm f ON s.CDSCode = f.CDSCode WHERE s.State = 'CA' ORDER BY s.Latitude ASC LIMIT 1; 
SELECT GSoffered  FROM schools  WHERE ABS(Longitude) = (SELECT MAX(ABS(Longitude)) FROM schools); 
WITH MagnetSchools AS (     SELECT          COUNT(*) AS TotalSchools     FROM          schools s     JOIN          frpm f ON s.CDSCode = f.CDSCode     WHERE          s.Magnet = 1          AND f.`Low Grade` = 'K'          AND f.`High Grade` = '8'          AND f.`NSLP Provision Status` = 'Multiple Provision Types' ), CitySchools AS (     SELECT          s.City AS Metric,          COUNT(s.CDSCode) AS Value     FROM          schools s     JOIN          frpm f ON s.CDSCode = f.CDSCode     WHERE          f.`Low Grade` = 'K'          AND f.`High Grade` = '8'     GROUP BY          s.City ) SELECT      'Total Schools Offering Multiple Provision Types' AS Metric,      TotalSchools AS Value FROM      MagnetSchools UNION ALL SELECT      Metric,      Value FROM      CitySchools; 
SELECT AdmFName1 AS FirstName, District, COUNT(AdmFName1) AS NameCount FROM schools WHERE AdmFName1 IS NOT NULL GROUP BY AdmFName1, District ORDER BY NameCount DESC LIMIT 2; 
SELECT s.District, f.`Percent (%) Eligible Free (K-12)`  FROM schools s  JOIN frpm f ON s.CDSCode = f.CDSCode  WHERE s.AdmFName1 = 'Alusine'; 
SELECT sc."AdmLName1", sc."District", sc."County", sc."School" FROM schools sc JOIN frpm f ON sc."CDSCode" = f."CDSCode" WHERE f."Charter School Number" = '40'; 
SELECT AdmEmail1, AdmEmail2, AdmEmail3  FROM schools  WHERE County = 'San Bernardino'    AND District = 'San Bernardino City Unified'    AND OpenDate BETWEEN '2009-01-01' AND '2010-12-31'    AND ((SOC = '62' AND DOC = '54')); 
SELECT sc.School, sc.AdmEmail1 FROM satscores ss JOIN schools sc ON ss.cds = sc.CDSCode WHERE ss.NumGE1500 = (SELECT MAX(NumGE1500) FROM satscores); 
SELECT COUNT(DISTINCT a.account_id) AS account_count FROM account a JOIN district d ON a.district_id = d.district_id WHERE a.frequency = 'POPLATEK PO OBRATU' AND d.A3 = 'East Bohemia'; 
SELECT COUNT(DISTINCT account.account_id) AS eligible_accounts FROM account JOIN district ON account.district_id = district.district_id JOIN loan ON account.account_id = loan.account_id WHERE district.A3 = 'Prague'; 
SELECT      CASE          WHEN AVG(A12) > AVG(A13) THEN '1995'         ELSE '1996'     END AS higher_unemployment_year,     CASE          WHEN AVG(A12) > AVG(A13) THEN AVG(A12)         ELSE AVG(A13)     END AS higher_unemployment_rate FROM      district; 
SELECT COUNT(*) AS number_of_districts FROM district d JOIN client c ON d.district_id = c.district_id WHERE c.gender = 'F' AND d.A11 > 6000 AND d.A11 < 10000; 
SELECT COUNT(DISTINCT c.client_id) AS male_customers_count FROM client c JOIN district d ON c.district_id = d.district_id WHERE c.gender = 'M' AND d.A3 = 'North Bohemia' AND d.A11 > 8000; 
WITH FemaleClients AS (     SELECT c.client_id, c.district_id, c.birth_date, d.A11 AS avg_salary     FROM client c     JOIN district d ON c.district_id = d.district_id     WHERE c.gender = 'F' ), OldestFemaleClient AS (     SELECT client_id, district_id, MIN(birth_date) AS oldest_birth_date, avg_salary     FROM FemaleClients     GROUP BY client_id, district_id, avg_salary     HAVING avg_salary = (SELECT MIN(avg_salary) FROM FemaleClients) ), SalaryGap AS (     SELECT          (SELECT MAX(A11) FROM district) - (SELECT MIN(A11) FROM district) AS salary_gap ) SELECT a.account_id, sg.salary_gap FROM account a JOIN disp d ON a.account_id = d.account_id JOIN OldestFemaleClient ofc ON d.client_id = ofc.client_id JOIN SalaryGap sg ON 1=1; 
SELECT DISTINCT a.account_id FROM account a JOIN disp d ON a.account_id = d.account_id JOIN client c ON d.client_id = c.client_id WHERE c.birth_date = (SELECT MAX(birth_date) FROM client)   AND c.district_id = (SELECT district_id FROM district WHERE A11 = (SELECT MAX(A11) FROM district))   AND d.type = 'OWNER'; 
SELECT COUNT(DISTINCT client.client_id) AS total_customers FROM client JOIN disp ON client.client_id = disp.client_id JOIN account ON disp.account_id = account.account_id WHERE account.frequency = 'POPLATEK TYDNE' AND disp.type = 'OWNER'; 
SELECT DISTINCT c.client_id FROM client c JOIN disp d ON c.client_id = d.client_id JOIN account a ON d.account_id = a.account_id WHERE d.type = 'DISPONENT' AND a.frequency = 'POPLATEK PO OBRATU'; 
SELECT a.account_id, a.frequency, l.amount, l.date  FROM account a JOIN loan l ON a.account_id = l.account_id WHERE l.status = 'A'    AND l.date BETWEEN '1997-01-01' AND '1997-12-31'   AND l.amount = (       SELECT MIN(amount)        FROM loan        WHERE status = 'A' AND date BETWEEN '1997-01-01' AND '1997-12-31'   )   AND a.frequency = 'POPLATEK MESICNE'; 
SELECT      a.account_id,      l.amount,      a.date  FROM      account a  JOIN      loan l  ON      a.account_id = l.account_id  WHERE      l.duration > 12      AND a.date BETWEEN '1993-01-01' AND '1993-12-31'     AND l.amount = (         SELECT MAX(l2.amount)         FROM loan l2         WHERE l2.duration > 12     ) ORDER BY      a.account_id; 
SELECT COUNT(DISTINCT c.client_id) AS female_customers_count FROM client c JOIN district d ON c.district_id = d.district_id JOIN disp dp ON c.client_id = dp.client_id JOIN account a ON dp.account_id = a.account_id WHERE c.gender = 'F'    AND c.birth_date < '1950-01-01'   AND d.A2 = 'Sokolov'; 
SELECT account_id, date AS earliest_date FROM account WHERE date = (     SELECT MIN(date)      FROM account     WHERE date BETWEEN '1995-01-01' AND '1995-12-31' ); 
SELECT DISTINCT a.account_id FROM account a LEFT JOIN (     SELECT account_id, SUM(amount) AS total_balance     FROM trans     GROUP BY account_id ) t ON a.account_id = t.account_id WHERE a.date < '1997-01-01' AND t.total_balance > 3000; 
SELECT c.client_id FROM client c JOIN disp d ON c.client_id = d.client_id JOIN card ca ON d.disp_id = ca.disp_id WHERE ca.issued = '1994-03-03'; 
SELECT a.date AS account_open_date FROM trans t JOIN account a ON t.account_id = a.account_id WHERE t.amount = 840 AND t.date = '1998-10-14'; 
SELECT a.district_id  FROM loan l JOIN account a ON l.account_id = a.account_id WHERE l.date = '1994-01-05'; 
SELECT MAX(t.amount) AS max_transaction_amount FROM trans t JOIN account a ON t.account_id = a.account_id JOIN disp d ON a.account_id = d.account_id JOIN card c ON d.disp_id = c.disp_id WHERE c.issued = '1996-10-21'; 
SELECT c.gender FROM client c JOIN disp d ON c.client_id = d.client_id JOIN account a ON d.account_id = a.account_id JOIN district dist ON a.district_id = dist.district_id WHERE dist.A11 = (SELECT MAX(A11) FROM district)   AND d.type = 'OWNER' ORDER BY c.birth_date ASC LIMIT 1; 
SELECT t.amount FROM trans t JOIN account a ON t.account_id = a.account_id WHERE t.account_id IN (   SELECT account_id   FROM loan   WHERE amount = (SELECT MAX(amount) FROM loan) )   AND t.date >= a.date ORDER BY t.date ASC LIMIT 1; 
SELECT COUNT(DISTINCT c.client_id) AS female_clients_count FROM client c JOIN district d ON c.district_id = d.district_id JOIN account a ON c.district_id = a.district_id WHERE d.A2 = 'Jesenik' AND c.gender = 'F'; 
SELECT disp.disp_id FROM trans JOIN account ON trans.account_id = account.account_id JOIN disp ON account.account_id = disp.account_id WHERE trans.amount = 1000   AND trans.date = '1995-03-24'; 
SELECT COUNT(a.account_id) AS number_of_accounts FROM account a JOIN district d ON a.district_id = d.district_id WHERE LOWER(d.A2) = 'litomerice'    AND a.date BETWEEN '1996-01-01' AND '1996-12-31'; 
SELECT d.A2  FROM client c JOIN account a ON c.client_id = a.account_id JOIN district d ON c.district_id = d.district_id WHERE c.gender = 'F' AND c.birth_date = '1976-01-29'; 
SELECT c.birth_date FROM loan l JOIN account a ON l.account_id = a.account_id JOIN disp d ON a.account_id = d.account_id JOIN client c ON d.client_id = c.client_id WHERE l.amount = 80952 AND l.date = '1994-01-05'; 
SELECT a.account_id FROM account a JOIN disp dp ON a.account_id = dp.account_id JOIN client c ON dp.client_id = c.client_id JOIN district d ON c.district_id = d.district_id WHERE LOWER(TRIM(d.A3)) = 'prague' ORDER BY a.date ASC, a.account_id ASC LIMIT 1; 
WITH max_inhabitants AS (     SELECT MAX(CAST(A4 AS INTEGER)) AS max_A4     FROM district     WHERE A3 = 'south Bohemia' AND A4 REGEXP '^[0-9]+$' ) SELECT      (CASE          WHEN COUNT(c.client_id) = 0 THEN 0          ELSE (CAST(SUM(CASE WHEN c.gender = 'M' THEN 1 ELSE 0 END) AS FLOAT) / COUNT(c.client_id)) * 100      END) AS male_percentage FROM      client c INNER JOIN      district d ON c.district_id = d.district_id WHERE      d.A3 = 'south Bohemia'      AND CAST(d.A4 AS INTEGER) = (SELECT max_A4 FROM max_inhabitants); 
WITH loan_account AS (     SELECT account_id     FROM loan     WHERE date = '1993-07-05'     ORDER BY date ASC     LIMIT 1 ), balance_data AS (     SELECT          MAX(CASE WHEN date <= '1998-12-27' THEN balance ELSE NULL END) AS balance_at_end,         MIN(CASE WHEN date >= '1993-03-22' THEN balance ELSE NULL END) AS balance_at_start     FROM trans     WHERE account_id = (SELECT account_id FROM loan_account) ) SELECT      CASE          WHEN balance_at_start IS NOT NULL AND balance_at_end IS NOT NULL THEN             ((balance_at_end - balance_at_start) * 100.0 / balance_at_start)         ELSE NULL     END AS increase_rate FROM balance_data; 
SELECT      (SUM(CASE WHEN status = 'A' THEN amount ELSE 0 END) * 100.0 / SUM(amount)) AS percentage_fully_paid FROM      loan; 
SELECT      (COUNT(CASE WHEN l.status = 'C' THEN 1 END) * 100.0 / COUNT(*)) AS percentage_of_accounts  FROM      loan l  WHERE      l.amount < 100000; 
SELECT      account.account_id,      district.A2 AS district_name,      district.A3 AS district_region FROM      account JOIN      district ON account.district_id = district.district_id WHERE      account.date LIKE '1993%'      AND account.frequency = 'POPLATEK PO OBRATU'; 
SELECT a.account_id, a.frequency FROM account a JOIN disp d ON a.account_id = d.account_id JOIN client c ON d.client_id = c.client_id JOIN district di ON c.district_id = di.district_id WHERE di.A2 = 'east Bohemia'   AND d.type = 'OWNER'   AND a.date BETWEEN '1995-01-01' AND '2000-12-31'; 
SELECT account.account_id, account.date FROM account JOIN disp ON account.account_id = disp.account_id JOIN client ON disp.client_id = client.client_id JOIN district ON client.district_id = district.district_id WHERE TRIM(LOWER(district.A2)) = 'prachatice'; 
SELECT d.A2 AS district, d.A3 AS region FROM loan l JOIN account a ON l.account_id = a.account_id JOIN district d ON a.district_id = d.district_id WHERE l.loan_id = 4990; 
SELECT l.account_id, d.A2 AS district, d.A3 AS region FROM loan l JOIN account a ON l.account_id = a.account_id JOIN district d ON a.district_id = d.district_id WHERE l.amount > 300000; 
SELECT      loan.loan_id,      district.A3 AS district,      district.A11 AS average_salary FROM      loan JOIN      account ON loan.account_id = account.account_id JOIN      district ON account.district_id = district.district_id WHERE      loan.duration = 60; 
SELECT      d.A3 AS district_name,      d.A4 AS state,      ((d.A13 - d.A12) / d.A12) * 100 AS unemployment_rate_increment_percentage FROM      loan l JOIN      account a ON l.account_id = a.account_id JOIN      district d ON a.district_id = d.district_id WHERE      l.status = 'D'      AND d.A12 IS NOT NULL      AND d.A13 IS NOT NULL      AND d.A12 <> 0      AND DATE(l.date, '+' || l.duration || ' months') >= DATE('now'); 
SELECT      (SELECT COUNT(*)       FROM account a1      JOIN district d1 ON a1.district_id = d1.district_id      WHERE d1.A2 = 'Decin' AND strftime('%Y', a1.date) = '1993') * 100.0 /     (SELECT COUNT(*)       FROM account       WHERE strftime('%Y', date) = '1993') AS percentage; 
SELECT account_id  FROM account  WHERE frequency = 'POPLATEK MESICNE'; 
SELECT d.A2 AS district_name, COUNT(c.client_id) AS female_account_holders_count FROM client c JOIN account a ON c.district_id = a.district_id JOIN district d ON a.district_id = d.district_id WHERE c.gender = 'F' GROUP BY d.A2 ORDER BY female_account_holders_count DESC LIMIT 9; 
SELECT d.A2 AS district_name, t.amount FROM trans t INNER JOIN account a ON t.account_id = a.account_id INNER JOIN district d ON a.district_id = d.district_id WHERE t.type = 'VYDAJ'    AND t.date LIKE '1996-01%' ORDER BY t.amount DESC LIMIT 10; 
SELECT COUNT(DISTINCT a.account_id) AS account_holders_without_cards FROM account a JOIN district d ON a.district_id = d.district_id LEFT JOIN disp di ON a.account_id = di.account_id LEFT JOIN card c ON di.disp_id = c.disp_id WHERE d.A3 = 'South Bohemia' AND c.card_id IS NULL; 
SELECT d.A3 AS district_name, COUNT(l.loan_id) AS active_loans_count FROM loan l JOIN account a ON l.account_id = a.account_id JOIN district d ON a.district_id = d.district_id WHERE l.status IN ('C', 'D') GROUP BY d.district_id, d.A3 ORDER BY active_loans_count DESC LIMIT 1; 
SELECT AVG(loan.amount) AS average_loan_amount FROM loan JOIN account ON loan.account_id = account.account_id JOIN disp ON account.account_id = disp.account_id JOIN client ON disp.client_id = client.client_id WHERE client.gender = 'M'; 
SELECT A3 AS branch_location, A2 AS district_name, A13 AS unemployment_rate_1996 FROM district WHERE A13 = (SELECT MAX(A13) FROM district); 
WITH max_crime_district AS (     SELECT district_id     FROM district     WHERE A16 = (SELECT MAX(A16) FROM district)     LIMIT 1 ) SELECT COUNT(a.account_id) AS num_accounts_opened FROM account a JOIN max_crime_district mcd ON a.district_id = mcd.district_id WHERE a.date BETWEEN '1996-01-01' AND '1996-12-31'; 
SELECT COUNT(DISTINCT t.account_id) AS num_accounts FROM trans t JOIN account a ON t.account_id = a.account_id WHERE t.operation = 'VYBER KARTOU' AND t.balance < 0 AND a.frequency = 'POPLATEK MESICNE'; 
SELECT COUNT(*) AS approved_loans_count FROM loan l JOIN account a ON l.account_id = a.account_id WHERE l.date BETWEEN '1995-01-01' AND '1997-12-31'   AND l.amount >= 250000   AND a.frequency = 'POPLATEK MESICNE'; 
SELECT COUNT(DISTINCT a.account_id) AS running_contract_accounts FROM account a JOIN loan l ON a.account_id = l.account_id WHERE l.status IN ('C', 'D') AND a.district_id = 1; 
SELECT COUNT(DISTINCT c.client_id) AS male_clients_count FROM client c JOIN district d ON c.district_id = d.district_id WHERE c.gender = 'M'  AND d.district_id = (     SELECT district_id      FROM district      WHERE A15 = (         SELECT MAX(A15)          FROM district          WHERE A15 < (SELECT MAX(A15) FROM district)     ) ); 
SELECT COUNT(*) FROM card c JOIN disp d ON c.disp_id = d.disp_id WHERE c.type = 'gold' AND d.type = 'OWNER'; 
SELECT COUNT(*) AS total_accounts FROM account a JOIN district d ON a.district_id = d.district_id WHERE d.A2 = 'Pisek'; 
SELECT DISTINCT d.* FROM district d JOIN account a ON d.district_id = a.district_id JOIN trans t ON a.account_id = t.account_id WHERE t.amount > 10000   AND t.date BETWEEN '1997-01-01' AND '1997-12-31'; 
SELECT DISTINCT a.account_id FROM account a JOIN `order` o ON a.account_id = o.account_id JOIN district d ON a.district_id = d.district_id WHERE o.k_symbol = 'SIPO' AND d.A2 = 'Pisek'; 
SELECT DISTINCT a.account_id FROM account a JOIN disp d ON a.account_id = d.account_id JOIN card c ON d.disp_id = c.disp_id WHERE c.type = 'gold'; 
SELECT AVG(t.amount) AS average_amount FROM trans t WHERE t.operation = 'VYBER KARTOU'    AND strftime('%Y', t.date) = '2021'; 
WITH AvgAmountCTE AS (     SELECT AVG(amount) AS avg_amount     FROM trans     WHERE operation = 'VYBER KARTOU'       AND date BETWEEN '1998-01-01' AND '1998-12-31' ) SELECT DISTINCT d.client_id FROM trans t JOIN account a ON t.account_id = a.account_id JOIN disp d ON a.account_id = d.account_id JOIN AvgAmountCTE avg ON 1 = 1 WHERE t.operation = 'VYBER KARTOU'   AND t.date BETWEEN '1998-01-01' AND '1998-12-31'   AND t.amount < avg.avg_amount   AND d.type = 'OWNER'; 
SELECT DISTINCT c.client_id, c.gender, c.birth_date FROM client c JOIN disp d ON c.client_id = d.client_id JOIN account a ON d.account_id = a.account_id JOIN card cd ON d.disp_id = cd.disp_id JOIN loan l ON a.account_id = l.account_id WHERE c.gender = 'F' AND d.type = 'OWNER'; 
SELECT COUNT(DISTINCT a.account_id) AS female_accounts_in_south_bohemia FROM client c JOIN district d ON c.district_id = d.district_id JOIN disp dp ON c.client_id = dp.client_id JOIN account a ON dp.account_id = a.account_id WHERE c.gender = 'F' AND d.A3 = 'South Bohemia'; 
SELECT a.* FROM account a JOIN district d ON a.district_id = d.district_id JOIN disp dp ON a.account_id = dp.account_id WHERE d.A2 = 'Tabor' AND dp.type = 'OWNER'; 
SELECT DISTINCT a.frequency FROM account a JOIN district d ON a.district_id = d.district_id JOIN disp dp ON a.account_id = dp.account_id WHERE d.A11 > 8000 AND d.A11 <= 9000   AND dp.type != 'OWNER'; 
SELECT COUNT(DISTINCT a.account_id) AS account_count FROM account a JOIN district d ON a.district_id = d.district_id JOIN trans t ON a.account_id = t.account_id WHERE d.A3 = 'North Bohemia' AND t.bank = 'AB'; 
SELECT DISTINCT district.A2  FROM district JOIN account ON district.district_id = account.district_id JOIN trans ON account.account_id = trans.account_id WHERE trans.type = 'VYDAJ'; 
SELECT AVG(d.A15) AS avg_crimes_1995 FROM district d WHERE d.A15 > 4000   AND d.district_id IN (       SELECT a.district_id       FROM account a       WHERE a.date >= '1997-01-01'   ); 
SELECT COUNT(*) AS classic_cards_eligible_for_loan FROM card JOIN disp ON card.disp_id = disp.disp_id WHERE card.type = 'classic' AND disp.type = 'OWNER'; 
SELECT COUNT(*) AS male_clients_count FROM client c JOIN district d ON c.district_id = d.district_id WHERE c.gender = 'M' AND d.A2 = 'Hl.m. Praha'; 
SELECT      (CAST(SUM(CASE WHEN type = 'gold' AND issued < '1998-01-01' THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)) * 100 AS percent_of_gold_cards_issued_prior_1998 FROM card; 
SELECT c.client_id, c.gender, c.birth_date, c.district_id FROM client c JOIN disp d ON c.client_id = d.client_id JOIN loan l ON d.account_id = l.account_id WHERE l.amount = (SELECT MAX(amount) FROM loan)   AND d.type = 'OWNER'; 
SELECT A15  FROM district  WHERE district_id = (SELECT district_id FROM account WHERE account_id = 532); 
SELECT a.district_id FROM `order` o JOIN `account` a ON o.account_id = a.account_id WHERE o.order_id = 33333; 
SELECT t.* FROM trans t JOIN account a ON t.account_id = a.account_id JOIN disp d ON a.account_id = d.account_id WHERE d.client_id = 3356 AND t.operation = 'VYBER'; 
SELECT COUNT(DISTINCT account.account_id) AS weekly_loan_count FROM account JOIN loan ON account.account_id = loan.account_id WHERE account.frequency = 'POPLATEK TYDNE' AND loan.amount < 200000; 
SELECT card.type  FROM card JOIN disp ON card.disp_id = disp.disp_id WHERE disp.client_id = 13539; 
SELECT d.A3 AS region FROM client c JOIN district d ON c.district_id = d.district_id WHERE c.client_id = 3541; 
SELECT d.A3 AS district_name, COUNT(*) AS account_count FROM loan l JOIN account a ON l.account_id = a.account_id JOIN district d ON a.district_id = d.district_id WHERE l.status = 'A' GROUP BY d.district_id, d.A3 ORDER BY account_count DESC LIMIT 1; 
SELECT client.*  FROM `order` JOIN `account` ON `order`.account_id = `account`.account_id JOIN `disp` ON `account`.account_id = `disp`.account_id JOIN `client` ON `disp`.client_id = `client`.client_id WHERE `order`.order_id = 32423; 
SELECT t.* FROM trans t JOIN account a ON t.account_id = a.account_id WHERE a.district_id = 5; 
SELECT COUNT(*) AS account_count FROM account a JOIN district d ON a.district_id = d.district_id WHERE d.A3 = 'Jesenik'; 
SELECT DISTINCT c.client_id FROM client c JOIN disp d ON c.client_id = d.client_id JOIN card ca ON d.disp_id = ca.disp_id WHERE ca.type = 'junior' AND ca.issued >= '1997-01-01'; 
SELECT      (COUNT(DISTINCT CASE WHEN c.gender = 'F' THEN c.client_id END) * 100.0 / COUNT(DISTINCT c.client_id)) AS female_percentage FROM client c JOIN disp dsp ON c.client_id = dsp.client_id JOIN account a ON dsp.account_id = a.account_id JOIN district dist ON a.district_id = dist.district_id WHERE dist.A11 > 10000   AND dsp.type = 'OWNER'; 
SELECT      CASE          WHEN SUM(CASE WHEN strftime('%Y', l.date) = '1996' THEN l.amount ELSE 0 END) > 0 THEN             ((SUM(CASE WHEN strftime('%Y', l.date) = '1997' THEN l.amount ELSE 0 END) -                SUM(CASE WHEN strftime('%Y', l.date) = '1996' THEN l.amount ELSE 0 END)) * 1.0 /                SUM(CASE WHEN strftime('%Y', l.date) = '1996' THEN l.amount ELSE 0 END)) * 100         ELSE NULL     END AS growth_rate FROM loan l JOIN account a ON l.account_id = a.account_id JOIN disp d ON a.account_id = d.account_id JOIN client c ON d.client_id = c.client_id WHERE c.gender = 'M' AND l.date IS NOT NULL AND l.amount > 0; 
SELECT COUNT(*)  FROM trans  WHERE operation = 'VYBER KARTOU' AND date > '1995-12-31'; 
SELECT      ABS(         (SELECT SUM(A16)           FROM district           WHERE A3 = 'North Bohemia') -          (SELECT SUM(A16)           FROM district           WHERE A3 = 'East Bohemia')     ) AS crime_difference; 
SELECT type, COUNT(*) AS total_count  FROM disp  WHERE account_id BETWEEN 1 AND 10  GROUP BY type; 
SELECT frequency AS account_statement_frequency FROM account WHERE account_id = 3;  SELECT k_symbol AS purpose_of_debiting_3539 FROM `order` WHERE account_id = 3 AND amount = 3539; 
SELECT strftime('%Y', c.birth_date) AS birth_year FROM client c JOIN disp d ON c.client_id = d.client_id WHERE d.type = 'OWNER' AND d.account_id = 130; 
SELECT COUNT(DISTINCT a.account_id) AS account_count FROM account a JOIN disp d ON a.account_id = d.account_id WHERE d.type = 'OWNER' AND a.frequency = 'POPLATEK PO OBRATU'; 
SELECT l.amount AS debt_amount, l.status AS payment_status FROM client c JOIN disp d ON c.client_id = d.client_id JOIN loan l ON d.account_id = l.account_id WHERE c.client_id = 992; 
SELECT      t.balance AS total_balance,      c.gender FROM      trans t JOIN      account a ON t.account_id = a.account_id JOIN      disp d ON a.account_id = d.account_id JOIN      client c ON d.client_id = c.client_id WHERE      d.type = 'OWNER'      AND a.account_id = 3      AND t.trans_id > 851 ORDER BY      t.trans_id ASC LIMIT 1; 
SELECT card.type  FROM card JOIN disp ON card.disp_id = disp.disp_id WHERE disp.client_id = 9; 
SELECT      COALESCE(SUM(t.amount), 0) AS total_amount_paid FROM      trans t JOIN      account a ON t.account_id = a.account_id JOIN      disp d ON a.account_id = d.account_id WHERE      d.client_id = 617      AND t.date BETWEEN '1998-01-01' AND '1998-12-31'     AND t.type = 'VYDAJ'     AND EXISTS (SELECT 1 FROM client WHERE client_id = 617); 
SELECT c.client_id, c.gender, c.birth_date  FROM client c JOIN district d ON c.district_id = d.district_id WHERE c.birth_date BETWEEN '1983-01-01' AND '1987-12-31'   AND d.A2 = 'East Bohemia'; 
SELECT c.client_id FROM client c JOIN disp d ON c.client_id = d.client_id JOIN loan l ON d.account_id = l.account_id WHERE c.gender = 'F' ORDER BY l.amount DESC LIMIT 3; 
SELECT COUNT(DISTINCT c.client_id) AS male_customers_count FROM client c JOIN disp d ON c.client_id = d.client_id JOIN `order` o ON d.account_id = o.account_id WHERE c.gender = 'M'    AND c.birth_date BETWEEN '1974-01-01' AND '1976-12-31'   AND o.k_symbol = 'SIPO'   AND o.amount > 4000; 
SELECT COUNT(a.account_id)  FROM account a JOIN district d ON a.district_id = d.district_id WHERE d.A2 = 'Beroun' AND a.date > '1996-12-31'; 
SELECT COUNT(DISTINCT client.client_id) AS female_customers_with_junior_card FROM client JOIN disp ON client.client_id = disp.client_id JOIN card ON disp.disp_id = card.disp_id WHERE client.gender = 'F' AND card.type = 'junior'; 
SELECT      (CAST(COUNT(DISTINCT c.client_id) AS FLOAT) /      (SELECT COUNT(DISTINCT c2.client_id)       FROM client c2       JOIN district d2 ON c2.district_id = d2.district_id      JOIN disp dp2 ON c2.client_id = dp2.client_id      JOIN account a2 ON dp2.account_id = a2.account_id      WHERE d2.A3 LIKE '%Prague%') * 100) AS female_percentage FROM client c JOIN district d ON c.district_id = d.district_id JOIN disp dp ON c.client_id = dp.client_id JOIN account a ON dp.account_id = a.account_id WHERE c.gender = 'F' AND d.A3 LIKE '%Prague%'; 
SELECT      (CAST(COUNT(DISTINCT c.client_id) AS FLOAT) /      (SELECT COUNT(DISTINCT c2.client_id)       FROM client c2      JOIN disp d2 ON c2.client_id = d2.client_id      JOIN account a2 ON d2.account_id = a2.account_id      WHERE a2.frequency = 'POPLATEK TYDNE') * 100) AS percentage_of_male_clients FROM client c JOIN disp d ON c.client_id = d.client_id JOIN account a ON d.account_id = a.account_id WHERE c.gender = 'M' AND a.frequency = 'POPLATEK TYDNE'; 
SELECT COUNT(DISTINCT client.client_id) AS total_clients FROM client JOIN disp ON client.client_id = disp.client_id JOIN account ON disp.account_id = account.account_id WHERE account.frequency = 'POPLATEK TYDNE' AND disp.type = 'OWNER'; 
SELECT l.account_id, l.amount AS lowest_amount FROM loan l JOIN account a ON l.account_id = a.account_id WHERE l.duration > 24   AND a.date < '1997-01-01' ORDER BY l.amount ASC LIMIT 1; 
SELECT a.account_id FROM account a JOIN disp d ON a.account_id = d.account_id JOIN client c ON d.client_id = c.client_id JOIN district di ON c.district_id = di.district_id WHERE c.gender = 'F'   AND di.A11 = (     SELECT MIN(di2.A11)     FROM client c2     JOIN district di2 ON c2.district_id = di2.district_id     WHERE c2.gender = 'F'   ) ORDER BY c.birth_date ASC LIMIT 1; 
SELECT COUNT(DISTINCT c.client_id) AS client_count FROM client c JOIN district d ON c.district_id = d.district_id WHERE c.birth_date BETWEEN '1920-01-01' AND '1920-12-31' AND d.A3 = 'east Bohemia'; 
SELECT COUNT(*) FROM loan l JOIN account a ON l.account_id = a.account_id WHERE l.duration = 24 AND a.frequency = 'POPLATEK TYDNE'; 
SELECT AVG(loan.amount) AS average_loan_amount FROM loan JOIN account ON loan.account_id = account.account_id WHERE loan.status IN ('C', 'D') AND account.frequency = 'POPLATEK PO OBRATU'; 
SELECT DISTINCT c.client_id, c.district_id FROM client c JOIN disp d ON c.client_id = d.client_id WHERE d.type = 'OWNER'; 
SELECT      client.client_id,      CAST(strftime('%Y', 'now') AS INTEGER) - CAST(strftime('%Y', client.birth_date) AS INTEGER) AS age FROM      client JOIN      disp ON client.client_id = disp.client_id JOIN      card ON disp.disp_id = card.disp_id WHERE      card.type = 'gold'      AND disp.type = 'OWNER'; 
SELECT b.bond_type, COUNT(b.bond_type) AS count FROM bond b JOIN connected c ON b.bond_id = c.bond_id GROUP BY b.bond_type ORDER BY count DESC LIMIT 1; 
SELECT COUNT(DISTINCT m.molecule_id) AS num_molecules_with_cl FROM molecule m JOIN atom a ON m.molecule_id = a.molecule_id WHERE m.label = '-'    AND a.element = 'cl'; 
SELECT AVG(oxygen_count) AS avg_oxygen_atoms FROM (     SELECT m.molecule_id, COUNT(DISTINCT a.atom_id) AS oxygen_count     FROM molecule m     JOIN bond b ON m.molecule_id = b.molecule_id     JOIN connected c ON b.bond_id = c.bond_id     JOIN atom a ON (c.atom_id = a.atom_id OR c.atom_id2 = a.atom_id)     WHERE b.bond_type = '-' AND a.element = 'o'     GROUP BY m.molecule_id ) AS molecule_oxygen_counts; 
SELECT AVG(single_bond_count) AS average_single_bonds FROM (     SELECT m.molecule_id, COUNT(b.bond_id) AS single_bond_count     FROM molecule m     JOIN bond b ON m.molecule_id = b.molecule_id     WHERE m.label = '+' AND b.bond_type = '-'     GROUP BY m.molecule_id ) AS subquery; 
SELECT COUNT(DISTINCT a.atom_id) AS non_carcinogenic_sodium_atoms FROM atom a JOIN molecule m ON a.molecule_id = m.molecule_id WHERE a.element = 'na' AND m.label = '-'; 
SELECT DISTINCT m.molecule_id FROM molecule m JOIN bond b ON m.molecule_id = b.molecule_id WHERE b.bond_type = '#' AND m.label = '+'; 
SELECT      (CAST(SUM(CASE WHEN a.element = 'c' THEN 1 ELSE 0 END) AS FLOAT) / COUNT(a.atom_id)) * 100 AS carbon_percentage FROM      molecule m JOIN      bond b ON m.molecule_id = b.molecule_id JOIN      connected c ON b.bond_id = c.bond_id JOIN      atom a ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2 WHERE      b.bond_type = '='; 
SELECT COUNT(*)  FROM bond  WHERE bond_type = '#'; 
SELECT COUNT(*)  FROM atom  WHERE element IS NULL OR element != 'br'; 
SELECT COUNT(*) AS carcinogenic_count FROM molecule WHERE molecule_id BETWEEN 'TR000' AND 'TR099' AND label = '+'; 
SELECT DISTINCT a.molecule_id FROM atom a JOIN molecule m ON a.molecule_id = m.molecule_id WHERE a.element = 'c'; 
SELECT a.element FROM connected c JOIN atom a ON c.atom_id = a.atom_id WHERE c.bond_id = 'TR004_8_9'; 
SELECT DISTINCT a.element FROM atom a JOIN connected c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2 JOIN bond b ON c.bond_id = b.bond_id WHERE b.bond_type = '='; 
SELECT m.label FROM molecule m LEFT JOIN (     SELECT a.molecule_id, COUNT(*) AS h_count     FROM atom a     WHERE a.element = 'h'     GROUP BY a.molecule_id ) h_atoms ON m.molecule_id = h_atoms.molecule_id ORDER BY COALESCE(h_atoms.h_count, 0) DESC LIMIT 1; 
SELECT DISTINCT b.bond_type FROM atom a JOIN connected c ON a.atom_id = c.atom_id JOIN bond b ON c.bond_id = b.bond_id WHERE a.element = 'cl'; 
SELECT c.atom_id, c.atom_id2 FROM connected c JOIN bond b ON c.bond_id = b.bond_id WHERE b.bond_type = '-'; 
SELECT c.atom_id, c.atom_id2 FROM connected c JOIN atom a1 ON c.atom_id = a1.atom_id JOIN atom a2 ON c.atom_id2 = a2.atom_id JOIN molecule m ON a1.molecule_id = m.molecule_id WHERE m.label = '-'; 
SELECT a.element, COUNT(a.element) AS element_count FROM atom a JOIN molecule m ON a.molecule_id = m.molecule_id WHERE m.label = '-' GROUP BY a.element HAVING COUNT(a.element) > 0 ORDER BY element_count ASC LIMIT 1; 
SELECT b.bond_type FROM connected c JOIN bond b ON c.bond_id = b.bond_id WHERE (c.atom_id = 'TR004_8' AND c.atom_id2 = 'TR004_20')     OR (c.atom_id = 'TR004_20' AND c.atom_id2 = 'TR004_8'); 
WITH tin_molecule_labels AS (     SELECT DISTINCT m.label     FROM molecule m     JOIN atom a ON m.molecule_id = a.molecule_id     WHERE a.element = 'sn' ) SELECT DISTINCT label FROM (SELECT '+' AS label UNION SELECT '-' AS label) all_labels WHERE NOT EXISTS (SELECT 1 FROM tin_molecule_labels)    OR label NOT IN (SELECT label FROM tin_molecule_labels); 
SELECT COUNT(DISTINCT a.atom_id) AS atom_count FROM atom a JOIN connected c ON a.atom_id = c.atom_id JOIN bond b ON c.bond_id = b.bond_id WHERE a.element IN ('i', 's') AND b.bond_type = '-'; 
SELECT c.atom_id, c.atom_id2 FROM connected c JOIN bond b ON c.bond_id = b.bond_id WHERE b.bond_type = '#'; 
SELECT DISTINCT a2.* FROM connected c JOIN atom a1 ON c.atom_id = a1.atom_id JOIN atom a2 ON c.atom_id2 = a2.atom_id WHERE a1.molecule_id = 'TR181'; 
WITH carcinogenic_molecules_with_fluorine AS (     SELECT DISTINCT m.molecule_id     FROM molecule m     JOIN atom a ON m.molecule_id = a.molecule_id     WHERE m.label = '+' AND a.element = 'f' ), carcinogenic_molecules AS (     SELECT DISTINCT molecule_id     FROM molecule     WHERE label = '+' ) SELECT      100.0 * COUNT(cm.molecule_id) / COUNT(DISTINCT carcinogenic_molecules.molecule_id) AS percentage_without_fluorine FROM carcinogenic_molecules cm LEFT JOIN carcinogenic_molecules_with_fluorine cmwf ON cm.molecule_id = cmwf.molecule_id WHERE cmwf.molecule_id IS NULL; 
SELECT      CASE          WHEN COUNT(b.bond_id) > 0 THEN              CAST(SUM(CASE WHEN b.bond_type = '#' THEN 1 ELSE 0 END) AS FLOAT) * 100              / COUNT(b.bond_id)         ELSE              0      END AS percent FROM      bond b JOIN      molecule m ON b.molecule_id = m.molecule_id WHERE      m.label = '+'     AND b.bond_type = '#'; 
SELECT element, COUNT(element) AS count FROM atom WHERE molecule_id = 'TR000' GROUP BY element ORDER BY count DESC, element ASC LIMIT 3; 
SELECT a1.atom_id AS atom1, a2.atom_id AS atom2 FROM connected c JOIN atom a1 ON c.atom_id = a1.atom_id JOIN atom a2 ON c.atom_id2 = a2.atom_id WHERE c.bond_id = 'TR001_2_6' AND a1.molecule_id = 'TR001' AND a2.molecule_id = 'TR001'; 
SELECT      (SELECT COUNT(*) FROM molecule WHERE label = '+') -      (SELECT COUNT(*) FROM molecule WHERE label = '-') AS difference; 
SELECT atom_id, atom_id2  FROM connected  WHERE bond_id = 'TR000_2_5'; 
SELECT bond_id  FROM connected  WHERE atom_id2 = 'TR000_2'; 
SELECT DISTINCT m.molecule_id FROM molecule m JOIN bond b ON m.molecule_id = b.molecule_id WHERE b.bond_type = '=' ORDER BY m.molecule_id ASC LIMIT 5; 
SELECT      CASE          WHEN COUNT(*) = 0 THEN NULL         ELSE ROUND(             (CAST(SUM(CASE WHEN bond_type = '=' THEN 1 ELSE 0 END) AS FLOAT) / COUNT(bond_id)) * 100,              5         )     END AS percent FROM bond WHERE molecule_id = 'TR008'; 
SELECT ROUND((SUM(CASE WHEN label = '+' THEN 1 ELSE 0 END) * 100.0) / COUNT(molecule_id), 3) AS percentage FROM molecule; 
SELECT      CASE          WHEN COUNT(*) = 0 THEN NULL         ELSE ROUND(             CAST(SUM(CASE WHEN element = 'h' THEN 1 ELSE 0 END) AS FLOAT)              / COUNT(atom_id) * 100,              4         )     END AS percentage FROM atom WHERE molecule_id = 'TR206'; 
SELECT DISTINCT bond_type FROM bond WHERE molecule_id = 'TR000'; 
SELECT a.element, m.label  FROM molecule m  LEFT JOIN atom a ON m.molecule_id = a.molecule_id  WHERE m.molecule_id = 'TR060'; 
SELECT b.bond_type, COUNT(b.bond_type) AS bond_count,         CASE             WHEN m.label = '+' THEN 'Carcinogenic'             WHEN m.label = '-' THEN 'Not Carcinogenic'             ELSE 'Unknown'        END AS carcinogenic_status FROM bond b JOIN molecule m ON b.molecule_id = m.molecule_id WHERE b.molecule_id = 'TR010' GROUP BY b.bond_type, m.label ORDER BY bond_count DESC LIMIT 1; 
SELECT DISTINCT m.molecule_id FROM molecule m JOIN bond b ON m.molecule_id = b.molecule_id WHERE m.label = '-' AND b.bond_type = '-' ORDER BY m.molecule_id LIMIT 3; 
SELECT bond_id  FROM bond  WHERE molecule_id = 'TR006'  ORDER BY bond_id ASC  LIMIT 2; 
SELECT COUNT(*) FROM bond JOIN connected ON bond.bond_id = connected.bond_id WHERE bond.molecule_id = 'TR009' AND (connected.atom_id = 'TR009_12' OR connected.atom_id2 = 'TR009_12'); 
SELECT COUNT(DISTINCT m.molecule_id) AS carcinogenic_bromine_molecules_count FROM molecule m JOIN atom a ON m.molecule_id = a.molecule_id WHERE m.label = '+' AND a.element = 'br'; 
SELECT b.bond_type, c.atom_id, c.atom_id2 FROM bond b JOIN connected c ON b.bond_id = c.bond_id WHERE b.bond_id = 'TR001_6_9'; 
SELECT m.molecule_id,         CASE             WHEN m.label = '+' THEN 'Carcinogenic'             ELSE 'Non-carcinogenic'         END AS carcinogenic_status FROM atom a JOIN molecule m ON a.molecule_id = m.molecule_id WHERE a.atom_id = 'TR001_10'; 
SELECT COUNT(DISTINCT molecule_id) AS molecule_count FROM bond WHERE bond_type = '#'; 
SELECT COUNT(*) AS connection_count FROM connected WHERE atom_id LIKE 'TR%_19'; 
SELECT element  FROM atom  WHERE molecule_id = 'TR004'; 
SELECT COUNT(*)  FROM molecule  WHERE label = '-'; 
SELECT DISTINCT m.molecule_id FROM atom a JOIN molecule m ON a.molecule_id = m.molecule_id WHERE SUBSTR(a.atom_id, INSTR(a.atom_id, '_') + 1) BETWEEN '21' AND '25' AND m.label = '+'; 
SELECT b.bond_id FROM bond b JOIN connected c ON b.bond_id = c.bond_id JOIN atom a1 ON c.atom_id = a1.atom_id JOIN atom a2 ON c.atom_id2 = a2.atom_id WHERE (a1.element = 'p' AND a2.element = 'n') OR (a1.element = 'n' AND a2.element = 'p'); 
SELECT      CASE          WHEN m.label = '+' THEN 'Yes'         ELSE 'No'     END AS is_carcinogenic FROM molecule m WHERE m.molecule_id = (     SELECT molecule_id     FROM bond     WHERE bond_type = '='     GROUP BY molecule_id     ORDER BY COUNT(bond_id) DESC     LIMIT 1 ); 
WITH iodine_atoms AS (     SELECT a.atom_id, COUNT(c.bond_id) AS bond_count     FROM atom a     LEFT JOIN connected c ON a.atom_id = c.atom_id     WHERE a.element = 'i'     GROUP BY a.atom_id ) SELECT AVG(bond_count) AS average_bonds_per_iodine_atom FROM iodine_atoms; 
SELECT b.bond_type, b.bond_id FROM bond b JOIN connected c ON b.bond_id = c.bond_id WHERE c.atom_id = 'TR000_45' OR c.atom_id2 = 'TR000_45'; 
SELECT element FROM atom WHERE atom_id NOT IN (     SELECT atom_id     FROM connected     UNION     SELECT atom_id2     FROM connected ); 
SELECT a.atom_id, a.element  FROM atom a JOIN connected c ON a.atom_id = c.atom_id JOIN bond b ON c.bond_id = b.bond_id WHERE b.molecule_id = 'TR041' AND b.bond_type = '#'; 
SELECT a.element FROM atom a JOIN connected c ON a.atom_id = c.atom_id WHERE c.bond_id = 'TR144_8_19' UNION ALL SELECT 'Bond not found' AS element WHERE NOT EXISTS (     SELECT 1      FROM bond      WHERE bond_id = 'TR144_8_19' ); 
SELECT molecule.molecule_id, COUNT(bond.bond_id) AS double_bond_count FROM molecule JOIN bond ON molecule.molecule_id = bond.molecule_id WHERE molecule.label = '+' AND bond.bond_type = '=' GROUP BY molecule.molecule_id ORDER BY double_bond_count DESC LIMIT 1; 
SELECT element, COUNT(element) AS element_count FROM atom JOIN molecule ON atom.molecule_id = molecule.molecule_id WHERE molecule.label = '+' GROUP BY element ORDER BY COUNT(element) ASC LIMIT 1; 
SELECT DISTINCT a2.atom_id FROM atom a1 JOIN connected c ON a1.atom_id = c.atom_id JOIN atom a2 ON a2.atom_id = c.atom_id2 WHERE a1.element = 'pb' AND a2.atom_id != a1.atom_id UNION SELECT DISTINCT a2.atom_id FROM atom a1 JOIN connected c ON a1.atom_id = c.atom_id2 JOIN atom a2 ON a2.atom_id = c.atom_id WHERE a1.element = 'pb' AND a2.atom_id != a1.atom_id; 
SELECT DISTINCT a.element FROM bond b JOIN connected c ON b.bond_id = c.bond_id JOIN atom a ON a.atom_id IN (c.atom_id, c.atom_id2) WHERE b.bond_type = '#'; 
WITH BondAtomCombination AS (     SELECT          LEAST(a1.element, a2.element) AS element1,         GREATEST(a1.element, a2.element) AS element2,         COUNT(DISTINCT c.bond_id) AS bond_count     FROM connected c     JOIN atom a1 ON c.atom_id = a1.atom_id     JOIN atom a2 ON c.atom_id2 = a2.atom_id     WHERE a1.atom_id < a2.atom_id     GROUP BY element1, element2 ), MostCommonCombination AS (     SELECT element1, element2, MAX(bond_count) AS max_bond_count     FROM BondAtomCombination ), TotalBondCount AS (     SELECT COUNT(DISTINCT bond_id) AS total_bonds     FROM bond ) SELECT      (CAST(mcc.max_bond_count AS FLOAT) / tbc.total_bonds) * 100 AS percentage FROM MostCommonCombination mcc CROSS JOIN TotalBondCount tbc; 
SELECT ROUND((CAST(SUM(CASE WHEN m.label = '+' THEN 1 ELSE 0 END) AS FLOAT) * 100) / COUNT(b.bond_id), 5) AS proportion FROM bond b JOIN molecule m ON b.molecule_id = m.molecule_id WHERE b.bond_type = '-'; 
SELECT COUNT(*) AS total_atoms FROM atom WHERE element IN ('c', 'h') AND molecule_id IN (SELECT molecule_id FROM molecule); 
SELECT c.atom_id2 FROM atom a JOIN connected c ON a.atom_id = c.atom_id WHERE a.element = 's'; 
SELECT DISTINCT b.bond_type FROM atom a LEFT JOIN connected c ON a.atom_id = c.atom_id LEFT JOIN bond b ON c.bond_id = b.bond_id WHERE a.element = 'sn'; 
SELECT COUNT(DISTINCT a.element) AS element_count FROM bond b JOIN connected c ON b.bond_id = c.bond_id JOIN atom a ON a.atom_id = c.atom_id WHERE b.bond_type = '-'; 
SELECT COUNT(DISTINCT a.atom_id) AS total_atoms FROM bond b JOIN connected c ON b.bond_id = c.bond_id JOIN atom a ON a.atom_id = c.atom_id WHERE b.bond_type = '#' AND a.element IN ('p', 'br'); 
SELECT bond_id  FROM bond  WHERE molecule_id IN (SELECT molecule_id FROM molecule WHERE label = '+'); 
SELECT DISTINCT m.molecule_id FROM molecule m JOIN bond b ON m.molecule_id = b.molecule_id WHERE b.bond_type = '-' AND m.label = '-'; 
SELECT      (CAST(SUM(CASE WHEN a.element = 'cl' THEN 1 ELSE 0 END) AS FLOAT) /       CAST(COUNT(a.atom_id) AS FLOAT)) * 100 AS percent FROM      atom a WHERE      a.atom_id IN (         SELECT DISTINCT c.atom_id         FROM bond b         JOIN connected c ON b.bond_id = c.bond_id         WHERE b.bond_type = '-'     ); 
SELECT label FROM molecule WHERE molecule_id IN ('TR000', 'TR001', 'TR002'); 
SELECT molecule_id  FROM molecule  WHERE label = '-'; 
SELECT COUNT(*) AS total_carcinogenic_molecules FROM molecule WHERE molecule_id BETWEEN 'TR000' AND 'TR030' AND label = '+'; 
SELECT molecule_id, bond_type  FROM bond  WHERE molecule_id BETWEEN 'TR000' AND 'TR050'; 
SELECT a.element FROM atom a JOIN bond b   ON a.molecule_id = b.molecule_id WHERE b.bond_id = 'TR001_10_11'; 
SELECT 0 AS bond_count; 
SELECT      CASE          WHEN COUNT(*) = 0 THEN 'No molecules with calcium found'         ELSE (             SELECT label             FROM molecule             WHERE molecule_id IN (                 SELECT molecule_id                 FROM atom                 WHERE element = 'ca'             )             GROUP BY label             ORDER BY COUNT(*) DESC             LIMIT 1         )     END AS result FROM atom WHERE element = 'ca'; 
SELECT CASE      WHEN COUNT(DISTINCT a.element) = 2 THEN 'Both Present'      ELSE 'Not Both Present'  END AS element_check FROM bond b JOIN atom a ON b.molecule_id = a.molecule_id WHERE b.bond_id = 'TR001_1_8' AND a.element IN ('cl', 'c'); 
SELECT DISTINCT m.molecule_id FROM molecule m JOIN atom a ON m.molecule_id = a.molecule_id JOIN connected c ON a.atom_id = c.atom_id JOIN bond b ON c.bond_id = b.bond_id WHERE a.element = 'c'   AND b.bond_type = '#'   AND m.label = '-' LIMIT 2; 
SELECT      (CAST(COUNT(DISTINCT a.molecule_id) AS FLOAT)      / COUNT(DISTINCT m.molecule_id)) * 100 AS percentage FROM      molecule m LEFT JOIN      atom a ON m.molecule_id = a.molecule_id WHERE      m.label = '+'     AND a.element = 'cl'; 
SELECT DISTINCT a.element FROM atom a JOIN molecule m ON a.molecule_id = m.molecule_id WHERE m.molecule_id = 'TR001' AND a.element IS NOT NULL; 
SELECT DISTINCT molecule_id  FROM bond  WHERE bond_type = '='; 
SELECT c.atom_id AS first_atom, c.atom_id2 AS second_atom FROM connected c JOIN bond b ON c.bond_id = b.bond_id WHERE b.bond_type = '#'; 
SELECT DISTINCT a.element FROM atom a JOIN connected c    ON (a.atom_id = c.atom_id OR a.atom_id = c.atom_id2) WHERE c.bond_id = 'TR000_1_2'; 
SELECT COUNT(DISTINCT b.molecule_id)  FROM bond b JOIN molecule m ON b.molecule_id = m.molecule_id WHERE b.bond_type = '-' AND m.label = '-'; 
SELECT m.label FROM bond b JOIN molecule m ON b.molecule_id = m.molecule_id WHERE b.bond_id = 'TR001_10_11'; 
SELECT b.bond_id,         CASE             WHEN m.label = '+' THEN 'carcinogenic'             WHEN m.label = '-' THEN 'non-carcinogenic'         END AS carcinogenic_status FROM bond b JOIN molecule m ON b.molecule_id = m.molecule_id WHERE b.bond_type = '#'; 
SELECT a.element, COUNT(*) AS tally FROM atom a JOIN molecule m ON a.molecule_id = m.molecule_id WHERE m.label = '+' AND a.atom_id LIKE '%_4' GROUP BY a.element; 
SELECT      CASE          WHEN COUNT(CASE WHEN atom.element IS NOT NULL THEN 1 ELSE NULL END) = 0 THEN NULL         ELSE (SUM(CASE WHEN atom.element = 'h' THEN 1 ELSE 0 END) * 1.0 / COUNT(CASE WHEN atom.element IS NOT NULL THEN 1 ELSE NULL END))     END AS ratio,     molecule.label FROM      molecule LEFT JOIN      atom ON      atom.molecule_id = molecule.molecule_id WHERE      molecule.molecule_id = 'TR006'; 
SELECT      CASE          WHEN m.label = '+' THEN 'Carcinogenic'         WHEN m.label = '-' THEN 'Non-carcinogenic'         ELSE 'Unknown'     END AS carcinogenic_status FROM      molecule m LEFT JOIN      atom a ON      m.molecule_id = a.molecule_id AND a.element = 'ca'; 
SELECT DISTINCT b.bond_type FROM atom a JOIN connected c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2 JOIN bond b ON c.bond_id = b.bond_id WHERE a.element = 'c'; 
SELECT DISTINCT a.element  FROM atom a WHERE a.atom_id IN ('TR001_10', 'TR001_11'); 
SELECT      (CAST(COUNT(DISTINCT b.molecule_id) AS FLOAT) * 100) /      (SELECT COUNT(DISTINCT molecule_id) FROM molecule) AS percent_with_triple_bond FROM      bond b WHERE      b.bond_type = '#'; 
SELECT      CASE          WHEN COUNT(bond_id) = 0 THEN NULL         ELSE (SUM(CASE WHEN bond_type = '=' THEN 1 ELSE 0 END) * 100.0 / COUNT(bond_id))      END AS percent FROM      bond WHERE      molecule_id = 'TR047'; 
SELECT m.label = '+' AS is_carcinogenic FROM molecule m JOIN atom a ON m.molecule_id = a.molecule_id WHERE a.atom_id = 'TR001_1'; 
SELECT CASE WHEN label = '+' THEN 'Yes' ELSE 'No' END AS is_carcinogenic FROM molecule WHERE molecule_id = 'TR151'; 
SELECT DISTINCT a.element FROM atom a JOIN molecule m ON a.molecule_id = m.molecule_id WHERE a.molecule_id = 'TR151'   AND a.element IN ('cl', 'br', 'f', 'i', 'sn', 'pb', 'te'); 
SELECT COUNT(*)  FROM molecule  WHERE label = '+'; 
SELECT *  FROM atom  WHERE element = 'c'    AND substr(molecule_id, 3, 3) BETWEEN '010' AND '050'; 
SELECT COUNT(*)  FROM atom WHERE molecule_id IN (     SELECT molecule_id      FROM molecule      WHERE label = '+' ); 
SELECT b.bond_id FROM bond b JOIN molecule m ON b.molecule_id = m.molecule_id WHERE b.bond_type = '=' AND m.label = '+'; 
SELECT COUNT(*) FROM atom JOIN molecule ON atom.molecule_id = molecule.molecule_id WHERE molecule.label = '+' AND atom.element = 'h'; 
SELECT b.molecule_id  FROM bond b JOIN connected c ON b.bond_id = c.bond_id WHERE c.atom_id = 'TR000_1' AND b.bond_id = 'TR000_1_2'; 
SELECT a.atom_id FROM atom a LEFT JOIN molecule m ON a.molecule_id = m.molecule_id WHERE a.element = 'c' AND m.label = '-'; 
SELECT      (CAST(COUNT(DISTINCT m.molecule_id) AS FLOAT) /       CAST((SELECT COUNT(DISTINCT molecule_id)             FROM molecule             WHERE label = '+') AS FLOAT)) * 100.0 AS percentage FROM      molecule m INNER JOIN      atom a ON      m.molecule_id = a.molecule_id WHERE      m.label = '+' AND a.element = 'h'; 
SELECT CASE             WHEN label = '+' THEN 'Yes'            ELSE 'No'        END AS is_carcinogenic FROM molecule WHERE molecule_id = 'TR124'; 
SELECT atom_id, element  FROM atom  WHERE molecule_id = 'TR186'; 
SELECT bond_type  FROM bond  WHERE bond_id = 'TR007_4_19'; 
SELECT DISTINCT a.element FROM connected c JOIN atom a ON c.atom_id = a.atom_id OR c.atom_id2 = a.atom_id WHERE c.bond_id = 'TR001_2_4'; 
SELECT      COUNT(b.bond_id) AS double_bonds,      CASE          WHEN m.label = '+' THEN 'Carcinogenic'          ELSE 'Non-Carcinogenic'      END AS carcinogenic_status FROM      molecule m LEFT JOIN      bond b ON m.molecule_id = b.molecule_id WHERE      m.molecule_id = 'TR006' AND b.bond_type = '=' GROUP BY      m.label; 
SELECT m.molecule_id, a.element FROM molecule m JOIN atom a ON m.molecule_id = a.molecule_id WHERE m.label = '+'; 
SELECT      b.bond_id,      a1.atom_id AS atom1,      a2.atom_id AS atom2,      b.molecule_id FROM      bond b JOIN      connected c ON b.bond_id = c.bond_id JOIN      atom a1 ON c.atom_id = a1.atom_id JOIN      atom a2 ON c.atom_id2 = a2.atom_id WHERE      b.bond_type = '-'; 
SELECT DISTINCT b.molecule_id, a.element FROM bond b JOIN connected c ON b.bond_id = c.bond_id JOIN atom a ON a.atom_id = c.atom_id WHERE b.bond_type = '#'; 
SELECT a1.element AS element1, a2.element AS element2 FROM connected c JOIN atom a1 ON c.atom_id = a1.atom_id JOIN atom a2 ON c.atom_id2 = a2.atom_id WHERE c.bond_id = 'TR000_2_3'; 
SELECT COUNT(DISTINCT b.bond_id) AS total_bonds FROM bond b JOIN connected c ON b.bond_id = c.bond_id JOIN atom a1 ON c.atom_id = a1.atom_id JOIN atom a2 ON c.atom_id2 = a2.atom_id WHERE (a1.element = 'cl' OR a2.element = 'cl')   AND c.atom_id < c.atom_id2; 
SELECT a.atom_id, COUNT(DISTINCT b.bond_type) AS bond_type_count FROM molecule m LEFT JOIN atom a ON m.molecule_id = a.molecule_id LEFT JOIN bond b ON m.molecule_id = b.molecule_id WHERE m.molecule_id = 'TR346' GROUP BY a.atom_id; 
SELECT COUNT(*) AS total_double_bond_molecules,        SUM(CASE WHEN m.label = '+' THEN 1 ELSE 0 END) AS carcinogenic_double_bond_molecules FROM molecule m JOIN bond b ON m.molecule_id = b.molecule_id WHERE b.bond_type = '='; 
SELECT COUNT(DISTINCT m.molecule_id) FROM molecule m WHERE NOT EXISTS (     SELECT 1     FROM atom a     WHERE a.molecule_id = m.molecule_id     AND a.element = 's' ) AND NOT EXISTS (     SELECT 1     FROM bond b     WHERE b.molecule_id = m.molecule_id     AND b.bond_type = '=' ); 
SELECT m.label  FROM bond b JOIN molecule m ON b.molecule_id = m.molecule_id WHERE b.bond_id = 'TR001_2_4'; 
SELECT COUNT(*)  FROM atom  WHERE molecule_id = 'TR001'; 
SELECT COUNT(*) AS single_bonds_count FROM bond WHERE bond_type = '-'; 
SELECT m.molecule_id FROM molecule m WHERE m.label = '+' AND EXISTS (     SELECT 1     FROM atom a     WHERE a.molecule_id = m.molecule_id AND a.element = 'cl' ); 
SELECT DISTINCT m.molecule_id FROM molecule m INNER JOIN atom a ON m.molecule_id = a.molecule_id WHERE a.element = 'c' AND m.label = '-'; 
SELECT      (CAST(COUNT(DISTINCT CASE WHEN m.label = '+' AND a.element = 'cl' THEN m.molecule_id END) AS FLOAT)      / NULLIF(COUNT(DISTINCT CASE WHEN m.label = '+' THEN m.molecule_id END), 0)) * 100 AS percentage FROM      molecule m LEFT JOIN      atom a ON      m.molecule_id = a.molecule_id; 
SELECT molecule_id FROM bond WHERE bond_id = 'TR001_1_7'; 
SELECT 'Bond ID does not exist' AS message; 
SELECT b.bond_type FROM connected c JOIN bond b ON c.bond_id = b.bond_id WHERE c.atom_id = 'TR000_1' AND c.atom_id2 = 'TR000_2'; 
SELECT m.label  FROM connected c JOIN atom a1 ON c.atom_id = a1.atom_id JOIN atom a2 ON c.atom_id2 = a2.atom_id JOIN molecule m ON a1.molecule_id = m.molecule_id WHERE c.atom_id = 'TR000_2' AND c.atom_id2 = 'TR000_4'; 
SELECT      a1.element AS atom_element,     a2.atom_id AS connected_atom_id,     a2.element AS connected_atom_element,     b.bond_type AS bond_type FROM atom a1 LEFT JOIN connected c ON a1.atom_id = c.atom_id LEFT JOIN atom a2 ON c.atom_id2 = a2.atom_id LEFT JOIN bond b ON c.bond_id = b.bond_id WHERE a1.atom_id = 'TR000_1'; 
SELECT      CASE          WHEN label = '+' THEN 'Carcinogenic'         WHEN label = '-' THEN 'Non-carcinogenic'     END AS carcinogenic_status FROM molecule WHERE molecule_id = 'TR000'; 
SELECT      (CAST(SUM(CASE WHEN b.bond_type = '-' THEN 1 ELSE 0 END) AS FLOAT) / COUNT(b.bond_id)) * 100 AS percentage FROM      bond b; 
SELECT COUNT(DISTINCT a.molecule_id) AS carcinogenic_nitrogen_molecules_count FROM atom a JOIN molecule m ON a.molecule_id = m.molecule_id WHERE a.element = 'n' AND m.label = '+'; 
SELECT DISTINCT m.molecule_id FROM molecule m JOIN atom a ON m.molecule_id = a.molecule_id JOIN connected c ON a.atom_id = c.atom_id JOIN bond b ON c.bond_id = b.bond_id WHERE a.element = 's' AND b.bond_type = '='; 
SELECT molecule.molecule_id FROM molecule JOIN atom ON molecule.molecule_id = atom.molecule_id WHERE molecule.label = '-' GROUP BY molecule.molecule_id HAVING COUNT(atom.molecule_id) > 5; 
SELECT DISTINCT a.element FROM atom a JOIN connected c ON a.atom_id = c.atom_id JOIN bond b ON c.bond_id = b.bond_id WHERE b.bond_type = '='    AND b.molecule_id = 'TR000'; 
SELECT molecule.molecule_id FROM molecule JOIN atom ON molecule.molecule_id = atom.molecule_id WHERE molecule.label = '+' GROUP BY molecule.molecule_id ORDER BY COUNT(atom.molecule_id) DESC LIMIT 1; 
SELECT      CASE          WHEN total_molecules = 0 THEN 0         ELSE (carcinogenic_with_triple_bonds * 100.0 / total_molecules)     END AS percentage FROM (     SELECT          COUNT(DISTINCT m.molecule_id) AS carcinogenic_with_triple_bonds,         (SELECT COUNT(DISTINCT molecule_id) FROM molecule WHERE label = '+') AS total_molecules     FROM          molecule m     INNER JOIN          atom a ON m.molecule_id = a.molecule_id     INNER JOIN          connected c ON a.atom_id = c.atom_id     INNER JOIN          bond b ON c.bond_id = b.bond_id     WHERE          m.label = '+'         AND a.element = 'h'         AND b.bond_type = '#' ) subquery; 
SELECT COUNT(*) AS carcinogenic_molecules_count FROM molecule WHERE label = '+'; 
SELECT COUNT(DISTINCT b.molecule_id) AS molecule_count FROM bond b WHERE b.bond_type = '-' AND b.molecule_id BETWEEN 'TR004' AND 'TR010'; 
SELECT COUNT(*)  FROM atom  WHERE molecule_id = 'TR008' AND element = 'c'; 
SELECT a.element  FROM atom a JOIN molecule m ON a.molecule_id = m.molecule_id WHERE m.label = '-' AND a.atom_id = 'TR004_7'; 
SELECT COUNT(DISTINCT m.molecule_id) AS total_molecules FROM molecule m JOIN bond b ON m.molecule_id = b.molecule_id JOIN connected c ON b.bond_id = c.bond_id JOIN atom a1 ON c.atom_id = a1.atom_id JOIN atom a2 ON c.atom_id2 = a2.atom_id WHERE b.bond_type = '='    AND (a1.element = 'o' OR a2.element = 'o')   AND a1.molecule_id = m.molecule_id    AND a2.molecule_id = m.molecule_id; 
SELECT COUNT(DISTINCT molecule.molecule_id) AS non_carcinogenic_molecules_with_triple_bonds FROM molecule JOIN bond ON molecule.molecule_id = bond.molecule_id WHERE bond.bond_type = '#' AND molecule.label = '-'; 
SELECT a.element, b.bond_type FROM molecule m LEFT JOIN atom a ON m.molecule_id = a.molecule_id LEFT JOIN bond b ON m.molecule_id = b.molecule_id WHERE m.molecule_id = 'TR002'; 
SELECT a.atom_id FROM atom a JOIN connected c ON a.atom_id = c.atom_id JOIN bond b ON c.bond_id = b.bond_id WHERE a.element = 'c' AND b.bond_type = '=' AND a.molecule_id = 'TR000'; 
SELECT a.atom_id FROM atom a JOIN molecule m ON a.molecule_id = m.molecule_id WHERE m.label = '+' AND a.element = 'o'; 
SELECT *  FROM cards  WHERE cardKingdomFoilId IS NOT NULL AND cardKingdomId IS NOT NULL; 
SELECT *  FROM cards  WHERE borderColor = 'borderless'    AND (cardKingdomFoilId IS NULL OR cardKingdomId IS NULL); 
SELECT name  FROM cards  WHERE faceConvertedManaCost = (SELECT MAX(faceConvertedManaCost) FROM cards); 
SELECT name  FROM cards  WHERE edhrecRank < 100 AND frameVersion = '2015'; 
SELECT c.name FROM cards c INNER JOIN legalities l ON c.uuid = l.uuid WHERE LOWER(c.rarity) = 'mythic' AND LOWER(l.format) = 'gladiator' AND LOWER(l.status) = 'banned'; 
SELECT c.name, l.status FROM cards c JOIN legalities l ON c.uuid = l.uuid WHERE c.type LIKE '%Artifact%' AND c.side IS NULL AND l.format = 'vintage'; 
SELECT DISTINCT c.id, c.artist  FROM cards c  JOIN legalities l    ON c.uuid = l.uuid  WHERE c.power IS NULL    AND l.format = 'commander'    AND l.status = 'Legal'; 
SELECT      cards.id,      rulings.text AS ruling_text,      cards.hasContentWarning FROM      cards LEFT JOIN      rulings  ON      cards.uuid = rulings.uuid WHERE      cards.artist = 'Stephen Daniele'; 
SELECT r.text  FROM rulings AS r JOIN cards AS c ON r.uuid = c.uuid WHERE LOWER(c.name) = 'sublime epiphany' AND TRIM(c.number) = '74s'; 
SELECT c.name, c.artist, c.isPromo FROM cards c JOIN rulings r ON c.uuid = r.uuid GROUP BY c.uuid, c.name, c.artist, c.isPromo ORDER BY COUNT(r.uuid) DESC LIMIT 1; 
SELECT      COALESCE(fd.language, 'No alternative language available') AS language FROM cards c LEFT JOIN foreign_data fd ON fd.uuid = c.uuid WHERE lower(trim(c.name)) = 'annul' AND c.number = '29'; 
SELECT DISTINCT c.name  FROM cards c JOIN foreign_data fd ON c.uuid = fd.uuid WHERE fd.language = 'Japanese'; 
SELECT      (COUNT(*) * 100.0 / COUNT(*) OVER()) AS percentage FROM set_translations WHERE language = 'Chinese Simplified'; 
SELECT st.translation AS set_name,         COALESCE(s.totalSetSize, 0) AS total_cards FROM set_translations st INNER JOIN sets s ON st.setCode = s.code WHERE st.language = 'Italian'; 
SELECT COUNT(DISTINCT type)  FROM cards  WHERE artist = 'Aaron Boyd'; 
SELECT keywords  FROM cards  WHERE name = 'Angel of Mercy'; 
SELECT COUNT(*) FROM cards WHERE power = '*'; 
SELECT promoTypes  FROM cards  WHERE name = 'Duress'; 
SELECT borderColor  FROM cards  WHERE name = 'Ancestor''s Chosen'; 
SELECT originalType  FROM cards  WHERE LOWER(name) = LOWER('Ancestor''s Chosen') AND originalType IS NOT NULL; 
SELECT st.language  FROM cards c INNER JOIN sets s ON c.setCode = s.code INNER JOIN set_translations st ON s.code = st.setCode WHERE c.name = 'Angel of Mercy'; 
SELECT COUNT(cards.uuid) AS card_count FROM cards INNER JOIN legalities ON cards.uuid = legalities.uuid WHERE legalities.status = 'restricted' AND cards.isTextless = 0; 
SELECT r.text  FROM rulings r JOIN cards c ON r.uuid = c.uuid WHERE LOWER(c.name) = 'condemn'; 
SELECT COUNT(*)  FROM cards  JOIN legalities  ON cards.uuid = legalities.uuid  WHERE legalities.status = 'restricted' AND cards.isStarter = 1; 
SELECT legalities.status  FROM cards  INNER JOIN legalities ON cards.uuid = legalities.uuid  WHERE LOWER(cards.name) = LOWER('Cloudchaser Eagle'); 
SELECT type  FROM cards  WHERE name = 'Benalish Knight'; 
SELECT l.format, l.status FROM legalities l JOIN cards c ON l.uuid = c.uuid WHERE c.name IS NOT NULL AND c.name = 'Benalish Knight'; 
SELECT DISTINCT c.artist FROM cards c LEFT JOIN foreign_data fd ON c.uuid = fd.uuid WHERE fd.language = 'Phyrexian' AND fd.language IS NOT NULL; 
SELECT (CAST(COUNT(id) FILTER (WHERE borderColor = 'borderless') AS REAL) / COUNT(id)) * 100 AS percentage_of_borderless_cards  FROM cards; 
SELECT COUNT(c.id) AS total_cards FROM cards c JOIN foreign_data fd ON c.uuid = fd.uuid WHERE fd.language = 'German' AND c.isReprint = 1; 
SELECT COUNT(DISTINCT cards.uuid)  FROM cards  LEFT JOIN foreign_data    ON cards.uuid = foreign_data.uuid  WHERE cards.borderColor = 'borderless'    AND foreign_data.language = 'Russian'; 
WITH StorySpotlightTotal AS (     SELECT COUNT(*) AS total_count     FROM cards     WHERE isStorySpotlight = 1 ), FrenchStorySpotlight AS (     SELECT COUNT(*) AS french_count     FROM cards c     LEFT JOIN foreign_data fd ON c.uuid = fd.uuid     WHERE c.isStorySpotlight = 1 AND fd.language = 'French' ) SELECT      (CAST(fs.french_count AS FLOAT) / CAST(sst.total_count AS FLOAT)) * 100 AS percentage FROM FrenchStorySpotlight fs CROSS JOIN StorySpotlightTotal sst; 
SELECT COUNT(*)  FROM cards  WHERE toughness = '99'; 
SELECT name  FROM cards  WHERE artist = 'Aaron Boyd'; 
SELECT COUNT(*)  FROM cards  WHERE borderColor = 'black' AND availability = 'mtgo'; 
SELECT id  FROM cards  WHERE convertedManaCost = 0; 
SELECT layout  FROM cards  WHERE keywords LIKE '%flying%'; 
SELECT COUNT(*)  FROM cards  WHERE originalType = 'Summon - Angel' AND (subtypes IS NULL OR subtypes != 'Angel'); 
SELECT id  FROM cards  WHERE cardKingdomFoilId IS NOT NULL AND cardKingdomId IS NOT NULL; 
SELECT id  FROM cards  WHERE duelDeck = 'a'; 
SELECT edhrecRank  FROM cards  WHERE frameVersion = '2015'; 
SELECT DISTINCT c.artist FROM cards c JOIN foreign_data fd ON c.uuid = fd.uuid WHERE fd.language = 'Chinese Simplified'; 
SELECT DISTINCT c.name FROM cards c INNER JOIN foreign_data fd ON c.uuid = fd.uuid WHERE c.availability = 'paper'   AND fd.language = 'Japanese'   AND NOT EXISTS (       SELECT 1       FROM foreign_data fd2       WHERE fd2.uuid = c.uuid         AND (fd2.language IS NOT NULL AND fd2.language != 'Japanese')   ); 
SELECT COUNT(*)  FROM cards  LEFT JOIN legalities ON cards.uuid = legalities.uuid  WHERE legalities.status = 'Banned' AND cards.borderColor = 'white'; 
SELECT l.uuid, fd.language  FROM legalities l  INNER JOIN foreign_data fd ON l.uuid = fd.uuid  INNER JOIN cards c ON l.uuid = c.uuid  WHERE l.format = 'legacy'; 
SELECT r.text  FROM rulings r JOIN cards c ON r.uuid = c.uuid WHERE LOWER(c.name) = LOWER('Beacon of Immortality'); 
SELECT COUNT(DISTINCT c.uuid) AS card_count,         COALESCE(LOWER(l.status), 'no legality') AS legality_status FROM cards c LEFT JOIN legalities l  ON c.uuid = l.uuid WHERE c.frameVersion = 'future'  GROUP BY legality_status; 
SELECT name, colors  FROM cards  WHERE setCode = 'OGW'; 
SELECT DISTINCT cards.name, foreign_data.language FROM cards INNER JOIN foreign_data ON cards.uuid = foreign_data.uuid WHERE cards.setCode = '10E' AND cards.convertedManaCost = 5; 
SELECT c.name, r.date FROM cards c INNER JOIN rulings r ON c.uuid = r.uuid WHERE LOWER(c.originalType) LIKE '%creature - elf%'; 
SELECT      cards.colors,      COALESCE(GROUP_CONCAT(legalities.format), 'Unknown') AS formats  FROM cards  LEFT JOIN legalities      ON cards.uuid = legalities.uuid  WHERE cards.id BETWEEN 1 AND 20 GROUP BY cards.id, cards.colors; 
SELECT DISTINCT c.* FROM cards c JOIN foreign_data fd ON c.uuid = fd.uuid WHERE c.originalType = 'Artifact'   AND c.colors = 'B'   AND fd.language IS NOT NULL   AND fd.language != 'English'; 
SELECT c.name, COALESCE(MIN(r.date), '9999-12-31') AS min_date FROM cards c LEFT JOIN rulings r ON c.uuid = r.uuid WHERE c.rarity = 'uncommon' GROUP BY c.name ORDER BY min_date ASC LIMIT 3; 
SELECT COUNT(*)  FROM cards  WHERE artist = 'John Avon'  AND cardKingdomFoilId IS NOT NULL; 
SELECT COUNT(*)  FROM cards  WHERE borderColor = 'white'    AND cardKingdomFoilId IS NOT NULL    AND cardKingdomId IS NOT NULL; 
SELECT COUNT(*)  FROM cards  WHERE artist = 'UDON' AND availability = 'mtgo' AND hand = '-1'; 
SELECT COUNT(*)  FROM cards  WHERE frameVersion = '1993'  AND availability = 'paper'  AND hasContentWarning = 1; 
SELECT manaCost  FROM cards  WHERE layout = 'normal'    AND frameVersion = '2003'    AND borderColor = 'black'    AND availability = 'mtgo,paper'; 
SELECT SUM(convertedManaCost) AS total_unconverted_mana FROM cards WHERE artist = 'Rob Alexander' AND convertedManaCost IS NOT NULL; 
SELECT DISTINCT subtypes, supertypes  FROM cards  WHERE availability = 'arena'; 
SELECT DISTINCT setCode  FROM set_translations  WHERE language = 'Spanish'; 
SELECT      (CAST(SUM(CASE WHEN isOnlineOnly = 1 THEN 1 ELSE 0 END) AS FLOAT) / COUNT(id)) * 100 AS percentage FROM cards WHERE frameEffects = 'legendary'; 
WITH SpotlightCards AS (     SELECT id     FROM cards     WHERE isStorySpotlight = 1 AND isTextless = 0 ), Counts AS (     SELECT          (SELECT COUNT(*) FROM SpotlightCards) AS count_story_spotlight_text,         (SELECT COUNT(*) FROM cards WHERE isStorySpotlight = 1) AS total_story_spotlight ) SELECT      (CAST(count_story_spotlight_text AS FLOAT) / total_story_spotlight) * 100 AS percentage FROM Counts;  SELECT id FROM SpotlightCards; 
SELECT      c.name,     COALESCE(         (SUM(CASE WHEN fd.language = 'Spanish' THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(fd.id), 0)),         0     ) AS percentage FROM      cards c LEFT JOIN      foreign_data fd ON      c.uuid = fd.uuid GROUP BY      c.name; 
SELECT language  FROM set_translations  WHERE setCode IN (SELECT code FROM sets WHERE baseSetSize = 309); 
SELECT COUNT(*)  FROM sets  JOIN set_translations ON sets.code = set_translations.setCode  WHERE sets.block = 'Commander' AND set_translations.language = 'Portuguese (Brasil)'; 
SELECT cards.id, cards.name FROM cards JOIN legalities ON cards.uuid = legalities.uuid WHERE cards.types IS NOT NULL   AND cards.types LIKE '%Creature%'   AND legalities.status = 'Legal'; 
SELECT DISTINCT c.subtypes, c.supertypes  FROM cards c  JOIN foreign_data fd ON c.uuid = fd.uuid  WHERE fd.language = 'German' AND c.subtypes IS NOT NULL AND c.supertypes IS NOT NULL; 
SELECT COUNT(*)  FROM cards  WHERE (power IS NULL OR power = '*')    AND (text IS NOT NULL AND LOWER(text) LIKE '%triggered ability%'); 
SELECT COUNT(cards.uuid) AS card_count FROM cards JOIN legalities ON cards.uuid = legalities.uuid LEFT JOIN rulings ON cards.uuid = rulings.uuid WHERE legalities.format = 'premodern'   AND (rulings.text = 'This is a triggered mana ability.' OR rulings.uuid IS NULL)   AND cards.side IS NULL; 
SELECT c.id  FROM cards c WHERE c.artist = 'Erica Yang'    AND c.availability = 'paper'; 
SELECT c.artist  FROM cards c  JOIN foreign_data fd ON c.uuid = fd.uuid  WHERE LOWER(fd.text) = LOWER('Das perfekte Gegenmittel zu einer dichten Formation'); 
SELECT fd.name AS foreign_name FROM cards c LEFT JOIN foreign_data fd ON c.uuid = fd.uuid WHERE c.type LIKE '%Creature%'    AND c.layout = 'normal'    AND c.borderColor = 'black'    AND c.artist = 'Matthew D. Wilson'   AND fd.language = 'French'; 
SELECT COUNT(*)  FROM cards  INNER JOIN rulings  ON cards.uuid = rulings.uuid  WHERE cards.rarity = 'rare'    AND rulings.date = '2007-02-01'; 
SELECT st.language FROM sets s JOIN set_translations st ON s.code = st.setCode WHERE s.block = 'Ravnica'; 
SELECT      (COUNT(CASE WHEN c.hasContentWarning = 0 THEN 1 ELSE NULL END) * 100.0 / NULLIF(COUNT(c.id), 0)) AS percentage FROM cards c JOIN legalities l ON c.uuid = l.uuid WHERE l.format = 'commander' AND l.status = 'Legal'; 
SELECT      CASE          WHEN COUNT(CASE WHEN c.power IS NULL OR c.power = '*' THEN 1 END) = 0 THEN 0         ELSE              (COUNT(CASE WHEN fd.language = 'French' AND (c.power IS NULL OR c.power = '*') THEN 1 END) * 100.0) /              COUNT(CASE WHEN c.power IS NULL OR c.power = '*' THEN 1 END)     END AS percentage FROM cards c LEFT JOIN foreign_data fd ON c.uuid = fd.uuid; 
SELECT      SUM(CASE WHEN s.type = 'expansion' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS percentage_of_expansion_sets FROM      set_translations st LEFT JOIN      sets s ON st.setCode = s.code WHERE      st.language = 'Japanese'; 
SELECT availability  FROM cards  WHERE artist = 'Daren Bader'; 
SELECT COUNT(*)  FROM cards  WHERE borderColor = 'borderless'  AND edhrecRank > 12000  AND colors IS NOT NULL; 
SELECT COUNT(*)  FROM cards  WHERE isOversized = 1 AND isReprint = 1 AND isPromo = 1; 
SELECT name FROM cards WHERE (power IS NULL OR power = '*') AND COALESCE(promoTypes, '') LIKE '%arenaleague%' ORDER BY name ASC LIMIT 3; 
SELECT language  FROM foreign_data  WHERE multiverseid = 149934; 
SELECT id  FROM cards  WHERE cardKingdomFoilId IS NOT NULL AND cardKingdomId IS NOT NULL  ORDER BY cardKingdomFoilId ASC  LIMIT 3; 
SELECT (CAST(SUM(CASE WHEN isTextless = 1 AND layout = 'normal' THEN 1 ELSE 0 END) AS FLOAT) / COUNT(isTextless)) * 100 AS proportion  FROM cards; 
SELECT number  FROM cards  WHERE side IS NULL AND subtypes LIKE '%Angel%' AND subtypes LIKE '%Wizard%'; 
SELECT name  FROM sets  WHERE mtgoCode IS NULL OR mtgoCode = ''  ORDER BY name ASC  LIMIT 3; 
SELECT language  FROM set_translations  WHERE setCode = 'ARC'; 
SELECT sets.name, set_translations.translation  FROM sets  JOIN set_translations ON sets.code = set_translations.setCode  WHERE sets.id = 5; 
SELECT st.language, s.type  FROM sets s INNER JOIN set_translations st ON s.code = st.setCode WHERE s.id = 206; 
SELECT s.id, s.name  FROM sets s  JOIN set_translations st ON s.code = st.setCode  WHERE st.language = 'Italian' AND s.block = 'Shadowmoor'  ORDER BY s.name ASC  LIMIT 2; 
SELECT s.id, s.name FROM sets s JOIN cards c ON s.code = c.setCode JOIN foreign_data fd ON c.uuid = fd.uuid WHERE s.isForeignOnly = 1 AND s.isFoilOnly = 1 AND fd.language = 'Japanese'; 
SELECT sets.name, sets.baseSetSize FROM sets LEFT JOIN set_translations ON sets.code = set_translations.setCode WHERE set_translations.language = 'Russian' ORDER BY sets.baseSetSize DESC LIMIT 1; 
SELECT      (CAST(SUM(CASE WHEN st.language = 'Chinese Simplified' AND c.isOnlineOnly = 1 THEN 1 ELSE 0 END) AS FLOAT)      / CAST(COUNT(CASE WHEN c.isOnlineOnly = 1 THEN 1 END) AS FLOAT)) * 100 AS percentage FROM      cards c LEFT JOIN      set_translations st ON c.setCode = st.setCode WHERE      st.language = 'Chinese Simplified'; 
SELECT COUNT(*)  FROM sets s WHERE (mtgoCode IS NULL OR mtgoCode = '') AND s.code IN (     SELECT st.setCode     FROM set_translations st     WHERE st.language = 'Japanese'     GROUP BY st.setCode     HAVING COUNT(*) = 1 ); 
SELECT id  FROM cards  WHERE borderColor = 'black'; 
SELECT COUNT(id) AS card_count, GROUP_CONCAT(id) AS card_ids FROM cards WHERE frameEffects LIKE '%extendedart%'; 
SELECT name  FROM cards  WHERE borderColor = 'black' AND isFullArt = 1; 
SELECT language  FROM set_translations  WHERE setCode IN (SELECT code FROM sets WHERE id = 174); 
SELECT name FROM sets WHERE code = "ALL"; 
SELECT fd.language  FROM foreign_data fd WHERE fd.name = 'A Pedra Fellwar'; 
SELECT code  FROM sets  WHERE releaseDate = '2007-07-13'; 
SELECT baseSetSize, code  FROM sets  WHERE block IN ('Masques', 'Mirage'); 
SELECT code  FROM sets  WHERE type = 'expansion'; 
SELECT foreign_data.name AS foreign_name, cards.types  FROM cards  INNER JOIN foreign_data ON cards.uuid = foreign_data.uuid  WHERE cards.watermark = 'boros'; 
SELECT COALESCE(fd.language, 'Unknown') AS language,         COALESCE(fd.flavorText, 'No Flavor Text') AS flavorText,         c.type FROM cards c LEFT JOIN foreign_data fd    ON c.uuid = fd.uuid WHERE c.watermark = 'colorpie'; 
SELECT (CAST(SUM(CASE WHEN convertedManaCost = 10 THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)) * 100 AS percentage FROM cards WHERE name = 'Abyssal Horror'; 
SELECT code  FROM sets  WHERE type = 'expansion commander'; 
SELECT      foreign_data.name AS foreign_name,      foreign_data.type AS type  FROM      cards  INNER JOIN      foreign_data  ON      cards.uuid = foreign_data.uuid  WHERE      cards.watermark = 'abzan'; 
SELECT DISTINCT fd.language, c.type FROM cards c INNER JOIN foreign_data fd ON c.uuid = fd.uuid WHERE c.watermark = 'azorius'; 
SELECT COUNT(*)  FROM cards  WHERE artist = 'Aaron Miller'  AND cardKingdomFoilId IS NOT NULL  AND cardKingdomId IS NOT NULL; 
SELECT COUNT(*)  FROM cards  WHERE availability LIKE '%paper%'  AND hand = '3'; 
SELECT name  FROM cards  WHERE isTextless = 0; 
SELECT convertedManaCost  FROM cards  WHERE name = 'Ancestor`s Chosen'; 
SELECT COUNT(*)  FROM cards  WHERE borderColor = 'white' AND (power IS NULL OR CAST(power AS TEXT) = '*'); 
SELECT name  FROM cards  WHERE isPromo = 1 AND side IS NOT NULL; 
SELECT subtypes, supertypes  FROM cards  WHERE name = 'Molimo, Maro-Sorcerer'; 
SELECT purchaseUrls  FROM cards  WHERE promoTypes = 'bundle'; 
SELECT COUNT(DISTINCT artist)  FROM cards  WHERE borderColor = 'black'  AND availability LIKE '%arena,mtgo%'; 
SELECT name, convertedManaCost  FROM cards  WHERE name IN ('Serra Angel', 'Shrine Keeper')  ORDER BY convertedManaCost DESC  LIMIT 1; 
SELECT artist  FROM cards  WHERE flavorName = 'Battra, Dark Destroyer'; 
SELECT name  FROM cards  WHERE frameVersion = '2003'  ORDER BY convertedManaCost DESC  LIMIT 3; 
SELECT st.translation FROM set_translations st JOIN sets s ON st.setCode = s.code WHERE st.language = 'Italian' AND s.code = (     SELECT DISTINCT s.code     FROM sets s     JOIN cards c ON c.id = s.id     WHERE c.name = 'Ancestor''s Chosen' ); 
SELECT COUNT(*)  FROM set_translations  WHERE setCode IN (     SELECT setCode      FROM cards      WHERE name = 'Angel of Mercy' ); 
SELECT c.name FROM cards c JOIN sets s ON c.setCode = s.code JOIN set_translations st ON s.code = st.setCode WHERE st.translation = 'Hauptset Zehnte Edition'; 
SELECT EXISTS (     SELECT 1     FROM foreign_data fd     JOIN cards c ON fd.uuid = c.uuid     WHERE c.name = 'Ancestor''s Chosen'       AND fd.language = 'Korean' ) AS KoreanVersionExists; 
SELECT COUNT(*) FROM cards JOIN sets   ON cards.scryfallId = sets.code JOIN set_translations   ON sets.code = set_translations.setCode WHERE cards.artist = 'Adam Rex'   AND set_translations.translation = 'Hauptset Zehnte Edition'; 
SELECT s.baseSetSize  FROM sets s  JOIN set_translations st ON s.code = st.setCode  WHERE st.translation = 'Hauptset Zehnte Edition'; 
SELECT st.translation FROM set_translations st JOIN sets s ON st.setCode = s.code WHERE st.language = 'Chinese Simplified'    AND s.name = 'Eighth Edition'; 
SELECT s.name  FROM cards c  JOIN sets s ON c.setCode = s.code  WHERE c.name = 'Angel of Mercy' AND s.mtgoCode IS NOT NULL; 
SELECT sets.releaseDate  FROM cards  JOIN sets ON cards.setCode = sets.code  WHERE cards.name = 'Ancestor''s Chosen'; 
SELECT s.type  FROM sets s JOIN set_translations st ON s.code = st.setCode WHERE st.translation = 'Hauptset Zehnte Edition'; 
SELECT COUNT(DISTINCT s.code) FROM sets s JOIN set_translations st ON s.code = st.setCode WHERE s.block = 'Ice Age'    AND st.language = 'Italian'    AND st.translation IS NOT NULL; 
SELECT s.name, s.code  FROM sets s  JOIN cards c ON s.code = c.setCode  WHERE c.name = 'Adarkar Valkyrie' AND s.isForeignOnly = 1; 
SELECT COUNT(DISTINCT sets.code)  FROM sets  JOIN set_translations ON sets.code = set_translations.setCode  WHERE set_translations.language = 'Italian'    AND sets.baseSetSize < 10; 
SELECT COUNT(*)  FROM cards  WHERE setCode = (SELECT code FROM sets WHERE name = 'Coldsnap')  AND borderColor = 'black'; 
SELECT c.name  FROM cards c  JOIN sets s ON c.setCode = s.code  WHERE s.name = 'Coldsnap' AND c.convertedManaCost = (     SELECT MAX(convertedManaCost)      FROM cards      WHERE setCode = s.code ); 
SELECT DISTINCT artist  FROM cards  WHERE artist IN ('Jeremy Jarvis', 'Aaron Miller', 'Chippy')  AND setCode = (SELECT code FROM sets WHERE name = 'Coldsnap'); 
SELECT *  FROM cards  WHERE setCode = (SELECT code FROM sets WHERE name = 'Coldsnap')  AND number = '4'; 
SELECT COUNT(*) AS num_unknown_power_cards FROM cards C WHERE C.setCode = (SELECT code FROM sets WHERE name = 'Coldsnap')   AND C.convertedManaCost > 5   AND (C.power = '*' OR C.power IS NULL OR C.power = ''); 
SELECT fd.flavorText  FROM foreign_data fd  JOIN cards c ON fd.uuid = c.uuid  WHERE c.name = 'Ancestor''s Chosen' AND fd.language = 'Italian'; 
SELECT DISTINCT fd.language FROM foreign_data fd JOIN cards c ON fd.uuid = c.uuid WHERE c.name = 'Ancestor''s Chosen' AND fd.flavorText IS NOT NULL; 
